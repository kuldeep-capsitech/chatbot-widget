!function(){"use strict";var t,n,e,o,i,s,r,l,a,u,c,d={},p=[],f=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,h=Array.isArray;function m(t,n){for(var e in n)t[e]=n[e];return t}function g(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function _(n,e,o){var i,s,r,l={};for(r in e)"key"==r?i=e[r]:"ref"==r?s=e[r]:l[r]=e[r];if(arguments.length>2&&(l.children=arguments.length>3?t.call(arguments,2):o),"function"==typeof n&&null!=n.defaultProps)for(r in n.defaultProps)void 0===l[r]&&(l[r]=n.defaultProps[r]);return y(n,l,i,s,null)}function y(t,o,i,s,r){var l={type:t,props:o,key:i,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++e,__i:-1,__u:0};return null==r&&null!=n.vnode&&n.vnode(l),l}function v(t){return t.children}function C(t,n){this.props=t,this.context=n}function T(t,n){if(null==n)return t.__?T(t.__,t.__i+1):null;for(var e;n<t.__k.length;n++)if(null!=(e=t.__k[n])&&null!=e.__e)return e.__e;return"function"==typeof t.type?T(t):null}function E(t){var n,e;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,n=0;n<t.__k.length;n++)if(null!=(e=t.__k[n])&&null!=e.__e){t.__e=t.__c.base=e.__e;break}return E(t)}}function A(t){(!t.__d&&(t.__d=!0)&&o.push(t)&&!I.__r++||i!=n.debounceRendering)&&((i=n.debounceRendering)||s)(I)}function I(){for(var t,e,i,s,l,a,u,c=1;o.length;)o.length>c&&o.sort(r),t=o.shift(),c=o.length,t.__d&&(i=void 0,l=(s=(e=t).__v).__e,a=[],u=[],e.__P&&((i=m({},s)).__v=s.__v+1,n.vnode&&n.vnode(i),P(e.__P,i,s,e.__n,e.__P.namespaceURI,32&s.__u?[l]:null,a,l??T(s),!!(32&s.__u),u),i.__v=s.__v,i.__.__k[i.__i]=i,D(a,i,u),i.__e!=l&&E(i)));I.__r=0}function O(t,n,e,o,i,s,r,l,a,u,c){var f,m,g,_,C,E,A,I=o&&o.__k||p,O=n.length;for(a=function(t,n,e,o,i){var s,r,l,a,u,c=e.length,d=c,p=0;for(t.__k=new Array(i),s=0;s<i;s++)null!=(r=n[s])&&"boolean"!=typeof r&&"function"!=typeof r?(a=s+p,(r=t.__k[s]="string"==typeof r||"number"==typeof r||"bigint"==typeof r||r.constructor==String?y(null,r,null,null,null):h(r)?y(v,{children:r},null,null,null):null==r.constructor&&r.__b>0?y(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r).__=t,r.__b=t.__b+1,l=null,-1!=(u=r.__i=b(r,e,a,d))&&(d--,(l=e[u])&&(l.__u|=2)),null==l||null==l.__v?(-1==u&&(i>c?p--:i<c&&p++),"function"!=typeof r.type&&(r.__u|=4)):u!=a&&(u==a-1?p--:u==a+1?p++:(u>a?p--:p++,r.__u|=4))):t.__k[s]=null;if(d)for(s=0;s<c;s++)null!=(l=e[s])&&!(2&l.__u)&&(l.__e==o&&(o=T(l)),k(l,l));return o}(e,n,I,a,O),f=0;f<O;f++)null!=(g=e.__k[f])&&(m=-1==g.__i?d:I[g.__i]||d,g.__i=f,E=P(t,g,m,i,s,r,l,a,u,c),_=g.__e,g.ref&&m.ref!=g.ref&&(m.ref&&U(m.ref,null,g),c.push(g.ref,g.__c||_,g)),null==C&&null!=_&&(C=_),(A=!!(4&g.__u))||m.__k===g.__k?a=S(g,a,t,A):"function"==typeof g.type&&void 0!==E?a=E:_&&(a=_.nextSibling),g.__u&=-7);return e.__e=C,a}function S(t,n,e,o){var i,s;if("function"==typeof t.type){for(i=t.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=t,n=S(i[s],n,e,o));return n}t.__e!=n&&(o&&(n&&t.type&&!n.parentNode&&(n=T(t)),e.insertBefore(t.__e,n||null)),n=t.__e);do{n=n&&n.nextSibling}while(null!=n&&8==n.nodeType);return n}function b(t,n,e,o){var i,s,r,l=t.key,a=t.type,u=n[e],c=null!=u&&!(2&u.__u);if(null===u&&null==t.key||c&&l==u.key&&a==u.type)return e;if(o>(c?1:0))for(i=e-1,s=e+1;i>=0||s<n.length;)if(null!=(u=n[r=i>=0?i--:s++])&&!(2&u.__u)&&l==u.key&&a==u.type)return r;return-1}function w(t,n,e){"-"==n[0]?t.setProperty(n,e??""):t[n]=null==e?"":"number"!=typeof e||f.test(n)?e:e+"px"}function R(t,n,e,o,i){var s,r;t:if("style"==n)if("string"==typeof e)t.style.cssText=e;else{if("string"==typeof o&&(t.style.cssText=o=""),o)for(n in o)e&&n in e||w(t.style,n,"");if(e)for(n in e)o&&e[n]==o[n]||w(t.style,n,e[n])}else if("o"==n[0]&&"n"==n[1])s=n!=(n=n.replace(l,"$1")),r=n.toLowerCase(),n=r in t||"onFocusOut"==n||"onFocusIn"==n?r.slice(2):n.slice(2),t.l||(t.l={}),t.l[n+s]=e,e?o?e.u=o.u:(e.u=a,t.addEventListener(n,s?c:u,s)):t.removeEventListener(n,s?c:u,s);else{if("http://www.w3.org/2000/svg"==i)n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=n&&"height"!=n&&"href"!=n&&"list"!=n&&"form"!=n&&"tabIndex"!=n&&"download"!=n&&"rowSpan"!=n&&"colSpan"!=n&&"role"!=n&&"popover"!=n&&n in t)try{t[n]=e??"";break t}catch(d){}"function"==typeof e||(null==e||!1===e&&"-"!=n[4]?t.removeAttribute(n):t.setAttribute(n,"popover"==n&&1==e?"":e))}}function N(t){return function(e){if(this.l){var o=this.l[e.type+t];if(null==e.t)e.t=a++;else if(e.t<o.u)return;return o(n.event?n.event(e):e)}}}function P(e,o,i,s,r,l,a,u,c,p){var f,_,y,E,A,I,S,b,w,N,P,D,U,k,q,G,H,F=o.type;if(null!=o.constructor)return null;128&i.__u&&(c=!!(32&i.__u),l=[u=o.__e=i.__e]),(f=n.__b)&&f(o);t:if("function"==typeof F)try{if(b=o.props,w="prototype"in F&&F.prototype.render,N=(f=F.contextType)&&s[f.__c],P=f?N?N.props.value:f.__:s,i.__c?S=(_=o.__c=i.__c).__=_.__E:(w?o.__c=_=new F(b,P):(o.__c=_=new C(b,P),_.constructor=F,_.render=L),N&&N.sub(_),_.props=b,_.state||(_.state={}),_.context=P,_.__n=s,y=_.__d=!0,_.__h=[],_._sb=[]),w&&null==_.__s&&(_.__s=_.state),w&&null!=F.getDerivedStateFromProps&&(_.__s==_.state&&(_.__s=m({},_.__s)),m(_.__s,F.getDerivedStateFromProps(b,_.__s))),E=_.props,A=_.state,_.__v=o,y)w&&null==F.getDerivedStateFromProps&&null!=_.componentWillMount&&_.componentWillMount(),w&&null!=_.componentDidMount&&_.__h.push(_.componentDidMount);else{if(w&&null==F.getDerivedStateFromProps&&b!==E&&null!=_.componentWillReceiveProps&&_.componentWillReceiveProps(b,P),!_.__e&&null!=_.shouldComponentUpdate&&!1===_.shouldComponentUpdate(b,_.__s,P)||o.__v==i.__v){for(o.__v!=i.__v&&(_.props=b,_.state=_.__s,_.__d=!1),o.__e=i.__e,o.__k=i.__k,o.__k.some(function(t){t&&(t.__=o)}),D=0;D<_._sb.length;D++)_.__h.push(_._sb[D]);_._sb=[],_.__h.length&&a.push(_);break t}null!=_.componentWillUpdate&&_.componentWillUpdate(b,_.__s,P),w&&null!=_.componentDidUpdate&&_.__h.push(function(){_.componentDidUpdate(E,A,I)})}if(_.context=P,_.props=b,_.__P=e,_.__e=!1,U=n.__r,k=0,w){for(_.state=_.__s,_.__d=!1,U&&U(o),f=_.render(_.props,_.state,_.context),q=0;q<_._sb.length;q++)_.__h.push(_._sb[q]);_._sb=[]}else do{_.__d=!1,U&&U(o),f=_.render(_.props,_.state,_.context),_.state=_.__s}while(_.__d&&++k<25);_.state=_.__s,null!=_.getChildContext&&(s=m(m({},s),_.getChildContext())),w&&!y&&null!=_.getSnapshotBeforeUpdate&&(I=_.getSnapshotBeforeUpdate(E,A)),G=f,null!=f&&f.type===v&&null==f.key&&(G=x(f.props.children)),u=O(e,h(G)?G:[G],o,i,s,r,l,a,u,c,p),_.base=o.__e,o.__u&=-161,_.__h.length&&a.push(_),S&&(_.__E=_.__=null)}catch(V){if(o.__v=null,c||null!=l)if(V.then){for(o.__u|=c?160:128;u&&8==u.nodeType&&u.nextSibling;)u=u.nextSibling;l[l.indexOf(u)]=null,o.__e=u}else{for(H=l.length;H--;)g(l[H]);M(o)}else o.__e=i.__e,o.__k=i.__k,V.then||M(o);n.__e(V,o,i)}else null==l&&o.__v==i.__v?(o.__k=i.__k,o.__e=i.__e):u=o.__e=function(e,o,i,s,r,l,a,u,c){var p,f,m,_,y,v,C,E=i.props,A=o.props,I=o.type;if("svg"==I?r="http://www.w3.org/2000/svg":"math"==I?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),null!=l)for(p=0;p<l.length;p++)if((y=l[p])&&"setAttribute"in y==!!I&&(I?y.localName==I:3==y.nodeType)){e=y,l[p]=null;break}if(null==e){if(null==I)return document.createTextNode(A);e=document.createElementNS(r,I,A.is&&A),u&&(n.__m&&n.__m(o,l),u=!1),l=null}if(null==I)E===A||u&&e.data==A||(e.data=A);else{if(l=l&&t.call(e.childNodes),E=i.props||d,!u&&null!=l)for(E={},p=0;p<e.attributes.length;p++)E[(y=e.attributes[p]).name]=y.value;for(p in E)if(y=E[p],"children"==p);else if("dangerouslySetInnerHTML"==p)m=y;else if(!(p in A)){if("value"==p&&"defaultValue"in A||"checked"==p&&"defaultChecked"in A)continue;R(e,p,null,y,r)}for(p in A)y=A[p],"children"==p?_=y:"dangerouslySetInnerHTML"==p?f=y:"value"==p?v=y:"checked"==p?C=y:u&&"function"!=typeof y||E[p]===y||R(e,p,y,E[p],r);if(f)u||m&&(f.__html==m.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),o.__k=[];else if(m&&(e.innerHTML=""),O("template"==o.type?e.content:e,h(_)?_:[_],o,i,s,"foreignObject"==I?"http://www.w3.org/1999/xhtml":r,l,a,l?l[0]:i.__k&&T(i,0),u,c),null!=l)for(p=l.length;p--;)g(l[p]);u||(p="value","progress"==I&&null==v?e.removeAttribute("value"):null!=v&&(v!==e[p]||"progress"==I&&!v||"option"==I&&v!=E[p])&&R(e,p,v,E[p],r),p="checked",null!=C&&C!=e[p]&&R(e,p,C,E[p],r))}return e}(i.__e,o,i,s,r,l,a,c,p);return(f=n.diffed)&&f(o),128&o.__u?void 0:u}function M(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(M)}function D(t,e,o){for(var i=0;i<o.length;i++)U(o[i],o[++i],o[++i]);n.__c&&n.__c(e,t),t.some(function(e){try{t=e.__h,e.__h=[],t.some(function(t){t.call(e)})}catch(o){n.__e(o,e.__v)}})}function x(t){return"object"!=typeof t||null==t||t.__b&&t.__b>0?t:h(t)?t.map(x):m({},t)}function U(t,e,o){try{if("function"==typeof t){var i="function"==typeof t.__u;i&&t.__u(),i&&null==e||(t.__u=t(e))}else t.current=e}catch(s){n.__e(s,o)}}function k(t,e,o){var i,s;if(n.unmount&&n.unmount(t),(i=t.ref)&&(i.current&&i.current!=t.__e||U(i,null,e)),null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){n.__e(r,e)}i.base=i.__P=null}if(i=t.__k)for(s=0;s<i.length;s++)i[s]&&k(i[s],e,o||"function"!=typeof t.type);o||g(t.__e),t.__c=t.__=t.__e=void 0}function L(t,n,e){return this.constructor(t,e)}t=p.slice,n={__e:function(t,n,e,o){for(var i,s,r;n=n.__;)if((i=n.__c)&&!i.__)try{if((s=i.constructor)&&null!=s.getDerivedStateFromError&&(i.setState(s.getDerivedStateFromError(t)),r=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(t,o||{}),r=i.__d),r)return i.__E=i}catch(l){t=l}throw t}},e=0,C.prototype.setState=function(t,n){var e;e=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=m({},this.state),"function"==typeof t&&(t=t(m({},e),this.props)),t&&m(e,t),null!=t&&this.__v&&(n&&this._sb.push(n),A(this))},C.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),A(this))},C.prototype.render=v,o=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,r=function(t,n){return t.__v.__b-n.__v.__b},I.__r=0,l=/(PointerCapture)$|Capture$/i,a=0,u=N(!1),c=N(!0);var q=0;function G(t,e,o,i,s,r){e||(e={});var l,a,u=e;if("ref"in u)for(a in u={},e)"ref"==a?l=e[a]:u[a]=e[a];var c={type:t,props:u,key:o,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--q,__i:-1,__u:0,__source:s,__self:r};if("function"==typeof t&&(l=t.defaultProps))for(a in l)void 0===u[a]&&(u[a]=l[a]);return n.vnode&&n.vnode(c),c}var H,F,V,j,B=0,J=[],Y=n,W=Y.__b,K=Y.__r,$=Y.diffed,z=Y.__c,X=Y.unmount,Z=Y.__;function Q(t,n){Y.__h&&Y.__h(F,t,B||n),B=0;var e=F.__H||(F.__H={__:[],__h:[]});return t>=e.__.length&&e.__.push({}),e.__[t]}function tt(t){return B=1,function(t,n){var e=Q(H++,2);if(e.t=t,!e.__c&&(e.__=[Jn(void 0,n),function(t){var n=e.__N?e.__N[0]:e.__[0],o=e.t(n,t);n!==o&&(e.__N=[o,e.__[1]],e.__c.setState({}))}],e.__c=F,!F.__f)){var o=function(t,n,o){if(!e.__c.__H)return!0;var s=e.__c.__H.__.filter(function(t){return!!t.__c});if(s.every(function(t){return!t.__N}))return!i||i.call(this,t,n,o);var r=e.__c.props!==t;return s.forEach(function(t){if(t.__N){var n=t.__[0];t.__=t.__N,t.__N=void 0,n!==t.__[0]&&(r=!0)}}),i&&i.call(this,t,n,o)||r};F.__f=!0;var i=F.shouldComponentUpdate,s=F.componentWillUpdate;F.componentWillUpdate=function(t,n,e){if(this.__e){var r=i;i=void 0,o(t,n,e),i=r}s&&s.call(this,t,n,e)},F.shouldComponentUpdate=o}return e.__N||e.__}(Jn,t)}function nt(){for(var t;t=J.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(jn),t.__H.__h.forEach(Bn),t.__H.__h=[]}catch(xi){t.__H.__h=[],Y.__e(xi,t.__v)}}Y.__b=function(t){F=null,W&&W(t)},Y.__=function(t,n){t&&n.__k&&n.__k.__m&&(t.__m=n.__k.__m),Z&&Z(t,n)},Y.__r=function(t){K&&K(t),H=0;var n=(F=t.__c).__H;n&&(V===F?(n.__h=[],F.__h=[],n.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(n.__h.forEach(jn),n.__h.forEach(Bn),n.__h=[],H=0)),V=F},Y.diffed=function(t){$&&$(t);var n=t.__c;n&&n.__H&&(n.__H.__h.length&&(1!==J.push(n)&&j===Y.requestAnimationFrame||((j=Y.requestAnimationFrame)||Vn)(nt)),n.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),V=F=null},Y.__c=function(t,n){n.some(function(t){try{t.__h.forEach(jn),t.__h=t.__h.filter(function(t){return!t.__||Bn(t)})}catch(e){n.some(function(t){t.__h&&(t.__h=[])}),n=[],Y.__e(e,t.__v)}}),z&&z(t,n)},Y.unmount=function(t){X&&X(t);var n,e=t.__c;e&&e.__H&&(e.__H.__.forEach(function(t){try{jn(t)}catch(e){n=e}}),e.__H=void 0,n&&Y.__e(n,e.__v))};var et,ot,it,st,rt,lt,at,ut,ct,dt,pt,ft,ht,mt,gt,_t,yt,vt,Ct,Tt,Et,At,It,Ot,St,bt,wt,Rt,Nt,Pt,Mt,Dt,xt,Ut,kt,Lt,qt,Gt,Ht,Ft,Vt,jt,Bt,Jt,Yt,Wt,Kt,$t,zt,Xt,Zt,Qt,tn,nn,en,on,sn,rn,ln,an,un,cn,dn,pn,fn,hn,mn,gn,_n,yn,vn,Cn,Tn,En,An,In,On,Sn,bn,wn,Rn,Nn,Pn,Mn,Dn,xn,Un,kn,Ln,qn,Gn,Hn,Fn="function"==typeof requestAnimationFrame;function Vn(t){var n,e=function(){clearTimeout(o),Fn&&cancelAnimationFrame(n),setTimeout(t)},o=setTimeout(e,35);Fn&&(n=requestAnimationFrame(e))}function jn(t){var n=F,e=t.__c;"function"==typeof e&&(t.__c=void 0,e()),F=n}function Bn(t){var n=F;t.__c=t.__(),F=n}function Jn(t,n){return"function"==typeof n?n(t):n}function Yn(t,n="en-IN"){const e=new Date(t),o=e.toLocaleTimeString(n,{hour:"2-digit",minute:"2-digit",hour12:!0});return[e.toLocaleDateString(n,{day:"2-digit",month:"2-digit",year:"2-digit"}),o]}
/**
  * @license
  * Copyright 2025 Google LLC
  * SPDX-License-Identifier: Apache-2.0
  */
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
class Wn{}function Kn(t,n){return t.replace(/\{([^}]+)\}/g,(t,e)=>{if(Object.prototype.hasOwnProperty.call(n,e)){const t=n[e];return null!=t?String(t):""}throw new Error(`Key '${e}' not found in valueMap.`)})}function $n(t,n,e){for(let s=0;s<n.length-1;s++){const o=n[s];if(o.endsWith("[]")){const i=o.slice(0,-2);if(!(i in t)){if(!Array.isArray(e))throw new Error(`Value must be a list given an array path ${o}`);t[i]=Array.from({length:e.length},()=>({}))}if(Array.isArray(t[i])){const o=t[i];if(Array.isArray(e))for(let t=0;t<o.length;t++)$n(o[t],n.slice(s+1),e[t]);else for(const t of o)$n(t,n.slice(s+1),e)}return}if(o.endsWith("[0]")){const i=o.slice(0,-3);return i in t||(t[i]=[{}]),void $n(t[i][0],n.slice(s+1),e)}t[o]&&"object"==typeof t[o]||(t[o]={}),t=t[o]}const o=n[n.length-1],i=t[o];if(void 0!==i){if(!e||"object"==typeof e&&0===Object.keys(e).length)return;if(e===i)return;if("object"!=typeof i||"object"!=typeof e||null===i||null===e)throw new Error(`Cannot set value for an existing key. Key: ${o}`);Object.assign(i,e)}else t[o]=e}function zn(t,n){try{if(1===n.length&&"_self"===n[0])return t;for(let e=0;e<n.length;e++){if("object"!=typeof t||null===t)return;const o=n[e];if(o.endsWith("[]")){const i=o.slice(0,-2);if(i in t){const o=t[i];if(!Array.isArray(o))return;return o.map(t=>zn(t,n.slice(e+1)))}return}t=t[o]}return t}catch(e){if(e instanceof TypeError)return;throw e}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function Xn(t){if("string"!=typeof t)throw new Error("fromImageBytes must be a string");return t}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */(ot=et||(et={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",ot.OUTCOME_OK="OUTCOME_OK",ot.OUTCOME_FAILED="OUTCOME_FAILED",ot.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(st=it||(it={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",st.PYTHON="PYTHON",(lt=rt||(rt={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",lt.STRING="STRING",lt.NUMBER="NUMBER",lt.INTEGER="INTEGER",lt.BOOLEAN="BOOLEAN",lt.ARRAY="ARRAY",lt.OBJECT="OBJECT",lt.NULL="NULL",(ut=at||(at={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",ut.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",ut.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",ut.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",ut.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",ut.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",ut.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",ut.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",ut.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",ut.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",(dt=ct||(ct={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",dt.SEVERITY="SEVERITY",dt.PROBABILITY="PROBABILITY",(ft=pt||(pt={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",ft.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",ft.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",ft.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",ft.BLOCK_NONE="BLOCK_NONE",ft.OFF="OFF",(mt=ht||(ht={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",mt.MODE_DYNAMIC="MODE_DYNAMIC",(_t=gt||(gt={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",_t.NO_AUTH="NO_AUTH",_t.API_KEY_AUTH="API_KEY_AUTH",_t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",_t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",_t.OAUTH="OAUTH",_t.OIDC_AUTH="OIDC_AUTH",(vt=yt||(yt={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",vt.SIMPLE_SEARCH="SIMPLE_SEARCH",vt.ELASTIC_SEARCH="ELASTIC_SEARCH",(Tt=Ct||(Ct={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",Tt.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",Tt.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",Tt.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",Tt.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(At=Et||(Et={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",At.STOP="STOP",At.MAX_TOKENS="MAX_TOKENS",At.SAFETY="SAFETY",At.RECITATION="RECITATION",At.LANGUAGE="LANGUAGE",At.OTHER="OTHER",At.BLOCKLIST="BLOCKLIST",At.PROHIBITED_CONTENT="PROHIBITED_CONTENT",At.SPII="SPII",At.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",At.IMAGE_SAFETY="IMAGE_SAFETY",At.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",(Ot=It||(It={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",Ot.NEGLIGIBLE="NEGLIGIBLE",Ot.LOW="LOW",Ot.MEDIUM="MEDIUM",Ot.HIGH="HIGH",(bt=St||(St={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",bt.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",bt.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",bt.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",bt.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(Rt=wt||(wt={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",Rt.SAFETY="SAFETY",Rt.OTHER="OTHER",Rt.BLOCKLIST="BLOCKLIST",Rt.PROHIBITED_CONTENT="PROHIBITED_CONTENT",Rt.IMAGE_SAFETY="IMAGE_SAFETY",(Pt=Nt||(Nt={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",Pt.ON_DEMAND="ON_DEMAND",Pt.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(Dt=Mt||(Mt={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Dt.TEXT="TEXT",Dt.IMAGE="IMAGE",Dt.AUDIO="AUDIO",(Ut=xt||(xt={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",Ut.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",Ut.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",Ut.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(Lt=kt||(kt={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",Lt.JOB_STATE_QUEUED="JOB_STATE_QUEUED",Lt.JOB_STATE_PENDING="JOB_STATE_PENDING",Lt.JOB_STATE_RUNNING="JOB_STATE_RUNNING",Lt.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",Lt.JOB_STATE_FAILED="JOB_STATE_FAILED",Lt.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",Lt.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",Lt.JOB_STATE_PAUSED="JOB_STATE_PAUSED",Lt.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",Lt.JOB_STATE_UPDATING="JOB_STATE_UPDATING",Lt.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(Gt=qt||(qt={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",Gt.TUNING_MODE_FULL="TUNING_MODE_FULL",Gt.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(Ft=Ht||(Ht={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",Ft.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",Ft.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",Ft.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",Ft.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",Ft.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",Ft.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(jt=Vt||(Vt={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",jt.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",jt.BALANCED="BALANCED",jt.PRIORITIZE_COST="PRIORITIZE_COST",(Jt=Bt||(Bt={})).UNSPECIFIED="UNSPECIFIED",Jt.BLOCKING="BLOCKING",Jt.NON_BLOCKING="NON_BLOCKING",(Wt=Yt||(Yt={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Wt.MODE_DYNAMIC="MODE_DYNAMIC",($t=Kt||(Kt={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",$t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(Xt=zt||(zt={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Xt.AUTO="AUTO",Xt.ANY="ANY",Xt.NONE="NONE",(Qt=Zt||(Zt={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Qt.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Qt.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",Qt.BLOCK_NONE="BLOCK_NONE",(nn=tn||(tn={})).DONT_ALLOW="DONT_ALLOW",nn.ALLOW_ADULT="ALLOW_ADULT",nn.ALLOW_ALL="ALLOW_ALL",(on=en||(en={})).auto="auto",on.en="en",on.ja="ja",on.ko="ko",on.hi="hi",on.zh="zh",on.pt="pt",on.es="es",(rn=sn||(sn={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",rn.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",rn.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",rn.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",rn.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(an=ln||(ln={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",an.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",an.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",an.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(cn=un||(un={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",cn.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",cn.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",cn.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(pn=dn||(dn={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",pn.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",pn.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",pn.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",pn.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",pn.EDIT_MODE_STYLE="EDIT_MODE_STYLE",pn.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",pn.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(hn=fn||(fn={})).FOREGROUND="FOREGROUND",hn.BACKGROUND="BACKGROUND",hn.PROMPT="PROMPT",hn.SEMANTIC="SEMANTIC",hn.INTERACTIVE="INTERACTIVE",(gn=mn||(mn={})).OPTIMIZED="OPTIMIZED",gn.LOSSLESS="LOSSLESS",(yn=_n||(_n={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",yn.PROCESSING="PROCESSING",yn.ACTIVE="ACTIVE",yn.FAILED="FAILED",(Cn=vn||(vn={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",Cn.UPLOADED="UPLOADED",Cn.GENERATED="GENERATED",(En=Tn||(Tn={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",En.TEXT="TEXT",En.IMAGE="IMAGE",En.VIDEO="VIDEO",En.AUDIO="AUDIO",En.DOCUMENT="DOCUMENT",(In=An||(An={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",In.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",In.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(Sn=On||(On={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",Sn.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",Sn.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(wn=bn||(bn={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",wn.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",wn.NO_INTERRUPTION="NO_INTERRUPTION",(Nn=Rn||(Rn={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",Nn.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",Nn.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(Mn=Pn||(Pn={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",Mn.SILENT="SILENT",Mn.WHEN_IDLE="WHEN_IDLE",Mn.INTERRUPT="INTERRUPT",(xn=Dn||(Dn={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",xn.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",xn.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",xn.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",xn.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",xn.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",xn.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",xn.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",xn.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",xn.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",xn.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",xn.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",xn.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(kn=Un||(Un={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",kn.QUALITY="QUALITY",kn.DIVERSITY="DIVERSITY",kn.VOCALIZATION="VOCALIZATION",(qn=Ln||(Ln={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",qn.PLAY="PLAY",qn.PAUSE="PAUSE",qn.STOP="STOP",qn.RESET_CONTEXT="RESET_CONTEXT";class Zn{constructor(t){const n={};for(const e of t.headers.entries())n[e[0]]=e[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class Qn{get text(){var t,n,e,o,i,s,r,l;if(0===(null===(o=null===(e=null===(n=null===(t=this.candidates)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let a="",u=!1;const c=[];for(const d of null!==(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)&&void 0!==l?l:[]){for(const[t,n]of Object.entries(d))"text"===t||"thought"===t||null===n&&void 0===n||c.push(t);if("string"==typeof d.text){if("boolean"==typeof d.thought&&d.thought)continue;u=!0,a+=d.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?a:void 0}get data(){var t,n,e,o,i,s,r,l;if(0===(null===(o=null===(e=null===(n=null===(t=this.candidates)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let a="";const u=[];for(const c of null!==(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)&&void 0!==l?l:[]){for(const[t,n]of Object.entries(c))"inlineData"===t||null===n&&void 0===n||u.push(t);c.inlineData&&"string"==typeof c.inlineData.data&&(a+=atob(c.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}get functionCalls(){var t,n,e,o,i,s,r,l;if(0===(null===(o=null===(e=null===(n=null===(t=this.candidates)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const a=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(t=>t.functionCall).map(t=>t.functionCall).filter(t=>void 0!==t);return 0!==(null==a?void 0:a.length)?a:void 0}get executableCode(){var t,n,e,o,i,s,r,l,a;if(0===(null===(o=null===(e=null===(n=null===(t=this.candidates)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(t=>t.executableCode).map(t=>t.executableCode).filter(t=>void 0!==t);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.code:void 0}get codeExecutionResult(){var t,n,e,o,i,s,r,l,a;if(0===(null===(o=null===(e=null===(n=null===(t=this.candidates)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(t=>t.codeExecutionResult).map(t=>t.codeExecutionResult).filter(t=>void 0!==t);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.output:void 0}}class te{}class ne{}class ee{}class oe{}class ie{}class se{}class re{}class le{}class ae{}class ue{}class ce{}class de{}class pe{}class fe{}class he{}class me{}class ge{}class _e{}class ye{get text(){var t,n,e;let o="",i=!1;const s=[];for(const r of null!==(e=null===(n=null===(t=this.serverContent)||void 0===t?void 0:t.modelTurn)||void 0===n?void 0:n.parts)&&void 0!==e?e:[]){for(const[t,n]of Object.entries(r))"text"!==t&&"thought"!==t&&null!==n&&s.push(t);if("string"==typeof r.text){if("boolean"==typeof r.thought&&r.thought)continue;i=!0,o+=r.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?o:void 0}get data(){var t,n,e;let o="";const i=[];for(const s of null!==(e=null===(n=null===(t=this.serverContent)||void 0===t?void 0:t.modelTurn)||void 0===n?void 0:n.parts)&&void 0!==e?e:[]){for(const[t,n]of Object.entries(s))"inlineData"!==t&&null!==n&&i.push(t);s.inlineData&&"string"==typeof s.inlineData.data&&(o+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class ve{_fromAPIResponse({apiResponse:t,isVertexAI:n}){const e=new ve;if(e.name=t.name,e.metadata=t.metadata,e.done=t.done,e.error=t.error,n){const n=t.response;if(n){const t=new ce,o=n.videos;t.generatedVideos=null==o?void 0:o.map(t=>({video:{uri:t.gcsUri,videoBytes:t.bytesBase64Encoded?Xn(t.bytesBase64Encoded):void 0,mimeType:t.mimeType}})),t.raiMediaFilteredCount=n.raiMediaFilteredCount,t.raiMediaFilteredReasons=n.raiMediaFilteredReasons,e.response=t}}else{const n=t.response;if(n){const t=new ce,o=n.generateVideoResponse,i=null==o?void 0:o.generatedSamples;t.generatedVideos=null==i?void 0:i.map(t=>{const n=t.video;return{video:{uri:null==n?void 0:n.uri,videoBytes:(null==n?void 0:n.encodedVideo)?Xn(null==n?void 0:n.encodedVideo):void 0,mimeType:t.encoding}}}),t.raiMediaFilteredCount=null==o?void 0:o.raiMediaFilteredCount,t.raiMediaFilteredReasons=null==o?void 0:o.raiMediaFilteredReasons,e.response=t}}return e}}class Ce{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function Te(t,n){if(!n||"string"!=typeof n)throw new Error("model is required and must be a string");if(t.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}return`publishers/google/models/${n}`}return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function Ee(t,n){const e=Te(t,n);return e?e.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:e.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${e}`:e:""}function Ae(t){return Array.isArray(t)?t.map(t=>Ie(t)):[Ie(t)]}function Ie(t){if("object"==typeof t&&null!==t)return t;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof t)}function Oe(t){const n=Ie(t);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function Se(t){const n=Ie(t);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function be(t){if(null==t)throw new Error("PartUnion is required");if("object"==typeof t)return t;if("string"==typeof t)return{text:t};throw new Error("Unsupported part type: "+typeof t)}function we(t){if(null==t||Array.isArray(t)&&0===t.length)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(t=>be(t)):[be(t)]}function Re(t){return null!=t&&"object"==typeof t&&"parts"in t&&Array.isArray(t.parts)}function Ne(t){return null!=t&&"object"==typeof t&&"functionCall"in t}function Pe(t){return null!=t&&"object"==typeof t&&"functionResponse"in t}function Me(t){if(null==t)throw new Error("ContentUnion is required");return Re(t)?t:{role:"user",parts:we(t)}}function De(t,n){if(!n)return[];if(t.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const n=Me(t);return n.parts&&n.parts.length>0&&void 0!==n.parts[0].text?[n.parts[0].text]:[]});if(t.isVertexAI()){const t=Me(n);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>Me(t)):[Me(n)]}function xe(t){if(null==t||Array.isArray(t)&&0===t.length)throw new Error("contents are required");if(!Array.isArray(t)){if(Ne(t)||Pe(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Me(t)]}const n=[],e=[],o=Re(t[0]);for(const i of t){const t=Re(i);if(t!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(t)n.push(i);else{if(Ne(i)||Pe(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");e.push(i)}}return o||n.push({role:"user",parts:we(e)}),n}function Ue(t){const n={},e=["items"],o=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;null!=s&&2==s.length&&("null"===s[0].type?(n.nullable=!0,t=s[1]):"null"===s[1].type&&(n.nullable=!0,t=s[0])),t.type instanceof Array&&function(t,n){t.includes("null")&&(n.nullable=!0);const e=t.filter(t=>"null"!==t);if(1===e.length)n.type=Object.values(rt).includes(e[0].toUpperCase())?e[0].toUpperCase():rt.TYPE_UNSPECIFIED;else{n.anyOf=[];for(const t of e)n.anyOf.push({type:Object.values(rt).includes(t.toUpperCase())?t.toUpperCase():rt.TYPE_UNSPECIFIED})}}(t.type,n);for(const[r,l]of Object.entries(t))if(null!=l)if("type"==r){if("null"===l)throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;n.type=Object.values(rt).includes(l.toUpperCase())?l.toUpperCase():rt.TYPE_UNSPECIFIED}else if(e.includes(r))n[r]=Ue(l);else if(o.includes(r)){const t=[];for(const e of l)"null"!=e.type?t.push(Ue(e)):n.nullable=!0;n[r]=t}else if(i.includes(r)){const t={};for(const[n,e]of Object.entries(l))t[n]=Ue(e);n[r]=t}else{if("additionalProperties"===r)continue;n[r]=l}return n}function ke(t){return Ue(t)}function Le(t){if("object"==typeof t)return t;if("string"==typeof t)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error("Unsupported speechConfig type: "+typeof t)}function qe(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ge(t){if(t.functionDeclarations)for(const n of t.functionDeclarations)n.parameters&&(Object.keys(n.parameters).includes("$schema")?n.parametersJsonSchema||(n.parametersJsonSchema=n.parameters,delete n.parameters):n.parameters=Ue(n.parameters)),n.response&&(Object.keys(n.response).includes("$schema")?n.responseJsonSchema||(n.responseJsonSchema=n.response,delete n.response):n.response=Ue(n.response));return t}function He(t){if(null==t)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const n=[];for(const e of t)n.push(e);return n}function Fe(t,n){if("string"!=typeof n)throw new Error("name must be a string");return function(t,n,e,o=1){const i=!n.startsWith(`${e}/`)&&n.split("/").length===o;return t.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${t.getProject()}/${n}`:n.startsWith(`${e}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}/${n}`:n:i?`${e}/${n}`:n}(t,n,"cachedContents")}function Ve(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function je(t){return Xn(t)}function Be(t){var n;let e;var o;if(null!=(o=t)&&"object"==typeof o&&"name"in o&&(e=t.name),!(function(t){return null!=t&&"object"==typeof t&&"uri"in t}(t)&&(e=t.uri,void 0===e)||function(t){return null!=t&&"object"==typeof t&&"video"in t}(t)&&(e=null===(n=t.video)||void 0===n?void 0:n.uri,void 0===e))){if("string"==typeof t&&(e=t),void 0===e)throw new Error("Could not extract file name from the provided input.");if(e.startsWith("https://")){const t=e.split("files/")[1].match(/[a-z0-9]+/);if(null===t)throw new Error(`Could not extract file name from URI ${e}`);e=t[0]}else e.startsWith("files/")&&(e=e.split("files/")[1]);return e}}function Je(t,n){let e;return e=t.isVertexAI()?n?"publishers/google/models":"models":n?"models":"tunedModels",e}function Ye(t){for(const n of["models","tunedModels","publisherModels"])if(We(t,n))return t[n];return[]}function We(t,n){return null!==t&&"object"==typeof t&&n in t}function Ke(t,n={}){const e=t,o={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return n.behavior&&(o.behavior=n.behavior),{functionDeclarations:[o]}}function $e(t,n){if("string"!=typeof n&&!Array.isArray(n)){if(t&&t.isVertexAI()){if(n.gcsUri&&n.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!n.gcsUri&&!n.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(n.inlinedRequests&&n.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!n.inlinedRequests&&!n.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return n}if(Array.isArray(n))return{inlinedRequests:n};if("string"==typeof n){if(n.startsWith("gs://"))return{format:"jsonl",gcsUri:[n]};if(n.startsWith("bq://"))return{format:"bigquery",bigqueryUri:n};if(n.startsWith("files/"))return{fileName:n}}throw new Error(`Unsupported source: ${n}`)}function ze(t,n){const e=n;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(e))return e.split("/").pop();throw new Error(`Invalid batch job name: ${e}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(e))return e.split("/").pop();if(/^\d+$/.test(e))return e;throw new Error(`Invalid batch job name: ${e}.`)}function Xe(t){return"BATCH_STATE_UNSPECIFIED"===t?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===t?"JOB_STATE_PENDING":"BATCH_STATE_SUCCEEDED"===t?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===t?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===t?"JOB_STATE_CANCELLED":t}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function Ze(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}function Qe(t){const n={},e=zn(t,["prebuiltVoiceConfig"]);return null!=e&&$n(n,["prebuiltVoiceConfig"],function(t){const n={},e=zn(t,["voiceName"]);return null!=e&&$n(n,["voiceName"],e),n}(e)),n}function to(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["src"]);null!=i&&$n(e,["batch","inputConfig"],function(t,n){const e={};if(void 0!==zn(n,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==zn(n,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==zn(n,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=zn(n,["fileName"]);null!=o&&$n(e,["fileName"],o);const i=zn(n,["inlinedRequests"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["request","model"],Te(t,o));const i=zn(n,["contents"]);if(null!=i){let t=xe(i);Array.isArray(t)&&(t=t.map(t=>Ze(t))),$n(e,["request","contents"],t)}const s=zn(n,["config"]);return null!=s&&$n(e,["request","generationConfig"],function(t,n,e){const o={},i=zn(n,["systemInstruction"]);void 0!==e&&null!=i&&$n(e,["systemInstruction"],Ze(Me(i)));const s=zn(n,["temperature"]);null!=s&&$n(o,["temperature"],s);const r=zn(n,["topP"]);null!=r&&$n(o,["topP"],r);const l=zn(n,["topK"]);null!=l&&$n(o,["topK"],l);const a=zn(n,["candidateCount"]);null!=a&&$n(o,["candidateCount"],a);const u=zn(n,["maxOutputTokens"]);null!=u&&$n(o,["maxOutputTokens"],u);const c=zn(n,["stopSequences"]);null!=c&&$n(o,["stopSequences"],c);const d=zn(n,["responseLogprobs"]);null!=d&&$n(o,["responseLogprobs"],d);const p=zn(n,["logprobs"]);null!=p&&$n(o,["logprobs"],p);const f=zn(n,["presencePenalty"]);null!=f&&$n(o,["presencePenalty"],f);const h=zn(n,["frequencyPenalty"]);null!=h&&$n(o,["frequencyPenalty"],h);const m=zn(n,["seed"]);null!=m&&$n(o,["seed"],m);const g=zn(n,["responseMimeType"]);null!=g&&$n(o,["responseMimeType"],g);const _=zn(n,["responseSchema"]);null!=_&&$n(o,["responseSchema"],function(t){const n={},e=zn(t,["anyOf"]);null!=e&&$n(n,["anyOf"],e);const o=zn(t,["default"]);null!=o&&$n(n,["default"],o);const i=zn(t,["description"]);null!=i&&$n(n,["description"],i);const s=zn(t,["enum"]);null!=s&&$n(n,["enum"],s);const r=zn(t,["example"]);null!=r&&$n(n,["example"],r);const l=zn(t,["format"]);null!=l&&$n(n,["format"],l);const a=zn(t,["items"]);null!=a&&$n(n,["items"],a);const u=zn(t,["maxItems"]);null!=u&&$n(n,["maxItems"],u);const c=zn(t,["maxLength"]);null!=c&&$n(n,["maxLength"],c);const d=zn(t,["maxProperties"]);null!=d&&$n(n,["maxProperties"],d);const p=zn(t,["maximum"]);null!=p&&$n(n,["maximum"],p);const f=zn(t,["minItems"]);null!=f&&$n(n,["minItems"],f);const h=zn(t,["minLength"]);null!=h&&$n(n,["minLength"],h);const m=zn(t,["minProperties"]);null!=m&&$n(n,["minProperties"],m);const g=zn(t,["minimum"]);null!=g&&$n(n,["minimum"],g);const _=zn(t,["nullable"]);null!=_&&$n(n,["nullable"],_);const y=zn(t,["pattern"]);null!=y&&$n(n,["pattern"],y);const v=zn(t,["properties"]);null!=v&&$n(n,["properties"],v);const C=zn(t,["propertyOrdering"]);null!=C&&$n(n,["propertyOrdering"],C);const T=zn(t,["required"]);null!=T&&$n(n,["required"],T);const E=zn(t,["title"]);null!=E&&$n(n,["title"],E);const A=zn(t,["type"]);return null!=A&&$n(n,["type"],A),n}(ke(_)));const y=zn(n,["responseJsonSchema"]);if(null!=y&&$n(o,["responseJsonSchema"],y),void 0!==zn(n,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==zn(n,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=zn(n,["safetySettings"]);if(void 0!==e&&null!=v){let t=v;Array.isArray(t)&&(t=t.map(t=>function(t){const n={};if(void 0!==zn(t,["method"]))throw new Error("method parameter is not supported in Gemini API.");const e=zn(t,["category"]);null!=e&&$n(n,["category"],e);const o=zn(t,["threshold"]);return null!=o&&$n(n,["threshold"],o),n}(t))),$n(e,["safetySettings"],t)}const C=zn(n,["tools"]);if(void 0!==e&&null!=C){let t=He(C);Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["behavior"]);null!=e&&$n(n,["behavior"],e);const o=zn(t,["description"]);null!=o&&$n(n,["description"],o);const i=zn(t,["name"]);null!=i&&$n(n,["name"],i);const s=zn(t,["parameters"]);null!=s&&$n(n,["parameters"],s);const r=zn(t,["parametersJsonSchema"]);null!=r&&$n(n,["parametersJsonSchema"],r);const l=zn(t,["response"]);null!=l&&$n(n,["response"],l);const a=zn(t,["responseJsonSchema"]);return null!=a&&$n(n,["responseJsonSchema"],a),n}(t))),$n(n,["functionDeclarations"],t)}if(void 0!==zn(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=zn(t,["googleSearch"]);null!=o&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);if(null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e)),void 0!==zn(t,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");return n}(o));const i=zn(t,["googleSearchRetrieval"]);if(null!=i&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(i)),void 0!==zn(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==zn(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const s=zn(t,["computerUse"]);null!=s&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(s));const r=zn(t,["codeExecution"]);return null!=r&&$n(n,["codeExecution"],r),n}(Ge(t)))),$n(e,["tools"],t)}const T=zn(n,["toolConfig"]);if(void 0!==e&&null!=T&&$n(e,["toolConfig"],function(t){const n={},e=zn(t,["functionCallingConfig"]);null!=e&&$n(n,["functionCallingConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["allowedFunctionNames"]);return null!=o&&$n(n,["allowedFunctionNames"],o),n}(e));const o=zn(t,["retrievalConfig"]);return null!=o&&$n(n,["retrievalConfig"],function(t){const n={},e=zn(t,["latLng"]);null!=e&&$n(n,["latLng"],function(t){const n={},e=zn(t,["latitude"]);null!=e&&$n(n,["latitude"],e);const o=zn(t,["longitude"]);return null!=o&&$n(n,["longitude"],o),n}(e));const o=zn(t,["languageCode"]);return null!=o&&$n(n,["languageCode"],o),n}(o)),n}(T)),void 0!==zn(n,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const E=zn(n,["cachedContent"]);void 0!==e&&null!=E&&$n(e,["cachedContent"],Fe(t,E));const A=zn(n,["responseModalities"]);null!=A&&$n(o,["responseModalities"],A);const I=zn(n,["mediaResolution"]);null!=I&&$n(o,["mediaResolution"],I);const O=zn(n,["speechConfig"]);if(null!=O&&$n(o,["speechConfig"],function(t){const n={},e=zn(t,["voiceConfig"]);null!=e&&$n(n,["voiceConfig"],Qe(e));const o=zn(t,["multiSpeakerVoiceConfig"]);null!=o&&$n(n,["multiSpeakerVoiceConfig"],function(t){const n={},e=zn(t,["speakerVoiceConfigs"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["speaker"]);null!=e&&$n(n,["speaker"],e);const o=zn(t,["voiceConfig"]);return null!=o&&$n(n,["voiceConfig"],Qe(o)),n}(t))),$n(n,["speakerVoiceConfigs"],t)}return n}(o));const i=zn(t,["languageCode"]);return null!=i&&$n(n,["languageCode"],i),n}(Le(O))),void 0!==zn(n,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const S=zn(n,["thinkingConfig"]);return null!=S&&$n(o,["thinkingConfig"],function(t){const n={},e=zn(t,["includeThoughts"]);null!=e&&$n(n,["includeThoughts"],e);const o=zn(t,["thinkingBudget"]);return null!=o&&$n(n,["thinkingBudget"],o),n}(S)),o}(t,s,e)),e}(t,n))),$n(e,["requests","requests"],n)}return e}(t,$e(t,i)));const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["displayName"]);if(void 0!==n&&null!=e&&$n(n,["batch","displayName"],e),void 0!==zn(t,["dest"]))throw new Error("dest parameter is not supported in Gemini API.");return{}}(s,e)),e}function no(t){const n={},e=zn(t,["details"]);null!=e&&$n(n,["details"],e);const o=zn(t,["code"]);null!=o&&$n(n,["code"],o);const i=zn(t,["message"]);return null!=i&&$n(n,["message"],i),n}function eo(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["metadata","displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["metadata","state"]);null!=i&&$n(n,["state"],Xe(i));const s=zn(t,["metadata","createTime"]);null!=s&&$n(n,["createTime"],s);const r=zn(t,["metadata","endTime"]);null!=r&&$n(n,["endTime"],r);const l=zn(t,["metadata","updateTime"]);null!=l&&$n(n,["updateTime"],l);const a=zn(t,["metadata","model"]);null!=a&&$n(n,["model"],a);const u=zn(t,["metadata","output"]);return null!=u&&$n(n,["dest"],function(t){const n={},e=zn(t,["responsesFile"]);null!=e&&$n(n,["fileName"],e);const o=zn(t,["inlinedResponses","inlinedResponses"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["response"]);null!=e&&$n(n,["response"],function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["candidates"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["content"]);null!=e&&$n(n,["content"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(e));const o=zn(t,["citationMetadata"]);null!=o&&$n(n,["citationMetadata"],function(t){const n={},e=zn(t,["citationSources"]);return null!=e&&$n(n,["citations"],e),n}(o));const i=zn(t,["tokenCount"]);null!=i&&$n(n,["tokenCount"],i);const s=zn(t,["finishReason"]);null!=s&&$n(n,["finishReason"],s);const r=zn(t,["urlContextMetadata"]);null!=r&&$n(n,["urlContextMetadata"],function(t){const n={},e=zn(t,["urlMetadata"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["retrievedUrl"]);null!=e&&$n(n,["retrievedUrl"],e);const o=zn(t,["urlRetrievalStatus"]);return null!=o&&$n(n,["urlRetrievalStatus"],o),n}(t))),$n(n,["urlMetadata"],t)}return n}(r));const l=zn(t,["avgLogprobs"]);null!=l&&$n(n,["avgLogprobs"],l);const a=zn(t,["groundingMetadata"]);null!=a&&$n(n,["groundingMetadata"],a);const u=zn(t,["index"]);null!=u&&$n(n,["index"],u);const c=zn(t,["logprobsResult"]);null!=c&&$n(n,["logprobsResult"],c);const d=zn(t,["safetyRatings"]);return null!=d&&$n(n,["safetyRatings"],d),n}(t))),$n(n,["candidates"],t)}const i=zn(t,["modelVersion"]);null!=i&&$n(n,["modelVersion"],i);const s=zn(t,["promptFeedback"]);null!=s&&$n(n,["promptFeedback"],s);const r=zn(t,["responseId"]);null!=r&&$n(n,["responseId"],r);const l=zn(t,["usageMetadata"]);return null!=l&&$n(n,["usageMetadata"],l),n}(e));const o=zn(t,["error"]);return null!=o&&$n(n,["error"],no(o)),n}(t))),$n(n,["inlinedResponses"],t)}return n}(u)),n}function oo(t){const n={},e=zn(t,["details"]);null!=e&&$n(n,["details"],e);const o=zn(t,["code"]);null!=o&&$n(n,["code"],o);const i=zn(t,["message"]);return null!=i&&$n(n,["message"],i),n}function io(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["state"]);null!=i&&$n(n,["state"],Xe(i));const s=zn(t,["error"]);null!=s&&$n(n,["error"],oo(s));const r=zn(t,["createTime"]);null!=r&&$n(n,["createTime"],r);const l=zn(t,["startTime"]);null!=l&&$n(n,["startTime"],l);const a=zn(t,["endTime"]);null!=a&&$n(n,["endTime"],a);const u=zn(t,["updateTime"]);null!=u&&$n(n,["updateTime"],u);const c=zn(t,["model"]);null!=c&&$n(n,["model"],c);const d=zn(t,["inputConfig"]);null!=d&&$n(n,["src"],function(t){const n={},e=zn(t,["instancesFormat"]);null!=e&&$n(n,["format"],e);const o=zn(t,["gcsSource","uris"]);null!=o&&$n(n,["gcsUri"],o);const i=zn(t,["bigquerySource","inputUri"]);return null!=i&&$n(n,["bigqueryUri"],i),n}(d));const p=zn(t,["outputConfig"]);return null!=p&&$n(n,["dest"],function(t){const n={},e=zn(t,["predictionsFormat"]);null!=e&&$n(n,["format"],e);const o=zn(t,["gcsDestination","outputUriPrefix"]);null!=o&&$n(n,["gcsUri"],o);const i=zn(t,["bigqueryDestination","outputUri"]);return null!=i&&$n(n,["bigqueryUri"],i),n}(p)),n}(Hn=Gn||(Gn={})).PAGED_ITEM_BATCH_JOBS="batchJobs",Hn.PAGED_ITEM_MODELS="models",Hn.PAGED_ITEM_TUNING_JOBS="tuningJobs",Hn.PAGED_ITEM_FILES="files",Hn.PAGED_ITEM_CACHED_CONTENTS="cachedContents";class so{constructor(t,n,e,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,e,o)}init(t,n,e){var o,i;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=null==n?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};s=e&&0!==Object.keys(e).length?"object"==typeof e?Object.assign({},e):e:{config:{}},s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=null!==(i=null===(o=s.config)||void 0===o?void 0:o.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return void 0!==(null===(t=this.params.config)||void 0===t?void 0:t.pageToken)}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */class ro extends Wn{constructor(t){super(),this.apiClient=t,this.create=async t=>{var n,e;if(this.apiClient.isVertexAI()){const n=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},void 0===t.config.displayName&&(t.config.displayName="genaiBatchJob_${timestampStr}"),void 0===t.config.dest&&"string"==typeof t.src)if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else{if(!t.src.startsWith("bq://"))throw new Error("Unsupported source:"+t.src);t.config.dest=`${t.src}_dest_${n}`}}else if(Array.isArray(t.src)||"string"!=typeof t.src&&t.src.inlinedRequests){let o="",i={};const s=to(this.apiClient,t);o=Kn("{model}:batchGenerateContent",s._url),i=s._query;const r=s.batch.inputConfig.requests,l=r.requests,a=[];for(const t of l){const n=t;if(n.systemInstruction){const t=n.systemInstruction;delete n.systemInstruction;const e=n.request;e.systemInstruction=t,n.request=e}a.push(n)}return r.requests=a,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()).then(t=>eo(t))}return await this.createInternal(t)},this.list=async(t={})=>new so(Gn.PAGED_ITEM_BATCH_JOBS,t=>this.listInternal(t),await this.listInternal(t),t)}async createInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["model"],Te(t,o));const i=zn(n,["src"]);null!=i&&$n(e,["inputConfig"],function(t){const n={},e=zn(t,["format"]);null!=e&&$n(n,["instancesFormat"],e);const o=zn(t,["gcsUri"]);null!=o&&$n(n,["gcsSource","uris"],o);const i=zn(t,["bigqueryUri"]);if(null!=i&&$n(n,["bigquerySource","inputUri"],i),void 0!==zn(t,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==zn(t,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return n}($e(t,i)));const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["displayName"]);void 0!==n&&null!=e&&$n(n,["displayName"],e);const o=zn(t,["dest"]);return void 0!==n&&null!=o&&$n(n,["outputConfig"],function(t){const n={},e=zn(t,["format"]);null!=e&&$n(n,["predictionsFormat"],e);const o=zn(t,["gcsUri"]);null!=o&&$n(n,["gcsDestination","outputUriPrefix"],o);const i=zn(t,["bigqueryUri"]);if(null!=i&&$n(n,["bigqueryDestination","outputUri"],i),void 0!==zn(t,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==zn(t,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return n}(function(t){if("string"!=typeof t)return t;const n=t;if(n.startsWith("gs://"))return{format:"jsonl",gcsUri:n};if(n.startsWith("bq://"))return{format:"bigquery",bigqueryUri:n};throw new Error(`Unsupported destination: ${n}`)}(o))),{}}(s,e)),e}(this.apiClient,t);return r=Kn("batchPredictionJobs",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>io(t))}{const n=to(this.apiClient,t);return r=Kn("{model}:batchGenerateContent",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>eo(t))}}async get(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],ze(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("batchPredictionJobs/{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>io(t))}{const n=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],ze(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("batches/{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>eo(t))}}async cancel(t){var n,e,o,i;let s="",r={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],ze(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);s=Kn("batchPredictionJobs/{name}:cancel",o._url),r=o._query,delete o.config,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal})}else{const n=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],ze(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);s=Kn("batches/{name}:cancel",n._url),r=n._query,delete n.config,delete n._url,delete n._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal})}}async listInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t){const n={},e=zn(t,["config"]);return null!=e&&$n(n,["config"],function(t,n){const e=zn(t,["pageSize"]);void 0!==n&&null!=e&&$n(n,["_query","pageSize"],e);const o=zn(t,["pageToken"]);void 0!==n&&null!=o&&$n(n,["_query","pageToken"],o);const i=zn(t,["filter"]);return void 0!==n&&null!=i&&$n(n,["_query","filter"],i),{}}(e,n)),n}(t);return r=Kn("batchPredictionJobs",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["batchPredictionJobs"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>io(t))),$n(n,["batchJobs"],t)}return n}(t),e=new _e;return Object.assign(e,n),e})}{const n=function(t){const n={},e=zn(t,["config"]);return null!=e&&$n(n,["config"],function(t,n){const e=zn(t,["pageSize"]);void 0!==n&&null!=e&&$n(n,["_query","pageSize"],e);const o=zn(t,["pageToken"]);if(void 0!==n&&null!=o&&$n(n,["_query","pageToken"],o),void 0!==zn(t,["filter"]))throw new Error("filter parameter is not supported in Gemini API.");return{}}(e,n)),n}(t);return r=Kn("batches",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["operations"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>eo(t))),$n(n,["batchJobs"],t)}return n}(t),e=new _e;return Object.assign(e,n),e})}}async delete(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],ze(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("batchPredictionJobs/{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["done"]);null!=i&&$n(n,["done"],i);const s=zn(t,["error"]);return null!=s&&$n(n,["error"],oo(s)),n}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */(t))}{const n=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],ze(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("batches/{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["done"]);null!=i&&$n(n,["done"],i);const s=zn(t,["error"]);return null!=s&&$n(n,["error"],no(s)),n}(t))}}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function lo(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}function ao(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["data"]);null!=o&&$n(n,["data"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["fileUri"]);null!=o&&$n(n,["fileUri"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}function uo(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["model"]);null!=i&&$n(n,["model"],i);const s=zn(t,["createTime"]);null!=s&&$n(n,["createTime"],s);const r=zn(t,["updateTime"]);null!=r&&$n(n,["updateTime"],r);const l=zn(t,["expireTime"]);null!=l&&$n(n,["expireTime"],l);const a=zn(t,["usageMetadata"]);return null!=a&&$n(n,["usageMetadata"],a),n}function co(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["model"]);null!=i&&$n(n,["model"],i);const s=zn(t,["createTime"]);null!=s&&$n(n,["createTime"],s);const r=zn(t,["updateTime"]);null!=r&&$n(n,["updateTime"],r);const l=zn(t,["expireTime"]);null!=l&&$n(n,["expireTime"],l);const a=zn(t,["usageMetadata"]);return null!=a&&$n(n,["usageMetadata"],a),n}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
class po extends Wn{constructor(t){super(),this.apiClient=t,this.list=async(t={})=>new so(Gn.PAGED_ITEM_CACHED_CONTENTS,t=>this.listInternal(t),await this.listInternal(t),t)}async create(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["model"],Ee(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["ttl"]);void 0!==n&&null!=e&&$n(n,["ttl"],e);const o=zn(t,["expireTime"]);void 0!==n&&null!=o&&$n(n,["expireTime"],o);const i=zn(t,["displayName"]);void 0!==n&&null!=i&&$n(n,["displayName"],i);const s=zn(t,["contents"]);if(void 0!==n&&null!=s){let t=xe(s);Array.isArray(t)&&(t=t.map(t=>ao(t))),$n(n,["contents"],t)}const r=zn(t,["systemInstruction"]);void 0!==n&&null!=r&&$n(n,["systemInstruction"],ao(Me(r)));const l=zn(t,["tools"]);if(void 0!==n&&null!=l){let t=l;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={};if(void 0!==zn(t,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const e=zn(t,["description"]);null!=e&&$n(n,["description"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["parameters"]);null!=i&&$n(n,["parameters"],i);const s=zn(t,["parametersJsonSchema"]);null!=s&&$n(n,["parametersJsonSchema"],s);const r=zn(t,["response"]);null!=r&&$n(n,["response"],r);const l=zn(t,["responseJsonSchema"]);return null!=l&&$n(n,["responseJsonSchema"],l),n}(t))),$n(n,["functionDeclarations"],t)}const o=zn(t,["retrieval"]);null!=o&&$n(n,["retrieval"],o);const i=zn(t,["googleSearch"]);null!=i&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e));const o=zn(t,["excludeDomains"]);return null!=o&&$n(n,["excludeDomains"],o),n}(i));const s=zn(t,["googleSearchRetrieval"]);null!=s&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(s));const r=zn(t,["enterpriseWebSearch"]);null!=r&&$n(n,["enterpriseWebSearch"],function(t){const n={},e=zn(t,["excludeDomains"]);return null!=e&&$n(n,["excludeDomains"],e),n}(r));const l=zn(t,["googleMaps"]);null!=l&&$n(n,["googleMaps"],function(t){const n={},e=zn(t,["authConfig"]);return null!=e&&$n(n,["authConfig"],function(t){const n={},e=zn(t,["apiKeyConfig"]);null!=e&&$n(n,["apiKeyConfig"],function(t){const n={},e=zn(t,["apiKeyString"]);return null!=e&&$n(n,["apiKeyString"],e),n}(e));const o=zn(t,["authType"]);null!=o&&$n(n,["authType"],o);const i=zn(t,["googleServiceAccountConfig"]);null!=i&&$n(n,["googleServiceAccountConfig"],i);const s=zn(t,["httpBasicAuthConfig"]);null!=s&&$n(n,["httpBasicAuthConfig"],s);const r=zn(t,["oauthConfig"]);null!=r&&$n(n,["oauthConfig"],r);const l=zn(t,["oidcConfig"]);return null!=l&&$n(n,["oidcConfig"],l),n}(e)),n}(l)),null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const a=zn(t,["computerUse"]);null!=a&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(a));const u=zn(t,["codeExecution"]);return null!=u&&$n(n,["codeExecution"],u),n}(t))),$n(n,["tools"],t)}const a=zn(t,["toolConfig"]);void 0!==n&&null!=a&&$n(n,["toolConfig"],function(t){const n={},e=zn(t,["functionCallingConfig"]);null!=e&&$n(n,["functionCallingConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["allowedFunctionNames"]);return null!=o&&$n(n,["allowedFunctionNames"],o),n}(e));const o=zn(t,["retrievalConfig"]);return null!=o&&$n(n,["retrievalConfig"],function(t){const n={},e=zn(t,["latLng"]);null!=e&&$n(n,["latLng"],function(t){const n={},e=zn(t,["latitude"]);null!=e&&$n(n,["latitude"],e);const o=zn(t,["longitude"]);return null!=o&&$n(n,["longitude"],o),n}(e));const o=zn(t,["languageCode"]);return null!=o&&$n(n,["languageCode"],o),n}(o)),n}(a));const u=zn(t,["kmsKeyName"]);return void 0!==n&&null!=u&&$n(n,["encryption_spec","kmsKeyName"],u),{}}(i,e)),e}(this.apiClient,t);return r=Kn("cachedContents",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>co(t))}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["model"],Ee(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["ttl"]);void 0!==n&&null!=e&&$n(n,["ttl"],e);const o=zn(t,["expireTime"]);void 0!==n&&null!=o&&$n(n,["expireTime"],o);const i=zn(t,["displayName"]);void 0!==n&&null!=i&&$n(n,["displayName"],i);const s=zn(t,["contents"]);if(void 0!==n&&null!=s){let t=xe(s);Array.isArray(t)&&(t=t.map(t=>lo(t))),$n(n,["contents"],t)}const r=zn(t,["systemInstruction"]);void 0!==n&&null!=r&&$n(n,["systemInstruction"],lo(Me(r)));const l=zn(t,["tools"]);if(void 0!==n&&null!=l){let t=l;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["behavior"]);null!=e&&$n(n,["behavior"],e);const o=zn(t,["description"]);null!=o&&$n(n,["description"],o);const i=zn(t,["name"]);null!=i&&$n(n,["name"],i);const s=zn(t,["parameters"]);null!=s&&$n(n,["parameters"],s);const r=zn(t,["parametersJsonSchema"]);null!=r&&$n(n,["parametersJsonSchema"],r);const l=zn(t,["response"]);null!=l&&$n(n,["response"],l);const a=zn(t,["responseJsonSchema"]);return null!=a&&$n(n,["responseJsonSchema"],a),n}(t))),$n(n,["functionDeclarations"],t)}if(void 0!==zn(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=zn(t,["googleSearch"]);null!=o&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);if(null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e)),void 0!==zn(t,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");return n}(o));const i=zn(t,["googleSearchRetrieval"]);if(null!=i&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(i)),void 0!==zn(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==zn(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const s=zn(t,["computerUse"]);null!=s&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(s));const r=zn(t,["codeExecution"]);return null!=r&&$n(n,["codeExecution"],r),n}(t))),$n(n,["tools"],t)}const a=zn(t,["toolConfig"]);if(void 0!==n&&null!=a&&$n(n,["toolConfig"],function(t){const n={},e=zn(t,["functionCallingConfig"]);null!=e&&$n(n,["functionCallingConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["allowedFunctionNames"]);return null!=o&&$n(n,["allowedFunctionNames"],o),n}(e));const o=zn(t,["retrievalConfig"]);return null!=o&&$n(n,["retrievalConfig"],function(t){const n={},e=zn(t,["latLng"]);null!=e&&$n(n,["latLng"],function(t){const n={},e=zn(t,["latitude"]);null!=e&&$n(n,["latitude"],e);const o=zn(t,["longitude"]);return null!=o&&$n(n,["longitude"],o),n}(e));const o=zn(t,["languageCode"]);return null!=o&&$n(n,["languageCode"],o),n}(o)),n}(a)),void 0!==zn(t,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}(i,e)),e}(this.apiClient,t);return r=Kn("cachedContents",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>uo(t))}}async get(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],Fe(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>co(t))}{const n=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],Fe(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>uo(t))}}async delete(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],Fe(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(()=>{const t=new pe;return Object.assign(t,{}),t})}{const n=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],Fe(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(()=>{const t=new pe;return Object.assign(t,{}),t})}}async update(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],Fe(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["ttl"]);void 0!==n&&null!=e&&$n(n,["ttl"],e);const o=zn(t,["expireTime"]);return void 0!==n&&null!=o&&$n(n,["expireTime"],o),{}}(i,e)),e}(this.apiClient,t);return r=Kn("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>co(t))}{const n=function(t,n){const e={},o=zn(n,["name"]);null!=o&&$n(e,["_url","name"],Fe(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["ttl"]);void 0!==n&&null!=e&&$n(n,["ttl"],e);const o=zn(t,["expireTime"]);return void 0!==n&&null!=o&&$n(n,["expireTime"],o),{}}(i,e)),e}(this.apiClient,t);return r=Kn("{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>uo(t))}}async listInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t){const n={},e=zn(t,["config"]);return null!=e&&$n(n,["config"],function(t,n){const e=zn(t,["pageSize"]);void 0!==n&&null!=e&&$n(n,["_query","pageSize"],e);const o=zn(t,["pageToken"]);return void 0!==n&&null!=o&&$n(n,["_query","pageToken"],o),{}}(e,n)),n}(t);return r=Kn("cachedContents",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["cachedContents"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>co(t))),$n(n,["cachedContents"],t)}return n}(t),e=new fe;return Object.assign(e,n),e})}{const n=function(t){const n={},e=zn(t,["config"]);return null!=e&&$n(n,["config"],function(t,n){const e=zn(t,["pageSize"]);void 0!==n&&null!=e&&$n(n,["_query","pageSize"],e);const o=zn(t,["pageToken"]);return void 0!==n&&null!=o&&$n(n,["_query","pageToken"],o),{}}(e,n)),n}(t);return r=Kn("cachedContents",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["cachedContents"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>uo(t))),$n(n,["cachedContents"],t)}return n}(t),e=new fe;return Object.assign(e,n),e})}}}function fo(t){return this instanceof fo?(this.v=t,this):new fo(t)}function ho(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=e.apply(t,n||[]),s=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),r("next"),r("throw"),r("return",function(t){return function(n){return Promise.resolve(n).then(t,u)}}),o[Symbol.asyncIterator]=function(){return this},o;function r(t,n){i[t]&&(o[t]=function(n){return new Promise(function(e,o){s.push([t,n,e,o])>1||l(t,n)})},n&&(o[t]=n(o[t])))}function l(t,n){try{(e=i[t](n)).value instanceof fo?Promise.resolve(e.value.v).then(a,u):c(s[0][2],e)}catch(ki){c(s[0][3],ki)}var e}function a(t){l("next",t)}function u(t){l("throw",t)}function c(t,n){t(n),s.shift(),s.length&&l(s[0][0],s[0][1])}}function mo(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],o=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(e){n[e]=t[e]&&function(n){return new Promise(function(o,i){!function(t,n,e,o){Promise.resolve(o).then(function(n){t({value:n,done:e})},n)}(o,i,(n=t[e](n)).done,n.value)})}}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function go(t){var n;if(null==t.candidates||0===t.candidates.length)return!1;const e=null===(n=t.candidates[0])||void 0===n?void 0:n.content;return void 0!==e&&_o(e)}function _o(t){if(void 0===t.parts||0===t.parts.length)return!1;for(const n of t.parts)if(void 0===n||0===Object.keys(n).length)return!1;return!0}function yo(t){if(void 0===t||0===t.length)return[];const n=[],e=t.length;let o=0;for(;o<e;)if("user"===t[o].role)n.push(t[o]),o++;else{const i=[];let s=!0;for(;o<e&&"model"===t[o].role;)i.push(t[o]),s&&!_o(t[o])&&(s=!1),o++;s?n.push(...i):n.pop()}return n}class vo{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new Co(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class Co{constructor(t,n,e,o={},i=[]){this.apiClient=t,this.modelsModule=n,this.model=e,this.config=o,this.history=i,this.sendPromise=Promise.resolve(),function(t){if(0!==t.length)for(const n of t)if("user"!==n.role&&"model"!==n.role)throw new Error(`Role must be user or model, but got ${n.role}.`)}(i)}async sendMessage(t){var n;await this.sendPromise;const e=Me(t.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(e),config:null!==(n=t.config)&&void 0!==n?n:this.config});return this.sendPromise=(async()=>{var t,n,i;const s=await o,r=null===(n=null===(t=s.candidates)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content,l=s.automaticFunctionCallingHistory,a=this.getHistory(!0).length;let u=[];null!=l&&(u=null!==(i=l.slice(a))&&void 0!==i?i:[]);const c=r?[r]:[];this.recordHistory(e,c,u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(t){var n;await this.sendPromise;const e=Me(t.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(e),config:null!==(n=t.config)&&void 0!==n?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const i=await o;return this.processStreamResponse(i,e)}getHistory(t=!1){const n=t?yo(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var e,o;return ho(this,arguments,function*(){var i,s,r,l;const a=[];try{for(var u,c=!0,d=mo(t);!(i=(u=yield fo(d.next())).done);c=!0){l=u.value,c=!1;const t=l;if(go(t)){const n=null===(o=null===(e=t.candidates)||void 0===e?void 0:e[0])||void 0===o?void 0:o.content;void 0!==n&&a.push(n)}yield yield fo(t)}}catch(p){s={error:p}}finally{try{c||i||!(r=d.return)||(yield fo(r.call(d)))}finally{if(s)throw s.error}}this.recordHistory(n,a)})}recordHistory(t,n,e){let o=[];n.length>0&&n.every(t=>void 0!==t.role)?o=n:o.push({role:"model",parts:[]}),e&&e.length>0?this.history.push(...yo(e)):this.history.push(t),this.history.push(...o)}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */class To extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,To.prototype)}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function Eo(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["mimeType"]);null!=i&&$n(n,["mimeType"],i);const s=zn(t,["sizeBytes"]);null!=s&&$n(n,["sizeBytes"],s);const r=zn(t,["createTime"]);null!=r&&$n(n,["createTime"],r);const l=zn(t,["expirationTime"]);null!=l&&$n(n,["expirationTime"],l);const a=zn(t,["updateTime"]);null!=a&&$n(n,["updateTime"],a);const u=zn(t,["sha256Hash"]);null!=u&&$n(n,["sha256Hash"],u);const c=zn(t,["uri"]);null!=c&&$n(n,["uri"],c);const d=zn(t,["downloadUri"]);null!=d&&$n(n,["downloadUri"],d);const p=zn(t,["state"]);null!=p&&$n(n,["state"],p);const f=zn(t,["source"]);null!=f&&$n(n,["source"],f);const h=zn(t,["videoMetadata"]);null!=h&&$n(n,["videoMetadata"],h);const m=zn(t,["error"]);return null!=m&&$n(n,["error"],function(t){const n={},e=zn(t,["details"]);null!=e&&$n(n,["details"],e);const o=zn(t,["message"]);null!=o&&$n(n,["message"],o);const i=zn(t,["code"]);return null!=i&&$n(n,["code"],i),n}(m)),n}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
class Ao extends Wn{constructor(t){super(),this.apiClient=t,this.list=async(t={})=>new so(Gn.PAGED_ITEM_FILES,t=>this.listInternal(t),await this.listInternal(t),t)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(t=>Eo(t))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(t){const n={},e=zn(t,["config"]);return null!=e&&$n(n,["config"],function(t,n){const e=zn(t,["pageSize"]);void 0!==n&&null!=e&&$n(n,["_query","pageSize"],e);const o=zn(t,["pageToken"]);return void 0!==n&&null!=o&&$n(n,["_query","pageToken"],o),{}}(e,n)),n}(t);return i=Kn("files",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),o.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["files"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>Eo(t))),$n(n,["files"],t)}return n}(t),e=new he;return Object.assign(e,n),e})}}async createInternal(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(t){const n={},e=zn(t,["file"]);null!=e&&$n(n,["file"],function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["mimeType"]);null!=i&&$n(n,["mimeType"],i);const s=zn(t,["sizeBytes"]);null!=s&&$n(n,["sizeBytes"],s);const r=zn(t,["createTime"]);null!=r&&$n(n,["createTime"],r);const l=zn(t,["expirationTime"]);null!=l&&$n(n,["expirationTime"],l);const a=zn(t,["updateTime"]);null!=a&&$n(n,["updateTime"],a);const u=zn(t,["sha256Hash"]);null!=u&&$n(n,["sha256Hash"],u);const c=zn(t,["uri"]);null!=c&&$n(n,["uri"],c);const d=zn(t,["downloadUri"]);null!=d&&$n(n,["downloadUri"],d);const p=zn(t,["state"]);null!=p&&$n(n,["state"],p);const f=zn(t,["source"]);null!=f&&$n(n,["source"],f);const h=zn(t,["videoMetadata"]);null!=h&&$n(n,["videoMetadata"],h);const m=zn(t,["error"]);return null!=m&&$n(n,["error"],function(t){const n={},e=zn(t,["details"]);null!=e&&$n(n,["details"],e);const o=zn(t,["message"]);null!=o&&$n(n,["message"],o);const i=zn(t,["code"]);return null!=i&&$n(n,["code"],i),n}(m)),n}(e));const o=zn(t,["config"]);return null!=o&&$n(n,["config"],o),n}(t);return i=Kn("upload/v1beta/files",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),o.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);return null!=e&&$n(n,["sdkHttpResponse"],e),n}(t),e=new me;return Object.assign(e,n),e})}}async get(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["_url","file"],Be(e));const o=zn(t,["config"]);return null!=o&&$n(n,["config"],o),n}(t);return i=Kn("files/{file}",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),o.then(t=>Eo(t))}}async delete(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["_url","file"],Be(e));const o=zn(t,["config"]);return null!=o&&$n(n,["config"],o),n}(t);return i=Kn("files/{file}",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),o.then(()=>{const t=new ge;return Object.assign(t,{}),t})}}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function Io(t){const n={},e=zn(t,["prebuiltVoiceConfig"]);return null!=e&&$n(n,["prebuiltVoiceConfig"],function(t){const n={},e=zn(t,["voiceName"]);return null!=e&&$n(n,["voiceName"],e),n}(e)),n}function Oo(t){const n={},e=zn(t,["media"]);null!=e&&$n(n,["mediaChunks"],Ae(e));const o=zn(t,["audio"]);null!=o&&$n(n,["audio"],Se(o));const i=zn(t,["audioStreamEnd"]);null!=i&&$n(n,["audioStreamEnd"],i);const s=zn(t,["video"]);null!=s&&$n(n,["video"],Oe(s));const r=zn(t,["text"]);return null!=r&&$n(n,["text"],r),null!=zn(t,["activityStart"])&&$n(n,["activityStart"],{}),null!=zn(t,["activityEnd"])&&$n(n,["activityEnd"],{}),n}function So(t){const n={},e=zn(t,["text"]);null!=e&&$n(n,["text"],e);const o=zn(t,["weight"]);return null!=o&&$n(n,["weight"],o),n}function bo(t){const n={},e=zn(t,["temperature"]);null!=e&&$n(n,["temperature"],e);const o=zn(t,["topK"]);null!=o&&$n(n,["topK"],o);const i=zn(t,["seed"]);null!=i&&$n(n,["seed"],i);const s=zn(t,["guidance"]);null!=s&&$n(n,["guidance"],s);const r=zn(t,["bpm"]);null!=r&&$n(n,["bpm"],r);const l=zn(t,["density"]);null!=l&&$n(n,["density"],l);const a=zn(t,["brightness"]);null!=a&&$n(n,["brightness"],a);const u=zn(t,["scale"]);null!=u&&$n(n,["scale"],u);const c=zn(t,["muteBass"]);null!=c&&$n(n,["muteBass"],c);const d=zn(t,["muteDrums"]);null!=d&&$n(n,["muteDrums"],d);const p=zn(t,["onlyBassAndDrums"]);null!=p&&$n(n,["onlyBassAndDrums"],p);const f=zn(t,["musicGenerationMode"]);return null!=f&&$n(n,["musicGenerationMode"],f),n}function wo(t){const n={},e=zn(t,["model"]);return null!=e&&$n(n,["model"],e),n}function Ro(t){const n={},e=zn(t,["weightedPrompts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>So(t))),$n(n,["weightedPrompts"],t)}return n}function No(t){const n={},e=zn(t,["setup"]);null!=e&&$n(n,["setup"],wo(e));const o=zn(t,["clientContent"]);null!=o&&$n(n,["clientContent"],Ro(o));const i=zn(t,["musicGenerationConfig"]);null!=i&&$n(n,["musicGenerationConfig"],bo(i));const s=zn(t,["playbackControl"]);return null!=s&&$n(n,["playbackControl"],s),n}function Po(t){const n={},e=zn(t,["media"]);null!=e&&$n(n,["mediaChunks"],Ae(e));const o=zn(t,["audio"]);null!=o&&$n(n,["audio"],Se(o));const i=zn(t,["audioStreamEnd"]);null!=i&&$n(n,["audioStreamEnd"],i);const s=zn(t,["video"]);null!=s&&$n(n,["video"],Oe(s));const r=zn(t,["text"]);return null!=r&&$n(n,["text"],r),null!=zn(t,["activityStart"])&&$n(n,["activityStart"],{}),null!=zn(t,["activityEnd"])&&$n(n,["activityEnd"],{}),n}function Mo(t){const n={},e=zn(t,["text"]);null!=e&&$n(n,["text"],e);const o=zn(t,["finished"]);return null!=o&&$n(n,["finished"],o),n}function Do(t){const n={},e=zn(t,["modality"]);null!=e&&$n(n,["modality"],e);const o=zn(t,["tokenCount"]);return null!=o&&$n(n,["tokenCount"],o),n}function xo(t){const n={},e=zn(t,["text"]);null!=e&&$n(n,["text"],e);const o=zn(t,["finished"]);return null!=o&&$n(n,["finished"],o),n}function Uo(t){const n={},e=zn(t,["modality"]);null!=e&&$n(n,["modality"],e);const o=zn(t,["tokenCount"]);return null!=o&&$n(n,["tokenCount"],o),n}function ko(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}function Lo(t){const n={},e=zn(t,["prebuiltVoiceConfig"]);return null!=e&&$n(n,["prebuiltVoiceConfig"],function(t){const n={},e=zn(t,["voiceName"]);return null!=e&&$n(n,["voiceName"],e),n}(e)),n}function qo(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["contents"]);if(null!=i){let t=xe(i);Array.isArray(t)&&(t=t.map(t=>ko(t))),$n(e,["contents"],t)}const s=zn(n,["config"]);return null!=s&&$n(e,["generationConfig"],function(t,n,e){const o={},i=zn(n,["systemInstruction"]);void 0!==e&&null!=i&&$n(e,["systemInstruction"],ko(Me(i)));const s=zn(n,["temperature"]);null!=s&&$n(o,["temperature"],s);const r=zn(n,["topP"]);null!=r&&$n(o,["topP"],r);const l=zn(n,["topK"]);null!=l&&$n(o,["topK"],l);const a=zn(n,["candidateCount"]);null!=a&&$n(o,["candidateCount"],a);const u=zn(n,["maxOutputTokens"]);null!=u&&$n(o,["maxOutputTokens"],u);const c=zn(n,["stopSequences"]);null!=c&&$n(o,["stopSequences"],c);const d=zn(n,["responseLogprobs"]);null!=d&&$n(o,["responseLogprobs"],d);const p=zn(n,["logprobs"]);null!=p&&$n(o,["logprobs"],p);const f=zn(n,["presencePenalty"]);null!=f&&$n(o,["presencePenalty"],f);const h=zn(n,["frequencyPenalty"]);null!=h&&$n(o,["frequencyPenalty"],h);const m=zn(n,["seed"]);null!=m&&$n(o,["seed"],m);const g=zn(n,["responseMimeType"]);null!=g&&$n(o,["responseMimeType"],g);const _=zn(n,["responseSchema"]);null!=_&&$n(o,["responseSchema"],function(t){const n={},e=zn(t,["anyOf"]);null!=e&&$n(n,["anyOf"],e);const o=zn(t,["default"]);null!=o&&$n(n,["default"],o);const i=zn(t,["description"]);null!=i&&$n(n,["description"],i);const s=zn(t,["enum"]);null!=s&&$n(n,["enum"],s);const r=zn(t,["example"]);null!=r&&$n(n,["example"],r);const l=zn(t,["format"]);null!=l&&$n(n,["format"],l);const a=zn(t,["items"]);null!=a&&$n(n,["items"],a);const u=zn(t,["maxItems"]);null!=u&&$n(n,["maxItems"],u);const c=zn(t,["maxLength"]);null!=c&&$n(n,["maxLength"],c);const d=zn(t,["maxProperties"]);null!=d&&$n(n,["maxProperties"],d);const p=zn(t,["maximum"]);null!=p&&$n(n,["maximum"],p);const f=zn(t,["minItems"]);null!=f&&$n(n,["minItems"],f);const h=zn(t,["minLength"]);null!=h&&$n(n,["minLength"],h);const m=zn(t,["minProperties"]);null!=m&&$n(n,["minProperties"],m);const g=zn(t,["minimum"]);null!=g&&$n(n,["minimum"],g);const _=zn(t,["nullable"]);null!=_&&$n(n,["nullable"],_);const y=zn(t,["pattern"]);null!=y&&$n(n,["pattern"],y);const v=zn(t,["properties"]);null!=v&&$n(n,["properties"],v);const C=zn(t,["propertyOrdering"]);null!=C&&$n(n,["propertyOrdering"],C);const T=zn(t,["required"]);null!=T&&$n(n,["required"],T);const E=zn(t,["title"]);null!=E&&$n(n,["title"],E);const A=zn(t,["type"]);return null!=A&&$n(n,["type"],A),n}(ke(_)));const y=zn(n,["responseJsonSchema"]);if(null!=y&&$n(o,["responseJsonSchema"],y),void 0!==zn(n,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==zn(n,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=zn(n,["safetySettings"]);if(void 0!==e&&null!=v){let t=v;Array.isArray(t)&&(t=t.map(t=>function(t){const n={};if(void 0!==zn(t,["method"]))throw new Error("method parameter is not supported in Gemini API.");const e=zn(t,["category"]);null!=e&&$n(n,["category"],e);const o=zn(t,["threshold"]);return null!=o&&$n(n,["threshold"],o),n}(t))),$n(e,["safetySettings"],t)}const C=zn(n,["tools"]);if(void 0!==e&&null!=C){let t=He(C);Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["behavior"]);null!=e&&$n(n,["behavior"],e);const o=zn(t,["description"]);null!=o&&$n(n,["description"],o);const i=zn(t,["name"]);null!=i&&$n(n,["name"],i);const s=zn(t,["parameters"]);null!=s&&$n(n,["parameters"],s);const r=zn(t,["parametersJsonSchema"]);null!=r&&$n(n,["parametersJsonSchema"],r);const l=zn(t,["response"]);null!=l&&$n(n,["response"],l);const a=zn(t,["responseJsonSchema"]);return null!=a&&$n(n,["responseJsonSchema"],a),n}(t))),$n(n,["functionDeclarations"],t)}if(void 0!==zn(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=zn(t,["googleSearch"]);null!=o&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);if(null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e)),void 0!==zn(t,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");return n}(o));const i=zn(t,["googleSearchRetrieval"]);if(null!=i&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(i)),void 0!==zn(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==zn(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const s=zn(t,["computerUse"]);null!=s&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(s));const r=zn(t,["codeExecution"]);return null!=r&&$n(n,["codeExecution"],r),n}(Ge(t)))),$n(e,["tools"],t)}const T=zn(n,["toolConfig"]);if(void 0!==e&&null!=T&&$n(e,["toolConfig"],function(t){const n={},e=zn(t,["functionCallingConfig"]);null!=e&&$n(n,["functionCallingConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["allowedFunctionNames"]);return null!=o&&$n(n,["allowedFunctionNames"],o),n}(e));const o=zn(t,["retrievalConfig"]);return null!=o&&$n(n,["retrievalConfig"],function(t){const n={},e=zn(t,["latLng"]);null!=e&&$n(n,["latLng"],function(t){const n={},e=zn(t,["latitude"]);null!=e&&$n(n,["latitude"],e);const o=zn(t,["longitude"]);return null!=o&&$n(n,["longitude"],o),n}(e));const o=zn(t,["languageCode"]);return null!=o&&$n(n,["languageCode"],o),n}(o)),n}(T)),void 0!==zn(n,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const E=zn(n,["cachedContent"]);void 0!==e&&null!=E&&$n(e,["cachedContent"],Fe(t,E));const A=zn(n,["responseModalities"]);null!=A&&$n(o,["responseModalities"],A);const I=zn(n,["mediaResolution"]);null!=I&&$n(o,["mediaResolution"],I);const O=zn(n,["speechConfig"]);if(null!=O&&$n(o,["speechConfig"],function(t){const n={},e=zn(t,["voiceConfig"]);null!=e&&$n(n,["voiceConfig"],Lo(e));const o=zn(t,["multiSpeakerVoiceConfig"]);null!=o&&$n(n,["multiSpeakerVoiceConfig"],function(t){const n={},e=zn(t,["speakerVoiceConfigs"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["speaker"]);null!=e&&$n(n,["speaker"],e);const o=zn(t,["voiceConfig"]);return null!=o&&$n(n,["voiceConfig"],Lo(o)),n}(t))),$n(n,["speakerVoiceConfigs"],t)}return n}(o));const i=zn(t,["languageCode"]);return null!=i&&$n(n,["languageCode"],i),n}(Le(O))),void 0!==zn(n,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const S=zn(n,["thinkingConfig"]);return null!=S&&$n(o,["thinkingConfig"],function(t){const n={},e=zn(t,["includeThoughts"]);null!=e&&$n(n,["includeThoughts"],e);const o=zn(t,["thinkingBudget"]);return null!=o&&$n(n,["thinkingBudget"],o),n}(S)),o}(t,s,e)),e}function Go(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["data"]);null!=o&&$n(n,["data"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["fileUri"]);null!=o&&$n(n,["fileUri"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}function Ho(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={};if(void 0!==zn(t,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const e=zn(t,["description"]);null!=e&&$n(n,["description"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["parameters"]);null!=i&&$n(n,["parameters"],i);const s=zn(t,["parametersJsonSchema"]);null!=s&&$n(n,["parametersJsonSchema"],s);const r=zn(t,["response"]);null!=r&&$n(n,["response"],r);const l=zn(t,["responseJsonSchema"]);return null!=l&&$n(n,["responseJsonSchema"],l),n}(t))),$n(n,["functionDeclarations"],t)}const o=zn(t,["retrieval"]);null!=o&&$n(n,["retrieval"],o);const i=zn(t,["googleSearch"]);null!=i&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e));const o=zn(t,["excludeDomains"]);return null!=o&&$n(n,["excludeDomains"],o),n}(i));const s=zn(t,["googleSearchRetrieval"]);null!=s&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(s));const r=zn(t,["enterpriseWebSearch"]);null!=r&&$n(n,["enterpriseWebSearch"],function(t){const n={},e=zn(t,["excludeDomains"]);return null!=e&&$n(n,["excludeDomains"],e),n}(r));const l=zn(t,["googleMaps"]);null!=l&&$n(n,["googleMaps"],function(t){const n={},e=zn(t,["authConfig"]);return null!=e&&$n(n,["authConfig"],function(t){const n={},e=zn(t,["apiKeyConfig"]);null!=e&&$n(n,["apiKeyConfig"],function(t){const n={},e=zn(t,["apiKeyString"]);return null!=e&&$n(n,["apiKeyString"],e),n}(e));const o=zn(t,["authType"]);null!=o&&$n(n,["authType"],o);const i=zn(t,["googleServiceAccountConfig"]);null!=i&&$n(n,["googleServiceAccountConfig"],i);const s=zn(t,["httpBasicAuthConfig"]);null!=s&&$n(n,["httpBasicAuthConfig"],s);const r=zn(t,["oauthConfig"]);null!=r&&$n(n,["oauthConfig"],r);const l=zn(t,["oidcConfig"]);return null!=l&&$n(n,["oidcConfig"],l),n}(e)),n}(l)),null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const a=zn(t,["computerUse"]);null!=a&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(a));const u=zn(t,["codeExecution"]);return null!=u&&$n(n,["codeExecution"],u),n}function Fo(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["contents"]);if(null!=i){let t=xe(i);Array.isArray(t)&&(t=t.map(t=>Go(t))),$n(e,["contents"],t)}const s=zn(n,["config"]);return null!=s&&$n(e,["generationConfig"],function(t,n,e){const o={},i=zn(n,["systemInstruction"]);void 0!==e&&null!=i&&$n(e,["systemInstruction"],Go(Me(i)));const s=zn(n,["temperature"]);null!=s&&$n(o,["temperature"],s);const r=zn(n,["topP"]);null!=r&&$n(o,["topP"],r);const l=zn(n,["topK"]);null!=l&&$n(o,["topK"],l);const a=zn(n,["candidateCount"]);null!=a&&$n(o,["candidateCount"],a);const u=zn(n,["maxOutputTokens"]);null!=u&&$n(o,["maxOutputTokens"],u);const c=zn(n,["stopSequences"]);null!=c&&$n(o,["stopSequences"],c);const d=zn(n,["responseLogprobs"]);null!=d&&$n(o,["responseLogprobs"],d);const p=zn(n,["logprobs"]);null!=p&&$n(o,["logprobs"],p);const f=zn(n,["presencePenalty"]);null!=f&&$n(o,["presencePenalty"],f);const h=zn(n,["frequencyPenalty"]);null!=h&&$n(o,["frequencyPenalty"],h);const m=zn(n,["seed"]);null!=m&&$n(o,["seed"],m);const g=zn(n,["responseMimeType"]);null!=g&&$n(o,["responseMimeType"],g);const _=zn(n,["responseSchema"]);null!=_&&$n(o,["responseSchema"],function(t){const n={},e=zn(t,["anyOf"]);null!=e&&$n(n,["anyOf"],e);const o=zn(t,["default"]);null!=o&&$n(n,["default"],o);const i=zn(t,["description"]);null!=i&&$n(n,["description"],i);const s=zn(t,["enum"]);null!=s&&$n(n,["enum"],s);const r=zn(t,["example"]);null!=r&&$n(n,["example"],r);const l=zn(t,["format"]);null!=l&&$n(n,["format"],l);const a=zn(t,["items"]);null!=a&&$n(n,["items"],a);const u=zn(t,["maxItems"]);null!=u&&$n(n,["maxItems"],u);const c=zn(t,["maxLength"]);null!=c&&$n(n,["maxLength"],c);const d=zn(t,["maxProperties"]);null!=d&&$n(n,["maxProperties"],d);const p=zn(t,["maximum"]);null!=p&&$n(n,["maximum"],p);const f=zn(t,["minItems"]);null!=f&&$n(n,["minItems"],f);const h=zn(t,["minLength"]);null!=h&&$n(n,["minLength"],h);const m=zn(t,["minProperties"]);null!=m&&$n(n,["minProperties"],m);const g=zn(t,["minimum"]);null!=g&&$n(n,["minimum"],g);const _=zn(t,["nullable"]);null!=_&&$n(n,["nullable"],_);const y=zn(t,["pattern"]);null!=y&&$n(n,["pattern"],y);const v=zn(t,["properties"]);null!=v&&$n(n,["properties"],v);const C=zn(t,["propertyOrdering"]);null!=C&&$n(n,["propertyOrdering"],C);const T=zn(t,["required"]);null!=T&&$n(n,["required"],T);const E=zn(t,["title"]);null!=E&&$n(n,["title"],E);const A=zn(t,["type"]);return null!=A&&$n(n,["type"],A),n}(ke(_)));const y=zn(n,["responseJsonSchema"]);null!=y&&$n(o,["responseJsonSchema"],y);const v=zn(n,["routingConfig"]);null!=v&&$n(o,["routingConfig"],v);const C=zn(n,["modelSelectionConfig"]);null!=C&&$n(o,["modelConfig"],function(t){const n={},e=zn(t,["featureSelectionPreference"]);return null!=e&&$n(n,["featureSelectionPreference"],e),n}(C));const T=zn(n,["safetySettings"]);if(void 0!==e&&null!=T){let t=T;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["method"]);null!=e&&$n(n,["method"],e);const o=zn(t,["category"]);null!=o&&$n(n,["category"],o);const i=zn(t,["threshold"]);return null!=i&&$n(n,["threshold"],i),n}(t))),$n(e,["safetySettings"],t)}const E=zn(n,["tools"]);if(void 0!==e&&null!=E){let t=He(E);Array.isArray(t)&&(t=t.map(t=>Ho(Ge(t)))),$n(e,["tools"],t)}const A=zn(n,["toolConfig"]);void 0!==e&&null!=A&&$n(e,["toolConfig"],function(t){const n={},e=zn(t,["functionCallingConfig"]);null!=e&&$n(n,["functionCallingConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["allowedFunctionNames"]);return null!=o&&$n(n,["allowedFunctionNames"],o),n}(e));const o=zn(t,["retrievalConfig"]);return null!=o&&$n(n,["retrievalConfig"],function(t){const n={},e=zn(t,["latLng"]);null!=e&&$n(n,["latLng"],function(t){const n={},e=zn(t,["latitude"]);null!=e&&$n(n,["latitude"],e);const o=zn(t,["longitude"]);return null!=o&&$n(n,["longitude"],o),n}(e));const o=zn(t,["languageCode"]);return null!=o&&$n(n,["languageCode"],o),n}(o)),n}(A));const I=zn(n,["labels"]);void 0!==e&&null!=I&&$n(e,["labels"],I);const O=zn(n,["cachedContent"]);void 0!==e&&null!=O&&$n(e,["cachedContent"],Fe(t,O));const S=zn(n,["responseModalities"]);null!=S&&$n(o,["responseModalities"],S);const b=zn(n,["mediaResolution"]);null!=b&&$n(o,["mediaResolution"],b);const w=zn(n,["speechConfig"]);null!=w&&$n(o,["speechConfig"],function(t){const n={},e=zn(t,["voiceConfig"]);if(null!=e&&$n(n,["voiceConfig"],function(t){const n={},e=zn(t,["prebuiltVoiceConfig"]);return null!=e&&$n(n,["prebuiltVoiceConfig"],function(t){const n={},e=zn(t,["voiceName"]);return null!=e&&$n(n,["voiceName"],e),n}(e)),n}(e)),void 0!==zn(t,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=zn(t,["languageCode"]);return null!=o&&$n(n,["languageCode"],o),n}(Le(w)));const R=zn(n,["audioTimestamp"]);null!=R&&$n(o,["audioTimestamp"],R);const N=zn(n,["thinkingConfig"]);return null!=N&&$n(o,["thinkingConfig"],function(t){const n={},e=zn(t,["includeThoughts"]);null!=e&&$n(n,["includeThoughts"],e);const o=zn(t,["thinkingBudget"]);return null!=o&&$n(n,["thinkingBudget"],o),n}(N)),o}(t,s,e)),e}function Vo(t){const n={},e=zn(t,["gcsUri"]);null!=e&&$n(n,["gcsUri"],e);const o=zn(t,["imageBytes"]);null!=o&&$n(n,["bytesBase64Encoded"],je(o));const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}function jo(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["candidates"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["content"]);null!=e&&$n(n,["content"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(e));const o=zn(t,["citationMetadata"]);null!=o&&$n(n,["citationMetadata"],function(t){const n={},e=zn(t,["citationSources"]);return null!=e&&$n(n,["citations"],e),n}(o));const i=zn(t,["tokenCount"]);null!=i&&$n(n,["tokenCount"],i);const s=zn(t,["finishReason"]);null!=s&&$n(n,["finishReason"],s);const r=zn(t,["urlContextMetadata"]);null!=r&&$n(n,["urlContextMetadata"],function(t){const n={},e=zn(t,["urlMetadata"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["retrievedUrl"]);null!=e&&$n(n,["retrievedUrl"],e);const o=zn(t,["urlRetrievalStatus"]);return null!=o&&$n(n,["urlRetrievalStatus"],o),n}(t))),$n(n,["urlMetadata"],t)}return n}(r));const l=zn(t,["avgLogprobs"]);null!=l&&$n(n,["avgLogprobs"],l);const a=zn(t,["groundingMetadata"]);null!=a&&$n(n,["groundingMetadata"],a);const u=zn(t,["index"]);null!=u&&$n(n,["index"],u);const c=zn(t,["logprobsResult"]);null!=c&&$n(n,["logprobsResult"],c);const d=zn(t,["safetyRatings"]);return null!=d&&$n(n,["safetyRatings"],d),n}(t))),$n(n,["candidates"],t)}const i=zn(t,["modelVersion"]);null!=i&&$n(n,["modelVersion"],i);const s=zn(t,["promptFeedback"]);null!=s&&$n(n,["promptFeedback"],s);const r=zn(t,["responseId"]);null!=r&&$n(n,["responseId"],r);const l=zn(t,["usageMetadata"]);return null!=l&&$n(n,["usageMetadata"],l),n}function Bo(t){const n={},e=zn(t,["safetyAttributes","categories"]);null!=e&&$n(n,["categories"],e);const o=zn(t,["safetyAttributes","scores"]);null!=o&&$n(n,["scores"],o);const i=zn(t,["contentType"]);return null!=i&&$n(n,["contentType"],i),n}function Jo(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["description"]);null!=i&&$n(n,["description"],i);const s=zn(t,["version"]);null!=s&&$n(n,["version"],s);const r=zn(t,["_self"]);null!=r&&$n(n,["tunedModelInfo"],function(t){const n={},e=zn(t,["baseModel"]);null!=e&&$n(n,["baseModel"],e);const o=zn(t,["createTime"]);null!=o&&$n(n,["createTime"],o);const i=zn(t,["updateTime"]);return null!=i&&$n(n,["updateTime"],i),n}(r));const l=zn(t,["inputTokenLimit"]);null!=l&&$n(n,["inputTokenLimit"],l);const a=zn(t,["outputTokenLimit"]);null!=a&&$n(n,["outputTokenLimit"],a);const u=zn(t,["supportedGenerationMethods"]);return null!=u&&$n(n,["supportedActions"],u),n}function Yo(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["candidates"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["content"]);null!=e&&$n(n,["content"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["data"]);null!=o&&$n(n,["data"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["fileUri"]);null!=o&&$n(n,["fileUri"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(e));const o=zn(t,["citationMetadata"]);null!=o&&$n(n,["citationMetadata"],function(t){const n={},e=zn(t,["citations"]);return null!=e&&$n(n,["citations"],e),n}(o));const i=zn(t,["finishMessage"]);null!=i&&$n(n,["finishMessage"],i);const s=zn(t,["finishReason"]);null!=s&&$n(n,["finishReason"],s);const r=zn(t,["urlContextMetadata"]);null!=r&&$n(n,["urlContextMetadata"],function(t){const n={},e=zn(t,["urlMetadata"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["retrievedUrl"]);null!=e&&$n(n,["retrievedUrl"],e);const o=zn(t,["urlRetrievalStatus"]);return null!=o&&$n(n,["urlRetrievalStatus"],o),n}(t))),$n(n,["urlMetadata"],t)}return n}(r));const l=zn(t,["avgLogprobs"]);null!=l&&$n(n,["avgLogprobs"],l);const a=zn(t,["groundingMetadata"]);null!=a&&$n(n,["groundingMetadata"],a);const u=zn(t,["index"]);null!=u&&$n(n,["index"],u);const c=zn(t,["logprobsResult"]);null!=c&&$n(n,["logprobsResult"],c);const d=zn(t,["safetyRatings"]);return null!=d&&$n(n,["safetyRatings"],d),n}(t))),$n(n,["candidates"],t)}const i=zn(t,["createTime"]);null!=i&&$n(n,["createTime"],i);const s=zn(t,["modelVersion"]);null!=s&&$n(n,["modelVersion"],s);const r=zn(t,["promptFeedback"]);null!=r&&$n(n,["promptFeedback"],r);const l=zn(t,["responseId"]);null!=l&&$n(n,["responseId"],l);const a=zn(t,["usageMetadata"]);return null!=a&&$n(n,["usageMetadata"],a),n}function Wo(t){const n={},e=zn(t,["gcsUri"]);null!=e&&$n(n,["gcsUri"],e);const o=zn(t,["bytesBase64Encoded"]);null!=o&&$n(n,["imageBytes"],je(o));const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}function Ko(t){const n={},e=zn(t,["safetyAttributes","categories"]);null!=e&&$n(n,["categories"],e);const o=zn(t,["safetyAttributes","scores"]);null!=o&&$n(n,["scores"],o);const i=zn(t,["contentType"]);return null!=i&&$n(n,["contentType"],i),n}function $o(t){const n={},e=zn(t,["_self"]);null!=e&&$n(n,["image"],Wo(e));const o=zn(t,["raiFilteredReason"]);null!=o&&$n(n,["raiFilteredReason"],o);const i=zn(t,["_self"]);null!=i&&$n(n,["safetyAttributes"],Ko(i));const s=zn(t,["prompt"]);return null!=s&&$n(n,["enhancedPrompt"],s),n}function zo(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["displayName"]);null!=o&&$n(n,["displayName"],o);const i=zn(t,["description"]);null!=i&&$n(n,["description"],i);const s=zn(t,["versionId"]);null!=s&&$n(n,["version"],s);const r=zn(t,["deployedModels"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["endpoint"]);null!=e&&$n(n,["name"],e);const o=zn(t,["deployedModelId"]);return null!=o&&$n(n,["deployedModelId"],o),n}(t))),$n(n,["endpoints"],t)}const l=zn(t,["labels"]);null!=l&&$n(n,["labels"],l);const a=zn(t,["_self"]);null!=a&&$n(n,["tunedModelInfo"],function(t){const n={},e=zn(t,["labels","google-vertex-llm-tuning-base-model-id"]);null!=e&&$n(n,["baseModel"],e);const o=zn(t,["createTime"]);null!=o&&$n(n,["createTime"],o);const i=zn(t,["updateTime"]);return null!=i&&$n(n,["updateTime"],i),n}(a));const u=zn(t,["defaultCheckpointId"]);null!=u&&$n(n,["defaultCheckpointId"],u);const c=zn(t,["checkpoints"]);if(null!=c){let t=c;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["checkpointId"]);null!=e&&$n(n,["checkpointId"],e);const o=zn(t,["epoch"]);null!=o&&$n(n,["epoch"],o);const i=zn(t,["step"]);return null!=i&&$n(n,["step"],i),n}(t))),$n(n,["checkpoints"],t)}return n}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
const Xo="x-goog-api-client",Zo=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Qo{constructor(t){var n,e;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta1",o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=null!==(e=this.clientOptions.apiVersion)&&void 0!==e?e:"v1beta",o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var t;return null!==(t=this.clientOptions.vertexai)&&void 0!==t&&t}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||void 0===t.baseUrl||void 0===t.apiVersion)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&""!==t.apiVersion&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol="http:"==n.protocol?"ws":"wss",n.toString()}setBaseUrl(t){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=t}constructUrl(t,n,e){const o=[this.getRequestUrlInternal(n)];return e&&o.push(this.getBaseResourcePath()),""!==t&&o.push(t),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||"GET"===t.httpMethod&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const e=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,n,e);if(t.queryParams)for(const[s,r]of Object.entries(t.queryParams))o.searchParams.append(s,String(r));let i={};if("GET"===t.httpMethod){if(t.body&&"{}"!==t.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=t.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,t.abortSignal),this.unaryApiCall(o,i,t.httpMethod)}patchHttpOptions(t,n){const e=JSON.parse(JSON.stringify(t));for(const[o,i]of Object.entries(n))"object"==typeof i?e[o]=Object.assign(Object.assign({},e[o]),i):void 0!==i&&(e[o]=i);return e}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const e=this.shouldPrependVertexProjectPath(t),o=this.constructUrl(t.path,n,e);o.searchParams.has("alt")&&"sse"===o.searchParams.get("alt")||o.searchParams.set("alt","sse");let i={};return i.body=t.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,t.abortSignal),this.streamApiCall(o,i,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,e){if(n&&n.timeout||e){const o=new AbortController,i=o.signal;if(n.timeout&&(null==n?void 0:n.timeout)>0){const t=setTimeout(()=>o.abort(),n.timeout);t&&"function"==typeof t.unref&&t.unref()}e&&e.addEventListener("abort",()=>{o.abort()}),t.signal=i}return n&&null!==n.extraBody&&function(t,n){if(!n||0===Object.keys(n).length)return;if(t.body instanceof Blob)return void console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let e={};if("string"==typeof t.body&&t.body.length>0)try{const n=JSON.parse(t.body);if("object"!=typeof n||null===n||Array.isArray(n))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");e=n}catch(ki){return void console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.")}const o=function t(n,e){const o=Object.assign({},n);for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const n=e[i],s=o[i];n&&"object"==typeof n&&!Array.isArray(n)&&s&&"object"==typeof s&&!Array.isArray(s)?o[i]=t(s,n):(s&&n&&typeof s!=typeof n&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${i}". Original type: ${typeof s}, New type: ${typeof n}. Overwriting.`),o[i]=n)}return o}(e,n);t.body=JSON.stringify(o)}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */(t,n.extraBody),t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,e){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:e})).then(async t=>(await ti(t),new Zn(t))).catch(t=>{throw t instanceof Error?t:new Error(JSON.stringify(t))})}async streamApiCall(t,n,e){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:e})).then(async t=>(await ti(t),this.processStreamResponse(t))).catch(t=>{throw t instanceof Error?t:new Error(JSON.stringify(t))})}processStreamResponse(t){var n;return ho(this,arguments,function*(){const e=null===(n=null==t?void 0:t.body)||void 0===n?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!e)throw new Error("Response body is empty");try{let n="";for(;;){const{done:i,value:s}=yield fo(e.read());if(i){if(n.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const r=o.decode(s,{stream:!0});try{const t=JSON.parse(r);if("error"in t){const n=JSON.parse(JSON.stringify(t.error)),e=n.status,o=n.code,i=`got status: ${e}. ${JSON.stringify(t)}`;if(o>=400&&o<600)throw new To({message:i,status:o})}}catch(ki){if("ApiError"===ki.name)throw ki}n+=r;let l=n.match(Zo);for(;l;){const e=l[1];try{const o=new Response(e,{headers:null==t?void 0:t.headers,status:null==t?void 0:t.status,statusText:null==t?void 0:t.statusText});yield yield fo(new Zn(o)),n=n.slice(l[0].length),l=n.match(Zo)}catch(ki){throw new Error(`exception parsing stream chunk ${e}. ${ki}`)}}}}finally{e.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(t=>{throw new Error(`exception ${t} sending request`)})}getDefaultHeaders(){const t={},n="google-genai-sdk/1.15.0 "+this.clientOptions.userAgentExtra;return t["User-Agent"]=n,t[Xo]=n,t["Content-Type"]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[e,o]of Object.entries(t.headers))n.append(e,o);t.timeout&&t.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var e;const o={};null!=n&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const i=this.clientOptions.uploader,s=await i.stat(t);o.sizeBytes=String(s.size);const r=null!==(e=null==n?void 0:n.mimeType)&&void 0!==e?e:s.type;if(void 0===r||""===r)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=r;const l=await this.fetchUploadUrl(o,n);return i.upload(t,l,this)}async downloadFile(t){const n=this.clientOptions.downloader;await n.download(t,this)}async fetchUploadUrl(t,n){var e;let o={};o=(null==n?void 0:n.httpOptions)?n.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const i={file:t},s=await this.request({path:Kn("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:o});if(!s||!(null==s?void 0:s.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const r=null===(e=null==s?void 0:s.headers)||void 0===e?void 0:e["x-goog-upload-url"];if(void 0===r)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return r}}async function ti(t){var n;if(void 0===t)throw new Error("response is undefined");if(!t.ok){const e=t.status;let o;o=(null===(n=t.headers.get("content-type"))||void 0===n?void 0:n.includes("application/json"))?await t.json():{error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(o);if(e>=400&&e<600)throw new To({message:i,status:e});throw new Error(i)}}function ni(t){for(const n of t){if(oi(n))return!0;if("object"==typeof n&&"inputSchema"in n)return!0}return!1}function ei(t){var n;const e=null!==(n=t[Xo])&&void 0!==n?n:"";t[Xo]=(e+" mcp_used/unknown").trimStart()}function oi(t){return null!==t&&"object"==typeof t&&t instanceof si}function ii(t,n=100){return ho(this,arguments,function*(){let e,o=0;for(;o<n;){const n=yield fo(t.listTools({cursor:e}));for(const t of n.tools)yield yield fo(t),o++;if(!n.nextCursor)break;e=n.nextCursor}})}class si{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new si(t,n)}async initialize(){var t,n,e,o;if(this.mcpTools.length>0)return;const i={},s=[];for(const c of this.mcpClients)try{for(var r,l=!0,a=(n=void 0,mo(ii(c)));!(t=(r=await a.next()).done);l=!0){o=r.value,l=!1;const t=o;s.push(t);const n=t.name;if(i[n])throw new Error(`Duplicate function name ${n} found in MCP tools. Please ensure function names are unique.`);i[n]=c}}catch(u){n={error:u}}finally{try{l||t||!(e=a.return)||await e.call(a)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(t,n={}){const e=[],o=new Set;for(const i of t){const t=i.name;if(o.has(t))throw new Error(`Duplicate function name ${t} found in MCP tools. Please ensure function names are unique.`);o.add(t);const s=Ke(i,n);s.functionDeclarations&&e.push(...s.functionDeclarations)}return{functionDeclarations:e}}(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const e of t)if(e.name in this.functionNameToMcpClient){const t=this.functionNameToMcpClient[e.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const i=await t.callTool({name:e.name,arguments:e.args},void 0,o);n.push({functionResponse:{name:e.name,response:i.isError?{error:i}:i}})}return n}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */class ri{constructor(t,n,e){this.apiClient=t,this.auth=n,this.webSocketFactory=e}async connect(t){var n,e;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=function(t){const n=new Headers;for(const[e,o]of Object.entries(t))n.append(e,o);return n}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */(this.apiClient.getDefaultHeaders()),r=`${o}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${this.apiClient.getApiKey()}`;let l=()=>{};const a=new Promise(t=>{l=t}),u=t.callbacks,c=(this.apiClient,{onopen:function(){l({})},onmessage:t=>{!async function(t,n,e){const o=new Ce;let i;i=e.data instanceof Blob?JSON.parse(await e.data.text()):JSON.parse(e.data);const s=function(t){const n={};null!=zn(t,["setupComplete"])&&$n(n,["setupComplete"],{});const e=zn(t,["serverContent"]);null!=e&&$n(n,["serverContent"],function(t){const n={},e=zn(t,["audioChunks"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);null!=o&&$n(n,["mimeType"],o);const i=zn(t,["sourceMetadata"]);return null!=i&&$n(n,["sourceMetadata"],function(t){const n={},e=zn(t,["clientContent"]);null!=e&&$n(n,["clientContent"],function(t){const n={},e=zn(t,["weightedPrompts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["text"]);null!=e&&$n(n,["text"],e);const o=zn(t,["weight"]);return null!=o&&$n(n,["weight"],o),n}(t))),$n(n,["weightedPrompts"],t)}return n}(e));const o=zn(t,["musicGenerationConfig"]);return null!=o&&$n(n,["musicGenerationConfig"],function(t){const n={},e=zn(t,["temperature"]);null!=e&&$n(n,["temperature"],e);const o=zn(t,["topK"]);null!=o&&$n(n,["topK"],o);const i=zn(t,["seed"]);null!=i&&$n(n,["seed"],i);const s=zn(t,["guidance"]);null!=s&&$n(n,["guidance"],s);const r=zn(t,["bpm"]);null!=r&&$n(n,["bpm"],r);const l=zn(t,["density"]);null!=l&&$n(n,["density"],l);const a=zn(t,["brightness"]);null!=a&&$n(n,["brightness"],a);const u=zn(t,["scale"]);null!=u&&$n(n,["scale"],u);const c=zn(t,["muteBass"]);null!=c&&$n(n,["muteBass"],c);const d=zn(t,["muteDrums"]);null!=d&&$n(n,["muteDrums"],d);const p=zn(t,["onlyBassAndDrums"]);null!=p&&$n(n,["onlyBassAndDrums"],p);const f=zn(t,["musicGenerationMode"]);return null!=f&&$n(n,["musicGenerationMode"],f),n}(o)),n}(i)),n}(t))),$n(n,["audioChunks"],t)}return n}(e));const o=zn(t,["filteredPrompt"]);return null!=o&&$n(n,["filteredPrompt"],function(t){const n={},e=zn(t,["text"]);null!=e&&$n(n,["text"],e);const o=zn(t,["filteredReason"]);return null!=o&&$n(n,["filteredReason"],o),n}(o)),n}(i);Object.assign(o,s),n(o)}(0,u.onmessage,t)},onerror:null!==(n=null==u?void 0:u.onerror)&&void 0!==n?n:function(t){},onclose:null!==(e=null==u?void 0:u.onclose)&&void 0!==e?e:function(t){}}),d=this.webSocketFactory.create(r,function(t){const n={};return t.forEach((t,e)=>{n[e]=t}),n}(s),c);d.connect(),await a;const p=No({setup:wo({model:Te(this.apiClient,t.model)})});return d.send(JSON.stringify(p)),new li(d,this.apiClient)}}class li{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||0===Object.keys(t.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Ro(function(t){const n={},e=zn(t,["weightedPrompts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>So(t))),$n(n,["weightedPrompts"],t)}return n}(t));this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=No(function(t){const n={},e=zn(t,["musicGenerationConfig"]);return null!=e&&$n(n,["musicGenerationConfig"],bo(e)),n}(t));this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n=No({playbackControl:t});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ln.PLAY)}pause(){this.sendPlaybackControl(Ln.PAUSE)}stop(){this.sendPlaybackControl(Ln.STOP)}resetContext(){this.sendPlaybackControl(Ln.RESET_CONTEXT)}close(){this.conn.close()}}class ai{constructor(t,n,e){this.apiClient=t,this.auth=n,this.webSocketFactory=e,this.music=new ri(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,e,o,i,s,r;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion();let u;const c=this.apiClient.getHeaders();t.config&&t.config.tools&&ni(t.config.tools)&&ei(c);const d=function(t){const n=new Headers;for(const[e,o]of Object.entries(t))n.append(e,o);return n}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */(c);if(this.apiClient.isVertexAI())u=`${l}/ws/google.cloud.aiplatform.${a}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const t=this.apiClient.getApiKey();let n="BidiGenerateContent",e="key";(null==t?void 0:t.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==a&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),n="BidiGenerateContentConstrained",e="access_token"),u=`${l}/ws/google.ai.generativelanguage.${a}.GenerativeService.${n}?${e}=${t}`}let p=()=>{};const f=new Promise(t=>{p=t}),h=t.callbacks,m=this.apiClient,g={onopen:function(){var t;null===(t=null==h?void 0:h.onopen)||void 0===t||t.call(h),p({})},onmessage:t=>{!async function(t,n,e){const o=new ye;let i;i=e.data instanceof Blob?await e.data.text():e.data instanceof ArrayBuffer?(new TextDecoder).decode(e.data):e.data;const s=JSON.parse(i);if(t.isVertexAI()){const t=function(t){const n={},e=zn(t,["setupComplete"]);null!=e&&$n(n,["setupComplete"],function(t){const n={},e=zn(t,["sessionId"]);return null!=e&&$n(n,["sessionId"],e),n}(e));const o=zn(t,["serverContent"]);null!=o&&$n(n,["serverContent"],function(t){const n={},e=zn(t,["modelTurn"]);null!=e&&$n(n,["modelTurn"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["data"]);null!=o&&$n(n,["data"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["fileUri"]);null!=o&&$n(n,["fileUri"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(e));const o=zn(t,["turnComplete"]);null!=o&&$n(n,["turnComplete"],o);const i=zn(t,["interrupted"]);null!=i&&$n(n,["interrupted"],i);const s=zn(t,["groundingMetadata"]);null!=s&&$n(n,["groundingMetadata"],s);const r=zn(t,["generationComplete"]);null!=r&&$n(n,["generationComplete"],r);const l=zn(t,["inputTranscription"]);null!=l&&$n(n,["inputTranscription"],xo(l));const a=zn(t,["outputTranscription"]);return null!=a&&$n(n,["outputTranscription"],xo(a)),n}(o));const i=zn(t,["toolCall"]);null!=i&&$n(n,["toolCall"],function(t){const n={},e=zn(t,["functionCalls"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["args"]);null!=e&&$n(n,["args"],e);const o=zn(t,["name"]);return null!=o&&$n(n,["name"],o),n}(t))),$n(n,["functionCalls"],t)}return n}(i));const s=zn(t,["toolCallCancellation"]);null!=s&&$n(n,["toolCallCancellation"],function(t){const n={},e=zn(t,["ids"]);return null!=e&&$n(n,["ids"],e),n}(s));const r=zn(t,["usageMetadata"]);null!=r&&$n(n,["usageMetadata"],function(t){const n={},e=zn(t,["promptTokenCount"]);null!=e&&$n(n,["promptTokenCount"],e);const o=zn(t,["cachedContentTokenCount"]);null!=o&&$n(n,["cachedContentTokenCount"],o);const i=zn(t,["candidatesTokenCount"]);null!=i&&$n(n,["responseTokenCount"],i);const s=zn(t,["toolUsePromptTokenCount"]);null!=s&&$n(n,["toolUsePromptTokenCount"],s);const r=zn(t,["thoughtsTokenCount"]);null!=r&&$n(n,["thoughtsTokenCount"],r);const l=zn(t,["totalTokenCount"]);null!=l&&$n(n,["totalTokenCount"],l);const a=zn(t,["promptTokensDetails"]);if(null!=a){let t=a;Array.isArray(t)&&(t=t.map(t=>Uo(t))),$n(n,["promptTokensDetails"],t)}const u=zn(t,["cacheTokensDetails"]);if(null!=u){let t=u;Array.isArray(t)&&(t=t.map(t=>Uo(t))),$n(n,["cacheTokensDetails"],t)}const c=zn(t,["candidatesTokensDetails"]);if(null!=c){let t=c;Array.isArray(t)&&(t=t.map(t=>Uo(t))),$n(n,["responseTokensDetails"],t)}const d=zn(t,["toolUsePromptTokensDetails"]);if(null!=d){let t=d;Array.isArray(t)&&(t=t.map(t=>Uo(t))),$n(n,["toolUsePromptTokensDetails"],t)}const p=zn(t,["trafficType"]);return null!=p&&$n(n,["trafficType"],p),n}(r));const l=zn(t,["goAway"]);null!=l&&$n(n,["goAway"],function(t){const n={},e=zn(t,["timeLeft"]);return null!=e&&$n(n,["timeLeft"],e),n}(l));const a=zn(t,["sessionResumptionUpdate"]);return null!=a&&$n(n,["sessionResumptionUpdate"],function(t){const n={},e=zn(t,["newHandle"]);null!=e&&$n(n,["newHandle"],e);const o=zn(t,["resumable"]);null!=o&&$n(n,["resumable"],o);const i=zn(t,["lastConsumedClientMessageIndex"]);return null!=i&&$n(n,["lastConsumedClientMessageIndex"],i),n}(a)),n}(s);Object.assign(o,t)}else{const t=function(t){const n={};null!=zn(t,["setupComplete"])&&$n(n,["setupComplete"],{});const e=zn(t,["serverContent"]);null!=e&&$n(n,["serverContent"],function(t){const n={},e=zn(t,["modelTurn"]);null!=e&&$n(n,["modelTurn"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(e));const o=zn(t,["turnComplete"]);null!=o&&$n(n,["turnComplete"],o);const i=zn(t,["interrupted"]);null!=i&&$n(n,["interrupted"],i);const s=zn(t,["groundingMetadata"]);null!=s&&$n(n,["groundingMetadata"],s);const r=zn(t,["generationComplete"]);null!=r&&$n(n,["generationComplete"],r);const l=zn(t,["inputTranscription"]);null!=l&&$n(n,["inputTranscription"],Mo(l));const a=zn(t,["outputTranscription"]);null!=a&&$n(n,["outputTranscription"],Mo(a));const u=zn(t,["urlContextMetadata"]);return null!=u&&$n(n,["urlContextMetadata"],function(t){const n={},e=zn(t,["urlMetadata"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["retrievedUrl"]);null!=e&&$n(n,["retrievedUrl"],e);const o=zn(t,["urlRetrievalStatus"]);return null!=o&&$n(n,["urlRetrievalStatus"],o),n}(t))),$n(n,["urlMetadata"],t)}return n}(u)),n}(e));const o=zn(t,["toolCall"]);null!=o&&$n(n,["toolCall"],function(t){const n={},e=zn(t,["functionCalls"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["id"]);null!=e&&$n(n,["id"],e);const o=zn(t,["args"]);null!=o&&$n(n,["args"],o);const i=zn(t,["name"]);return null!=i&&$n(n,["name"],i),n}(t))),$n(n,["functionCalls"],t)}return n}(o));const i=zn(t,["toolCallCancellation"]);null!=i&&$n(n,["toolCallCancellation"],function(t){const n={},e=zn(t,["ids"]);return null!=e&&$n(n,["ids"],e),n}(i));const s=zn(t,["usageMetadata"]);null!=s&&$n(n,["usageMetadata"],function(t){const n={},e=zn(t,["promptTokenCount"]);null!=e&&$n(n,["promptTokenCount"],e);const o=zn(t,["cachedContentTokenCount"]);null!=o&&$n(n,["cachedContentTokenCount"],o);const i=zn(t,["responseTokenCount"]);null!=i&&$n(n,["responseTokenCount"],i);const s=zn(t,["toolUsePromptTokenCount"]);null!=s&&$n(n,["toolUsePromptTokenCount"],s);const r=zn(t,["thoughtsTokenCount"]);null!=r&&$n(n,["thoughtsTokenCount"],r);const l=zn(t,["totalTokenCount"]);null!=l&&$n(n,["totalTokenCount"],l);const a=zn(t,["promptTokensDetails"]);if(null!=a){let t=a;Array.isArray(t)&&(t=t.map(t=>Do(t))),$n(n,["promptTokensDetails"],t)}const u=zn(t,["cacheTokensDetails"]);if(null!=u){let t=u;Array.isArray(t)&&(t=t.map(t=>Do(t))),$n(n,["cacheTokensDetails"],t)}const c=zn(t,["responseTokensDetails"]);if(null!=c){let t=c;Array.isArray(t)&&(t=t.map(t=>Do(t))),$n(n,["responseTokensDetails"],t)}const d=zn(t,["toolUsePromptTokensDetails"]);if(null!=d){let t=d;Array.isArray(t)&&(t=t.map(t=>Do(t))),$n(n,["toolUsePromptTokensDetails"],t)}return n}(s));const r=zn(t,["goAway"]);null!=r&&$n(n,["goAway"],function(t){const n={},e=zn(t,["timeLeft"]);return null!=e&&$n(n,["timeLeft"],e),n}(r));const l=zn(t,["sessionResumptionUpdate"]);return null!=l&&$n(n,["sessionResumptionUpdate"],function(t){const n={},e=zn(t,["newHandle"]);null!=e&&$n(n,["newHandle"],e);const o=zn(t,["resumable"]);null!=o&&$n(n,["resumable"],o);const i=zn(t,["lastConsumedClientMessageIndex"]);return null!=i&&$n(n,["lastConsumedClientMessageIndex"],i),n}(l)),n}(s);Object.assign(o,t)}n(o)}(m,h.onmessage,t)},onerror:null!==(n=null==h?void 0:h.onerror)&&void 0!==n?n:function(t){},onclose:null!==(e=null==h?void 0:h.onclose)&&void 0!==e?e:function(t){}},_=this.webSocketFactory.create(u,function(t){const n={};return t.forEach((t,e)=>{n[e]=t}),n}(d),g);_.connect(),await f;let y=Te(this.apiClient,t.model);this.apiClient.isVertexAI()&&y.startsWith("publishers/")&&(y=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+y);let v={};this.apiClient.isVertexAI()&&void 0===(null===(o=t.config)||void 0===o?void 0:o.responseModalities)&&(void 0===t.config?t.config={responseModalities:[Mt.AUDIO]}:t.config.responseModalities=[Mt.AUDIO]),(null===(i=t.config)||void 0===i?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const C=null!==(r=null===(s=t.config)||void 0===s?void 0:s.tools)&&void 0!==r?r:[],T=[];for(const A of C)if(this.isCallableTool(A)){const t=A;T.push(await t.tool())}else T.push(A);T.length>0&&(t.config.tools=T);const E={model:y,config:t.config,callbacks:t.callbacks};return v=this.apiClient.isVertexAI()?function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["setup","model"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["generationConfig"]);void 0!==n&&null!=e&&$n(n,["setup","generationConfig"],e);const o=zn(t,["responseModalities"]);void 0!==n&&null!=o&&$n(n,["setup","generationConfig","responseModalities"],o);const i=zn(t,["temperature"]);void 0!==n&&null!=i&&$n(n,["setup","generationConfig","temperature"],i);const s=zn(t,["topP"]);void 0!==n&&null!=s&&$n(n,["setup","generationConfig","topP"],s);const r=zn(t,["topK"]);void 0!==n&&null!=r&&$n(n,["setup","generationConfig","topK"],r);const l=zn(t,["maxOutputTokens"]);void 0!==n&&null!=l&&$n(n,["setup","generationConfig","maxOutputTokens"],l);const a=zn(t,["mediaResolution"]);void 0!==n&&null!=a&&$n(n,["setup","generationConfig","mediaResolution"],a);const u=zn(t,["seed"]);void 0!==n&&null!=u&&$n(n,["setup","generationConfig","seed"],u);const c=zn(t,["speechConfig"]);void 0!==n&&null!=c&&$n(n,["setup","generationConfig","speechConfig"],function(t){const n={},e=zn(t,["voiceConfig"]);if(null!=e&&$n(n,["voiceConfig"],function(t){const n={},e=zn(t,["prebuiltVoiceConfig"]);return null!=e&&$n(n,["prebuiltVoiceConfig"],function(t){const n={},e=zn(t,["voiceName"]);return null!=e&&$n(n,["voiceName"],e),n}(e)),n}(e)),void 0!==zn(t,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=zn(t,["languageCode"]);return null!=o&&$n(n,["languageCode"],o),n}(qe(c)));const d=zn(t,["enableAffectiveDialog"]);void 0!==n&&null!=d&&$n(n,["setup","generationConfig","enableAffectiveDialog"],d);const p=zn(t,["systemInstruction"]);void 0!==n&&null!=p&&$n(n,["setup","systemInstruction"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["data"]);null!=o&&$n(n,["data"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={},e=zn(t,["displayName"]);null!=e&&$n(n,["displayName"],e);const o=zn(t,["fileUri"]);null!=o&&$n(n,["fileUri"],o);const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(Me(p)));const f=zn(t,["tools"]);if(void 0!==n&&null!=f){let t=He(f);Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={};if(void 0!==zn(t,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const e=zn(t,["description"]);null!=e&&$n(n,["description"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["parameters"]);null!=i&&$n(n,["parameters"],i);const s=zn(t,["parametersJsonSchema"]);null!=s&&$n(n,["parametersJsonSchema"],s);const r=zn(t,["response"]);null!=r&&$n(n,["response"],r);const l=zn(t,["responseJsonSchema"]);return null!=l&&$n(n,["responseJsonSchema"],l),n}(t))),$n(n,["functionDeclarations"],t)}const o=zn(t,["retrieval"]);null!=o&&$n(n,["retrieval"],o);const i=zn(t,["googleSearch"]);null!=i&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e));const o=zn(t,["excludeDomains"]);return null!=o&&$n(n,["excludeDomains"],o),n}(i));const s=zn(t,["googleSearchRetrieval"]);null!=s&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(s));const r=zn(t,["enterpriseWebSearch"]);null!=r&&$n(n,["enterpriseWebSearch"],function(t){const n={},e=zn(t,["excludeDomains"]);return null!=e&&$n(n,["excludeDomains"],e),n}(r));const l=zn(t,["googleMaps"]);null!=l&&$n(n,["googleMaps"],function(t){const n={},e=zn(t,["authConfig"]);return null!=e&&$n(n,["authConfig"],function(t){const n={},e=zn(t,["apiKeyConfig"]);null!=e&&$n(n,["apiKeyConfig"],function(t){const n={},e=zn(t,["apiKeyString"]);return null!=e&&$n(n,["apiKeyString"],e),n}(e));const o=zn(t,["authType"]);null!=o&&$n(n,["authType"],o);const i=zn(t,["googleServiceAccountConfig"]);null!=i&&$n(n,["googleServiceAccountConfig"],i);const s=zn(t,["httpBasicAuthConfig"]);null!=s&&$n(n,["httpBasicAuthConfig"],s);const r=zn(t,["oauthConfig"]);null!=r&&$n(n,["oauthConfig"],r);const l=zn(t,["oidcConfig"]);return null!=l&&$n(n,["oidcConfig"],l),n}(e)),n}(l)),null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const a=zn(t,["computerUse"]);null!=a&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(a));const u=zn(t,["codeExecution"]);return null!=u&&$n(n,["codeExecution"],u),n}(Ge(t)))),$n(n,["setup","tools"],t)}const h=zn(t,["sessionResumption"]);void 0!==n&&null!=h&&$n(n,["setup","sessionResumption"],function(t){const n={},e=zn(t,["handle"]);null!=e&&$n(n,["handle"],e);const o=zn(t,["transparent"]);return null!=o&&$n(n,["transparent"],o),n}(h));const m=zn(t,["inputAudioTranscription"]);void 0!==n&&null!=m&&$n(n,["setup","inputAudioTranscription"],{});const g=zn(t,["outputAudioTranscription"]);void 0!==n&&null!=g&&$n(n,["setup","outputAudioTranscription"],{});const _=zn(t,["realtimeInputConfig"]);void 0!==n&&null!=_&&$n(n,["setup","realtimeInputConfig"],function(t){const n={},e=zn(t,["automaticActivityDetection"]);null!=e&&$n(n,["automaticActivityDetection"],function(t){const n={},e=zn(t,["disabled"]);null!=e&&$n(n,["disabled"],e);const o=zn(t,["startOfSpeechSensitivity"]);null!=o&&$n(n,["startOfSpeechSensitivity"],o);const i=zn(t,["endOfSpeechSensitivity"]);null!=i&&$n(n,["endOfSpeechSensitivity"],i);const s=zn(t,["prefixPaddingMs"]);null!=s&&$n(n,["prefixPaddingMs"],s);const r=zn(t,["silenceDurationMs"]);return null!=r&&$n(n,["silenceDurationMs"],r),n}(e));const o=zn(t,["activityHandling"]);null!=o&&$n(n,["activityHandling"],o);const i=zn(t,["turnCoverage"]);return null!=i&&$n(n,["turnCoverage"],i),n}(_));const y=zn(t,["contextWindowCompression"]);void 0!==n&&null!=y&&$n(n,["setup","contextWindowCompression"],function(t){const n={},e=zn(t,["triggerTokens"]);null!=e&&$n(n,["triggerTokens"],e);const o=zn(t,["slidingWindow"]);return null!=o&&$n(n,["slidingWindow"],function(t){const n={},e=zn(t,["targetTokens"]);return null!=e&&$n(n,["targetTokens"],e),n}(o)),n}(y));const v=zn(t,["proactivity"]);return void 0!==n&&null!=v&&$n(n,["setup","proactivity"],function(t){const n={},e=zn(t,["proactiveAudio"]);return null!=e&&$n(n,["proactiveAudio"],e),n}(v)),{}}(i,e)),e}(this.apiClient,E):function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["setup","model"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["generationConfig"]);void 0!==n&&null!=e&&$n(n,["setup","generationConfig"],e);const o=zn(t,["responseModalities"]);void 0!==n&&null!=o&&$n(n,["setup","generationConfig","responseModalities"],o);const i=zn(t,["temperature"]);void 0!==n&&null!=i&&$n(n,["setup","generationConfig","temperature"],i);const s=zn(t,["topP"]);void 0!==n&&null!=s&&$n(n,["setup","generationConfig","topP"],s);const r=zn(t,["topK"]);void 0!==n&&null!=r&&$n(n,["setup","generationConfig","topK"],r);const l=zn(t,["maxOutputTokens"]);void 0!==n&&null!=l&&$n(n,["setup","generationConfig","maxOutputTokens"],l);const a=zn(t,["mediaResolution"]);void 0!==n&&null!=a&&$n(n,["setup","generationConfig","mediaResolution"],a);const u=zn(t,["seed"]);void 0!==n&&null!=u&&$n(n,["setup","generationConfig","seed"],u);const c=zn(t,["speechConfig"]);void 0!==n&&null!=c&&$n(n,["setup","generationConfig","speechConfig"],function(t){const n={},e=zn(t,["voiceConfig"]);null!=e&&$n(n,["voiceConfig"],Io(e));const o=zn(t,["multiSpeakerVoiceConfig"]);null!=o&&$n(n,["multiSpeakerVoiceConfig"],function(t){const n={},e=zn(t,["speakerVoiceConfigs"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["speaker"]);null!=e&&$n(n,["speaker"],e);const o=zn(t,["voiceConfig"]);return null!=o&&$n(n,["voiceConfig"],Io(o)),n}(t))),$n(n,["speakerVoiceConfigs"],t)}return n}(o));const i=zn(t,["languageCode"]);return null!=i&&$n(n,["languageCode"],i),n}(qe(c)));const d=zn(t,["enableAffectiveDialog"]);void 0!==n&&null!=d&&$n(n,["setup","generationConfig","enableAffectiveDialog"],d);const p=zn(t,["systemInstruction"]);void 0!==n&&null!=p&&$n(n,["setup","systemInstruction"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(Me(p)));const f=zn(t,["tools"]);if(void 0!==n&&null!=f){let t=He(f);Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["behavior"]);null!=e&&$n(n,["behavior"],e);const o=zn(t,["description"]);null!=o&&$n(n,["description"],o);const i=zn(t,["name"]);null!=i&&$n(n,["name"],i);const s=zn(t,["parameters"]);null!=s&&$n(n,["parameters"],s);const r=zn(t,["parametersJsonSchema"]);null!=r&&$n(n,["parametersJsonSchema"],r);const l=zn(t,["response"]);null!=l&&$n(n,["response"],l);const a=zn(t,["responseJsonSchema"]);return null!=a&&$n(n,["responseJsonSchema"],a),n}(t))),$n(n,["functionDeclarations"],t)}if(void 0!==zn(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=zn(t,["googleSearch"]);null!=o&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);if(null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e)),void 0!==zn(t,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");return n}(o));const i=zn(t,["googleSearchRetrieval"]);if(null!=i&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(i)),void 0!==zn(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==zn(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const s=zn(t,["computerUse"]);null!=s&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(s));const r=zn(t,["codeExecution"]);return null!=r&&$n(n,["codeExecution"],r),n}(Ge(t)))),$n(n,["setup","tools"],t)}const h=zn(t,["sessionResumption"]);void 0!==n&&null!=h&&$n(n,["setup","sessionResumption"],function(t){const n={},e=zn(t,["handle"]);if(null!=e&&$n(n,["handle"],e),void 0!==zn(t,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return n}(h));const m=zn(t,["inputAudioTranscription"]);void 0!==n&&null!=m&&$n(n,["setup","inputAudioTranscription"],{});const g=zn(t,["outputAudioTranscription"]);void 0!==n&&null!=g&&$n(n,["setup","outputAudioTranscription"],{});const _=zn(t,["realtimeInputConfig"]);void 0!==n&&null!=_&&$n(n,["setup","realtimeInputConfig"],function(t){const n={},e=zn(t,["automaticActivityDetection"]);null!=e&&$n(n,["automaticActivityDetection"],function(t){const n={},e=zn(t,["disabled"]);null!=e&&$n(n,["disabled"],e);const o=zn(t,["startOfSpeechSensitivity"]);null!=o&&$n(n,["startOfSpeechSensitivity"],o);const i=zn(t,["endOfSpeechSensitivity"]);null!=i&&$n(n,["endOfSpeechSensitivity"],i);const s=zn(t,["prefixPaddingMs"]);null!=s&&$n(n,["prefixPaddingMs"],s);const r=zn(t,["silenceDurationMs"]);return null!=r&&$n(n,["silenceDurationMs"],r),n}(e));const o=zn(t,["activityHandling"]);null!=o&&$n(n,["activityHandling"],o);const i=zn(t,["turnCoverage"]);return null!=i&&$n(n,["turnCoverage"],i),n}(_));const y=zn(t,["contextWindowCompression"]);void 0!==n&&null!=y&&$n(n,["setup","contextWindowCompression"],function(t){const n={},e=zn(t,["triggerTokens"]);null!=e&&$n(n,["triggerTokens"],e);const o=zn(t,["slidingWindow"]);return null!=o&&$n(n,["slidingWindow"],function(t){const n={},e=zn(t,["targetTokens"]);return null!=e&&$n(n,["targetTokens"],e),n}(o)),n}(y));const v=zn(t,["proactivity"]);return void 0!==n&&null!=v&&$n(n,["setup","proactivity"],function(t){const n={},e=zn(t,["proactiveAudio"]);return null!=e&&$n(n,["proactiveAudio"],e),n}(v)),{}}(i,e)),e}(this.apiClient,E),delete v.config,_.send(JSON.stringify(v)),new ci(_,this.apiClient)}isCallableTool(t){return"callTool"in t&&"function"==typeof t.callTool}}const ui={turnComplete:!0};class ci{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(null!==n.turns&&void 0!==n.turns){let o=[];try{o=xe(n.turns),o=t.isVertexAI()?o.map(t=>Go(t)):o.map(t=>ko(t))}catch(e){throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:o,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let e=[];if(null==n.functionResponses)throw new Error("functionResponses is required.");if(e=Array.isArray(n.functionResponses)?n.functionResponses:[n.functionResponses],0===e.length)throw new Error("functionResponses is required.");for(const o of e){if("object"!=typeof o||null===o||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!t.isVertexAI()&&!("id"in o))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:e}}}sendClientContent(t){t=Object.assign(Object.assign({},ui),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};n=this.apiClient.isVertexAI()?{realtimeInput:Po(t)}:{realtimeInput:Oo(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(null==t.functionResponses)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function di(t){var n,e,o;if(null===(n=null==t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.disable)return!0;let i=!1;for(const r of null!==(e=null==t?void 0:t.tools)&&void 0!==e?e:[])if(pi(r)){i=!0;break}if(!i)return!0;const s=null===(o=null==t?void 0:t.automaticFunctionCalling)||void 0===o?void 0:o.maximumRemoteCalls;return!!(s&&(s<0||!Number.isInteger(s))||0==s)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0)}function pi(t){return"callTool"in t&&"function"==typeof t.callTool}function fi(t){var n;return!(null===(n=null==t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.ignoreCallHistory)}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */class hi extends Wn{constructor(t){super(),this.apiClient=t,this.generateContent=async t=>{var n,e,o,i,s;const r=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!function(t){var n,e,o;return null!==(o=null===(e=null===(n=t.config)||void 0===n?void 0:n.tools)||void 0===e?void 0:e.some(t=>pi(t)))&&void 0!==o&&o}(t)||di(t.config))return await this.generateContentInternal(r);if(function(t){var n,e,o;return null!==(o=null===(e=null===(n=t.config)||void 0===n?void 0:n.tools)||void 0===e?void 0:e.some(t=>!pi(t)))&&void 0!==o&&o}(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let l,a;const u=xe(r.contents),c=null!==(o=null===(e=null===(n=r.config)||void 0===n?void 0:n.automaticFunctionCalling)||void 0===e?void 0:e.maximumRemoteCalls)&&void 0!==o?o:10;let d=0;for(;d<c&&(l=await this.generateContentInternal(r),l.functionCalls&&0!==l.functionCalls.length);){const n=l.candidates[0].content,e=[];for(const o of null!==(s=null===(i=t.config)||void 0===i?void 0:i.tools)&&void 0!==s?s:[])if(pi(o)){const t=o,n=await t.callTool(l.functionCalls);e.push(...n)}d++,a={role:"user",parts:e},r.contents=xe(r.contents),r.contents.push(n),r.contents.push(a),fi(r.config)&&(u.push(n),u.push(a))}return fi(r.config)&&(l.automaticFunctionCallingHistory=u),l},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),di(t.config)){const n=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(n)}return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(t=>{var n;let e;const o=[];if(null==t?void 0:t.generatedImages)for(const s of t.generatedImages)s&&(null==s?void 0:s.safetyAttributes)&&"Positive Prompt"===(null===(n=null==s?void 0:s.safetyAttributes)||void 0===n?void 0:n.contentType)?e=null==s?void 0:s.safetyAttributes:o.push(s);let i;return i=e?{generatedImages:o,positivePromptSafetyAttributes:e,sdkHttpResponse:t.sdkHttpResponse}:{generatedImages:o,sdkHttpResponse:t.sdkHttpResponse},i}),this.list=async t=>{var n;const e={config:Object.assign(Object.assign({},{queryBase:!0}),null==t?void 0:t.config)};if(this.apiClient.isVertexAI()&&!e.config.queryBase){if(null===(n=e.config)||void 0===n?void 0:n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");e.config.filter="labels.tune-type:*"}return new so(Gn.PAGED_ITEM_MODELS,t=>this.listInternal(t),await this.listInternal(e),e)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(t=>t.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const e={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(e)},this.generateVideos=async t=>await this.generateVideosInternal(t)}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,e,o;const i=null===(n=t.config)||void 0===n?void 0:n.tools;if(!i)return t;const s=await Promise.all(i.map(async t=>{if(pi(t)){const n=t;return await n.tool()}return t})),r={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:s})};if(r.config.tools=s,t.config&&t.config.tools&&ni(t.config.tools)){const n=null!==(o=null===(e=t.config.httpOptions)||void 0===e?void 0:e.headers)&&void 0!==o?o:{};let i=Object.assign({},n);0===Object.keys(i).length&&(i=this.apiClient.getDefaultHeaders()),ei(i),r.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:i})}return r}async initAfcToolsMap(t){var n,e,o;const i=new Map;for(const s of null!==(e=null===(n=t.config)||void 0===n?void 0:n.tools)&&void 0!==e?e:[])if(pi(s)){const t=s,n=await t.tool();for(const e of null!==(o=n.functionDeclarations)&&void 0!==o?o:[]){if(!e.name)throw new Error("Function declaration name is required.");if(i.has(e.name))throw new Error(`Duplicate tool declaration name: ${e.name}`);i.set(e.name,t)}}return i}async processAfcStream(t){var n,e,o;const i=null!==(o=null===(e=null===(n=t.config)||void 0===n?void 0:n.automaticFunctionCalling)||void 0===e?void 0:e.maximumRemoteCalls)&&void 0!==o?o:10;let s=!1,r=0;return function(t,n,e){var o,l;return ho(this,arguments,function*(){for(var a,u,c,d;r<i;){s&&(r++,s=!1);const g=yield fo(t.processParamsMaybeAddMcpUsage(e)),_=yield fo(t.generateContentStreamInternal(g)),y=[],v=[];try{for(var p,f=!0,h=(u=void 0,mo(_));!(a=(p=yield fo(h.next())).done);f=!0){d=p.value,f=!1;const t=d;if(yield yield fo(t),t.candidates&&(null===(o=t.candidates[0])||void 0===o?void 0:o.content)){v.push(t.candidates[0].content);for(const e of null!==(l=t.candidates[0].content.parts)&&void 0!==l?l:[])if(r<i&&e.functionCall){if(!e.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!n.has(e.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${n.keys()}, mising tool: ${e.functionCall.name}`);{const t=yield fo(n.get(e.functionCall.name).callTool([e.functionCall]));y.push(...t)}}}}}catch(m){u={error:m}}finally{try{f||a||!(c=h.return)||(yield fo(c.call(h)))}finally{if(u)throw u.error}}if(!(y.length>0))break;{s=!0;const t=new Qn;t.candidates=[{content:{role:"user",parts:y}}],yield yield fo(t);const n=[];n.push(...v),n.push({role:"user",parts:y});const o=xe(e.contents).concat(n);e.contents=o}}})}(this,await this.initAfcToolsMap(t),t)}async generateContentInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=Fo(this.apiClient,t);return r=Kn("{model}:generateContent",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=Yo(t),e=new Qn;return Object.assign(e,n),e})}{const n=qo(this.apiClient,t);return r=Kn("{model}:generateContent",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=jo(t),e=new Qn;return Object.assign(e,n),e})}}async generateContentStreamInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=Fo(this.apiClient,t);return r=Kn("{model}:streamGenerateContent?alt=sse",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.requestStream({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}),s.then(function(t){return ho(this,arguments,function*(){var n,e,o,i;try{for(var s,r=!0,l=mo(t);!(n=(s=yield fo(l.next())).done);r=!0){i=s.value,r=!1;const t=i,n=Yo(yield fo(t.json()));n.sdkHttpResponse={headers:t.headers};const e=new Qn;Object.assign(e,n),yield yield fo(e)}}catch(a){e={error:a}}finally{try{r||n||!(o=l.return)||(yield fo(o.call(l)))}finally{if(e)throw e.error}}})})}{const n=qo(this.apiClient,t);return r=Kn("{model}:streamGenerateContent?alt=sse",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.requestStream({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}),s.then(function(t){return ho(this,arguments,function*(){var n,e,o,i;try{for(var s,r=!0,l=mo(t);!(n=(s=yield fo(l.next())).done);r=!0){i=s.value,r=!1;const t=i,n=jo(yield fo(t.json()));n.sdkHttpResponse={headers:t.headers};const e=new Qn;Object.assign(e,n),yield yield fo(e)}}catch(a){e={error:a}}finally{try{r||n||!(o=l.return)||(yield fo(o.call(l)))}finally{if(e)throw e.error}}})})}}async embedContent(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["contents"]);null!=i&&$n(e,["instances[]","content"],De(t,i));const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["taskType"]);void 0!==n&&null!=e&&$n(n,["instances[]","task_type"],e);const o=zn(t,["title"]);void 0!==n&&null!=o&&$n(n,["instances[]","title"],o);const i=zn(t,["outputDimensionality"]);void 0!==n&&null!=i&&$n(n,["parameters","outputDimensionality"],i);const s=zn(t,["mimeType"]);void 0!==n&&null!=s&&$n(n,["instances[]","mimeType"],s);const r=zn(t,["autoTruncate"]);return void 0!==n&&null!=r&&$n(n,["parameters","autoTruncate"],r),{}}(s,e)),e}(this.apiClient,t);return r=Kn("{model}:predict",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["predictions[]","embeddings"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["values"]);null!=e&&$n(n,["values"],e);const o=zn(t,["statistics"]);return null!=o&&$n(n,["statistics"],function(t){const n={},e=zn(t,["truncated"]);null!=e&&$n(n,["truncated"],e);const o=zn(t,["token_count"]);return null!=o&&$n(n,["tokenCount"],o),n}(o)),n}(t))),$n(n,["embeddings"],t)}const i=zn(t,["metadata"]);return null!=i&&$n(n,["metadata"],function(t){const n={},e=zn(t,["billableCharacterCount"]);return null!=e&&$n(n,["billableCharacterCount"],e),n}(i)),n}(t),e=new te;return Object.assign(e,n),e})}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["contents"]);null!=i&&$n(e,["requests[]","content"],De(t,i));const s=zn(n,["config"]);null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["taskType"]);void 0!==n&&null!=e&&$n(n,["requests[]","taskType"],e);const o=zn(t,["title"]);void 0!==n&&null!=o&&$n(n,["requests[]","title"],o);const i=zn(t,["outputDimensionality"]);if(void 0!==n&&null!=i&&$n(n,["requests[]","outputDimensionality"],i),void 0!==zn(t,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==zn(t,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(s,e));const r=zn(n,["model"]);return void 0!==r&&$n(e,["requests[]","model"],Te(t,r)),e}(this.apiClient,t);return r=Kn("{model}:batchEmbedContents",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["embeddings"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["values"]);return null!=e&&$n(n,["values"],e),n}(t))),$n(n,["embeddings"],t)}return null!=zn(t,["metadata"])&&$n(n,["metadata"],{}),n}(t),e=new te;return Object.assign(e,n),e})}}async generateImagesInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["prompt"]);null!=i&&$n(e,["instances[0]","prompt"],i);const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["outputGcsUri"]);void 0!==n&&null!=e&&$n(n,["parameters","storageUri"],e);const o=zn(t,["negativePrompt"]);void 0!==n&&null!=o&&$n(n,["parameters","negativePrompt"],o);const i=zn(t,["numberOfImages"]);void 0!==n&&null!=i&&$n(n,["parameters","sampleCount"],i);const s=zn(t,["aspectRatio"]);void 0!==n&&null!=s&&$n(n,["parameters","aspectRatio"],s);const r=zn(t,["guidanceScale"]);void 0!==n&&null!=r&&$n(n,["parameters","guidanceScale"],r);const l=zn(t,["seed"]);void 0!==n&&null!=l&&$n(n,["parameters","seed"],l);const a=zn(t,["safetyFilterLevel"]);void 0!==n&&null!=a&&$n(n,["parameters","safetySetting"],a);const u=zn(t,["personGeneration"]);void 0!==n&&null!=u&&$n(n,["parameters","personGeneration"],u);const c=zn(t,["includeSafetyAttributes"]);void 0!==n&&null!=c&&$n(n,["parameters","includeSafetyAttributes"],c);const d=zn(t,["includeRaiReason"]);void 0!==n&&null!=d&&$n(n,["parameters","includeRaiReason"],d);const p=zn(t,["language"]);void 0!==n&&null!=p&&$n(n,["parameters","language"],p);const f=zn(t,["outputMimeType"]);void 0!==n&&null!=f&&$n(n,["parameters","outputOptions","mimeType"],f);const h=zn(t,["outputCompressionQuality"]);void 0!==n&&null!=h&&$n(n,["parameters","outputOptions","compressionQuality"],h);const m=zn(t,["addWatermark"]);void 0!==n&&null!=m&&$n(n,["parameters","addWatermark"],m);const g=zn(t,["imageSize"]);void 0!==n&&null!=g&&$n(n,["parameters","sampleImageSize"],g);const _=zn(t,["enhancePrompt"]);return void 0!==n&&null!=_&&$n(n,["parameters","enhancePrompt"],_),{}}(s,e)),e}(this.apiClient,t);return r=Kn("{model}:predict",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["predictions"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>$o(t))),$n(n,["generatedImages"],t)}const i=zn(t,["positivePromptSafetyAttributes"]);return null!=i&&$n(n,["positivePromptSafetyAttributes"],Ko(i)),n}(t),e=new ne;return Object.assign(e,n),e})}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["prompt"]);null!=i&&$n(e,["instances[0]","prompt"],i);const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){if(void 0!==zn(t,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==zn(t,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const e=zn(t,["numberOfImages"]);void 0!==n&&null!=e&&$n(n,["parameters","sampleCount"],e);const o=zn(t,["aspectRatio"]);void 0!==n&&null!=o&&$n(n,["parameters","aspectRatio"],o);const i=zn(t,["guidanceScale"]);if(void 0!==n&&null!=i&&$n(n,["parameters","guidanceScale"],i),void 0!==zn(t,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const s=zn(t,["safetyFilterLevel"]);void 0!==n&&null!=s&&$n(n,["parameters","safetySetting"],s);const r=zn(t,["personGeneration"]);void 0!==n&&null!=r&&$n(n,["parameters","personGeneration"],r);const l=zn(t,["includeSafetyAttributes"]);void 0!==n&&null!=l&&$n(n,["parameters","includeSafetyAttributes"],l);const a=zn(t,["includeRaiReason"]);void 0!==n&&null!=a&&$n(n,["parameters","includeRaiReason"],a);const u=zn(t,["language"]);void 0!==n&&null!=u&&$n(n,["parameters","language"],u);const c=zn(t,["outputMimeType"]);void 0!==n&&null!=c&&$n(n,["parameters","outputOptions","mimeType"],c);const d=zn(t,["outputCompressionQuality"]);if(void 0!==n&&null!=d&&$n(n,["parameters","outputOptions","compressionQuality"],d),void 0!==zn(t,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");const p=zn(t,["imageSize"]);if(void 0!==n&&null!=p&&$n(n,["parameters","sampleImageSize"],p),void 0!==zn(t,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(s,e)),e}(this.apiClient,t);return r=Kn("{model}:predict",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["predictions"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["_self"]);null!=e&&$n(n,["image"],function(t){const n={},e=zn(t,["bytesBase64Encoded"]);null!=e&&$n(n,["imageBytes"],je(e));const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(e));const o=zn(t,["raiFilteredReason"]);null!=o&&$n(n,["raiFilteredReason"],o);const i=zn(t,["_self"]);return null!=i&&$n(n,["safetyAttributes"],Bo(i)),n}(t))),$n(n,["generatedImages"],t)}const i=zn(t,["positivePromptSafetyAttributes"]);return null!=i&&$n(n,["positivePromptSafetyAttributes"],Bo(i)),n}(t),e=new ne;return Object.assign(e,n),e})}}async editImageInternal(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["prompt"]);null!=i&&$n(e,["instances[0]","prompt"],i);const s=zn(n,["referenceImages"]);if(null!=s){let t=s;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["referenceImage"]);null!=e&&$n(n,["referenceImage"],Vo(e));const o=zn(t,["referenceId"]);null!=o&&$n(n,["referenceId"],o);const i=zn(t,["referenceType"]);null!=i&&$n(n,["referenceType"],i);const s=zn(t,["maskImageConfig"]);null!=s&&$n(n,["maskImageConfig"],function(t){const n={},e=zn(t,["maskMode"]);null!=e&&$n(n,["maskMode"],e);const o=zn(t,["segmentationClasses"]);null!=o&&$n(n,["maskClasses"],o);const i=zn(t,["maskDilation"]);return null!=i&&$n(n,["dilation"],i),n}(s));const r=zn(t,["controlImageConfig"]);null!=r&&$n(n,["controlImageConfig"],function(t){const n={},e=zn(t,["controlType"]);null!=e&&$n(n,["controlType"],e);const o=zn(t,["enableControlImageComputation"]);return null!=o&&$n(n,["computeControl"],o),n}(r));const l=zn(t,["styleImageConfig"]);null!=l&&$n(n,["styleImageConfig"],function(t){const n={},e=zn(t,["styleDescription"]);return null!=e&&$n(n,["styleDescription"],e),n}(l));const a=zn(t,["subjectImageConfig"]);return null!=a&&$n(n,["subjectImageConfig"],function(t){const n={},e=zn(t,["subjectType"]);null!=e&&$n(n,["subjectType"],e);const o=zn(t,["subjectDescription"]);return null!=o&&$n(n,["subjectDescription"],o),n}(a)),n}(t))),$n(e,["instances[0]","referenceImages"],t)}const r=zn(n,["config"]);return null!=r&&$n(e,["config"],function(t,n){const e=zn(t,["outputGcsUri"]);void 0!==n&&null!=e&&$n(n,["parameters","storageUri"],e);const o=zn(t,["negativePrompt"]);void 0!==n&&null!=o&&$n(n,["parameters","negativePrompt"],o);const i=zn(t,["numberOfImages"]);void 0!==n&&null!=i&&$n(n,["parameters","sampleCount"],i);const s=zn(t,["aspectRatio"]);void 0!==n&&null!=s&&$n(n,["parameters","aspectRatio"],s);const r=zn(t,["guidanceScale"]);void 0!==n&&null!=r&&$n(n,["parameters","guidanceScale"],r);const l=zn(t,["seed"]);void 0!==n&&null!=l&&$n(n,["parameters","seed"],l);const a=zn(t,["safetyFilterLevel"]);void 0!==n&&null!=a&&$n(n,["parameters","safetySetting"],a);const u=zn(t,["personGeneration"]);void 0!==n&&null!=u&&$n(n,["parameters","personGeneration"],u);const c=zn(t,["includeSafetyAttributes"]);void 0!==n&&null!=c&&$n(n,["parameters","includeSafetyAttributes"],c);const d=zn(t,["includeRaiReason"]);void 0!==n&&null!=d&&$n(n,["parameters","includeRaiReason"],d);const p=zn(t,["language"]);void 0!==n&&null!=p&&$n(n,["parameters","language"],p);const f=zn(t,["outputMimeType"]);void 0!==n&&null!=f&&$n(n,["parameters","outputOptions","mimeType"],f);const h=zn(t,["outputCompressionQuality"]);void 0!==n&&null!=h&&$n(n,["parameters","outputOptions","compressionQuality"],h);const m=zn(t,["addWatermark"]);void 0!==n&&null!=m&&$n(n,["parameters","addWatermark"],m);const g=zn(t,["editMode"]);void 0!==n&&null!=g&&$n(n,["parameters","editMode"],g);const _=zn(t,["baseSteps"]);return void 0!==n&&null!=_&&$n(n,["parameters","editConfig","baseSteps"],_),{}}(r,e)),e}(this.apiClient,t);return i=Kn("{model}:predict",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),o.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["predictions"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>$o(t))),$n(n,["generatedImages"],t)}return n}(t),e=new ee;return Object.assign(e,n),e})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["image"]);null!=i&&$n(e,["instances[0]","image"],Vo(i));const s=zn(n,["upscaleFactor"]);null!=s&&$n(e,["parameters","upscaleConfig","upscaleFactor"],s);const r=zn(n,["config"]);return null!=r&&$n(e,["config"],function(t,n){const e=zn(t,["includeRaiReason"]);void 0!==n&&null!=e&&$n(n,["parameters","includeRaiReason"],e);const o=zn(t,["outputMimeType"]);void 0!==n&&null!=o&&$n(n,["parameters","outputOptions","mimeType"],o);const i=zn(t,["outputCompressionQuality"]);void 0!==n&&null!=i&&$n(n,["parameters","outputOptions","compressionQuality"],i);const s=zn(t,["enhanceInputImage"]);void 0!==n&&null!=s&&$n(n,["parameters","upscaleConfig","enhanceInputImage"],s);const r=zn(t,["imagePreservationFactor"]);void 0!==n&&null!=r&&$n(n,["parameters","upscaleConfig","imagePreservationFactor"],r);const l=zn(t,["numberOfImages"]);void 0!==n&&null!=l&&$n(n,["parameters","sampleCount"],l);const a=zn(t,["mode"]);return void 0!==n&&null!=a&&$n(n,["parameters","mode"],a),{}}(r,e)),e}(this.apiClient,t);return i=Kn("{model}:predict",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),o.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["predictions"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>$o(t))),$n(n,["generatedImages"],t)}return n}(t),e=new oe;return Object.assign(e,n),e})}throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["source"]);null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["prompt"]);void 0!==n&&null!=e&&$n(n,["instances[0]","prompt"],e);const o=zn(t,["personImage"]);void 0!==n&&null!=o&&$n(n,["instances[0]","personImage","image"],Vo(o));const i=zn(t,["productImages"]);if(void 0!==n&&null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["productImage"]);return null!=e&&$n(n,["image"],Vo(e)),n}(t))),$n(n,["instances[0]","productImages"],t)}return{}}(i,e));const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["numberOfImages"]);void 0!==n&&null!=e&&$n(n,["parameters","sampleCount"],e);const o=zn(t,["baseSteps"]);void 0!==n&&null!=o&&$n(n,["parameters","editConfig","baseSteps"],o);const i=zn(t,["outputGcsUri"]);void 0!==n&&null!=i&&$n(n,["parameters","storageUri"],i);const s=zn(t,["seed"]);void 0!==n&&null!=s&&$n(n,["parameters","seed"],s);const r=zn(t,["safetyFilterLevel"]);void 0!==n&&null!=r&&$n(n,["parameters","safetySetting"],r);const l=zn(t,["personGeneration"]);void 0!==n&&null!=l&&$n(n,["parameters","personGeneration"],l);const a=zn(t,["outputMimeType"]);void 0!==n&&null!=a&&$n(n,["parameters","outputOptions","mimeType"],a);const u=zn(t,["outputCompressionQuality"]);void 0!==n&&null!=u&&$n(n,["parameters","outputOptions","compressionQuality"],u);const c=zn(t,["enhancePrompt"]);return void 0!==n&&null!=c&&$n(n,["parameters","enhancePrompt"],c),{}}(s,e)),e}(this.apiClient,t);return i=Kn("{model}:predict",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),o.then(t=>{const n=function(t){const n={},e=zn(t,["predictions"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>$o(t))),$n(n,["generatedImages"],t)}return n}(t),e=new ie;return Object.assign(e,n),e})}throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["source"]);null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["prompt"]);void 0!==n&&null!=e&&$n(n,["instances[0]","prompt"],e);const o=zn(t,["image"]);void 0!==n&&null!=o&&$n(n,["instances[0]","image"],Vo(o));const i=zn(t,["scribbleImage"]);return void 0!==n&&null!=i&&$n(n,["instances[0]","scribble"],function(t){const n={},e=zn(t,["image"]);return null!=e&&$n(n,["image"],Vo(e)),n}(i)),{}}(i,e));const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["mode"]);void 0!==n&&null!=e&&$n(n,["parameters","mode"],e);const o=zn(t,["maxPredictions"]);void 0!==n&&null!=o&&$n(n,["parameters","maxPredictions"],o);const i=zn(t,["confidenceThreshold"]);void 0!==n&&null!=i&&$n(n,["parameters","confidenceThreshold"],i);const s=zn(t,["maskDilation"]);void 0!==n&&null!=s&&$n(n,["parameters","maskDilation"],s);const r=zn(t,["binaryColorThreshold"]);return void 0!==n&&null!=r&&$n(n,["parameters","binaryColorThreshold"],r),{}}(s,e)),e}(this.apiClient,t);return i=Kn("{model}:predict",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),o.then(t=>{const n=function(t){const n={},e=zn(t,["predictions"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["_self"]);null!=e&&$n(n,["mask"],Wo(e));const o=zn(t,["labels"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["label"]);null!=e&&$n(n,["label"],e);const o=zn(t,["score"]);return null!=o&&$n(n,["score"],o),n}(t))),$n(n,["labels"],t)}return n}(t))),$n(n,["generatedMasks"],t)}return n}(t),e=new se;return Object.assign(e,n),e})}throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","name"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>zo(t))}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","name"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>Jo(t))}}async listInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["config"]);return null!=o&&$n(e,["config"],function(t,n,e){const o=zn(n,["pageSize"]);void 0!==e&&null!=o&&$n(e,["_query","pageSize"],o);const i=zn(n,["pageToken"]);void 0!==e&&null!=i&&$n(e,["_query","pageToken"],i);const s=zn(n,["filter"]);void 0!==e&&null!=s&&$n(e,["_query","filter"],s);const r=zn(n,["queryBase"]);return void 0!==e&&null!=r&&$n(e,["_url","models_url"],Je(t,r)),{}}(t,o,e)),e}(this.apiClient,t);return r=Kn("{models_url}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["_self"]);if(null!=i){let t=Ye(i);Array.isArray(t)&&(t=t.map(t=>zo(t))),$n(n,["models"],t)}return n}(t),e=new re;return Object.assign(e,n),e})}{const n=function(t,n){const e={},o=zn(n,["config"]);return null!=o&&$n(e,["config"],function(t,n,e){const o=zn(n,["pageSize"]);void 0!==e&&null!=o&&$n(e,["_query","pageSize"],o);const i=zn(n,["pageToken"]);void 0!==e&&null!=i&&$n(e,["_query","pageToken"],i);const s=zn(n,["filter"]);void 0!==e&&null!=s&&$n(e,["_query","filter"],s);const r=zn(n,["queryBase"]);return void 0!==e&&null!=r&&$n(e,["_url","models_url"],Je(t,r)),{}}(t,o,e)),e}(this.apiClient,t);return r=Kn("{models_url}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["_self"]);if(null!=i){let t=Ye(i);Array.isArray(t)&&(t=t.map(t=>Jo(t))),$n(n,["models"],t)}return n}(t),e=new re;return Object.assign(e,n),e})}}async update(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["displayName"]);void 0!==n&&null!=e&&$n(n,["displayName"],e);const o=zn(t,["description"]);void 0!==n&&null!=o&&$n(n,["description"],o);const i=zn(t,["defaultCheckpointId"]);return void 0!==n&&null!=i&&$n(n,["defaultCheckpointId"],i),{}}(i,e)),e}(this.apiClient,t);return r=Kn("{model}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>zo(t))}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","name"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["displayName"]);void 0!==n&&null!=e&&$n(n,["displayName"],e);const o=zn(t,["description"]);void 0!==n&&null!=o&&$n(n,["description"],o);const i=zn(t,["defaultCheckpointId"]);return void 0!==n&&null!=i&&$n(n,["defaultCheckpointId"],i),{}}(i,e)),e}(this.apiClient,t);return r=Kn("{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>Jo(t))}}async delete(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","name"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(()=>{const t=new le;return Object.assign(t,{}),t})}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","name"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],i),e}(this.apiClient,t);return r=Kn("{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(()=>{const t=new le;return Object.assign(t,{}),t})}}async countTokens(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["contents"]);if(null!=i){let t=xe(i);Array.isArray(t)&&(t=t.map(t=>Go(t))),$n(e,["contents"],t)}const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t,n){const e=zn(t,["systemInstruction"]);void 0!==n&&null!=e&&$n(n,["systemInstruction"],Go(Me(e)));const o=zn(t,["tools"]);if(void 0!==n&&null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>Ho(t))),$n(n,["tools"],t)}const i=zn(t,["generationConfig"]);return void 0!==n&&null!=i&&$n(n,["generationConfig"],i),{}}(s,e)),e}(this.apiClient,t);return r=Kn("{model}:countTokens",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["totalTokens"]);return null!=o&&$n(n,["totalTokens"],o),n}(t),e=new ae;return Object.assign(e,n),e})}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["contents"]);if(null!=i){let t=xe(i);Array.isArray(t)&&(t=t.map(t=>ko(t))),$n(e,["contents"],t)}const s=zn(n,["config"]);return null!=s&&$n(e,["config"],function(t){if(void 0!==zn(t,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==zn(t,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==zn(t,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.");return{}}(s)),e}(this.apiClient,t);return r=Kn("{model}:countTokens",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["totalTokens"]);null!=o&&$n(n,["totalTokens"],o);const i=zn(t,["cachedContentTokenCount"]);return null!=i&&$n(n,["cachedContentTokenCount"],i),n}(t),e=new ae;return Object.assign(e,n),e})}}async computeTokens(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["contents"]);if(null!=i){let t=xe(i);Array.isArray(t)&&(t=t.map(t=>Go(t))),$n(e,["contents"],t)}const s=zn(n,["config"]);return null!=s&&$n(e,["config"],s),e}(this.apiClient,t);return i=Kn("{model}:computeTokens",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),o.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["tokensInfo"]);return null!=o&&$n(n,["tokensInfo"],o),n}(t),e=new ue;return Object.assign(e,n),e})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["prompt"]);null!=i&&$n(e,["instances[0]","prompt"],i);const s=zn(n,["image"]);null!=s&&$n(e,["instances[0]","image"],Vo(s));const r=zn(n,["video"]);null!=r&&$n(e,["instances[0]","video"],function(t){const n={},e=zn(t,["uri"]);null!=e&&$n(n,["gcsUri"],e);const o=zn(t,["videoBytes"]);null!=o&&$n(n,["bytesBase64Encoded"],je(o));const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(r));const l=zn(n,["config"]);return null!=l&&$n(e,["config"],function(t,n){const e=zn(t,["numberOfVideos"]);void 0!==n&&null!=e&&$n(n,["parameters","sampleCount"],e);const o=zn(t,["outputGcsUri"]);void 0!==n&&null!=o&&$n(n,["parameters","storageUri"],o);const i=zn(t,["fps"]);void 0!==n&&null!=i&&$n(n,["parameters","fps"],i);const s=zn(t,["durationSeconds"]);void 0!==n&&null!=s&&$n(n,["parameters","durationSeconds"],s);const r=zn(t,["seed"]);void 0!==n&&null!=r&&$n(n,["parameters","seed"],r);const l=zn(t,["aspectRatio"]);void 0!==n&&null!=l&&$n(n,["parameters","aspectRatio"],l);const a=zn(t,["resolution"]);void 0!==n&&null!=a&&$n(n,["parameters","resolution"],a);const u=zn(t,["personGeneration"]);void 0!==n&&null!=u&&$n(n,["parameters","personGeneration"],u);const c=zn(t,["pubsubTopic"]);void 0!==n&&null!=c&&$n(n,["parameters","pubsubTopic"],c);const d=zn(t,["negativePrompt"]);void 0!==n&&null!=d&&$n(n,["parameters","negativePrompt"],d);const p=zn(t,["enhancePrompt"]);void 0!==n&&null!=p&&$n(n,["parameters","enhancePrompt"],p);const f=zn(t,["generateAudio"]);void 0!==n&&null!=f&&$n(n,["parameters","generateAudio"],f);const h=zn(t,["lastFrame"]);void 0!==n&&null!=h&&$n(n,["instances[0]","lastFrame"],Vo(h));const m=zn(t,["referenceImages"]);if(void 0!==n&&null!=m){let t=m;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["image"]);null!=e&&$n(n,["image"],Vo(e));const o=zn(t,["referenceType"]);return null!=o&&$n(n,["referenceType"],o),n}(t))),$n(n,["instances[0]","referenceImages"],t)}const g=zn(t,["compressionQuality"]);return void 0!==n&&null!=g&&$n(n,["parameters","compressionQuality"],g),{}}(l,e)),e}(this.apiClient,t);return r=Kn("{model}:predictLongRunning",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s.then(t=>{const n=function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["metadata"]);null!=o&&$n(n,["metadata"],o);const i=zn(t,["done"]);null!=i&&$n(n,["done"],i);const s=zn(t,["error"]);null!=s&&$n(n,["error"],s);const r=zn(t,["response"]);return null!=r&&$n(n,["response"],function(t){const n={},e=zn(t,["videos"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["_self"]);return null!=e&&$n(n,["video"],function(t){const n={},e=zn(t,["gcsUri"]);null!=e&&$n(n,["uri"],e);const o=zn(t,["bytesBase64Encoded"]);null!=o&&$n(n,["videoBytes"],je(o));const i=zn(t,["mimeType"]);return null!=i&&$n(n,["mimeType"],i),n}(e)),n}(t))),$n(n,["generatedVideos"],t)}const o=zn(t,["raiMediaFilteredCount"]);null!=o&&$n(n,["raiMediaFilteredCount"],o);const i=zn(t,["raiMediaFilteredReasons"]);return null!=i&&$n(n,["raiMediaFilteredReasons"],i),n}(r)),n}(t),e=new ve;return Object.assign(e,n),e})}{const n=function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["_url","model"],Te(t,o));const i=zn(n,["prompt"]);null!=i&&$n(e,["instances[0]","prompt"],i);const s=zn(n,["image"]);if(null!=s&&$n(e,["instances[0]","image"],function(t){const n={};if(void 0!==zn(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const e=zn(t,["imageBytes"]);null!=e&&$n(n,["bytesBase64Encoded"],je(e));const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s)),void 0!==zn(n,["video"]))throw new Error("video parameter is not supported in Gemini API.");const r=zn(n,["config"]);return null!=r&&$n(e,["config"],function(t,n){const e=zn(t,["numberOfVideos"]);if(void 0!==n&&null!=e&&$n(n,["parameters","sampleCount"],e),void 0!==zn(t,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==zn(t,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const o=zn(t,["durationSeconds"]);if(void 0!==n&&null!=o&&$n(n,["parameters","durationSeconds"],o),void 0!==zn(t,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const i=zn(t,["aspectRatio"]);if(void 0!==n&&null!=i&&$n(n,["parameters","aspectRatio"],i),void 0!==zn(t,["resolution"]))throw new Error("resolution parameter is not supported in Gemini API.");const s=zn(t,["personGeneration"]);if(void 0!==n&&null!=s&&$n(n,["parameters","personGeneration"],s),void 0!==zn(t,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const r=zn(t,["negativePrompt"]);void 0!==n&&null!=r&&$n(n,["parameters","negativePrompt"],r);const l=zn(t,["enhancePrompt"]);if(void 0!==n&&null!=l&&$n(n,["parameters","enhancePrompt"],l),void 0!==zn(t,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");if(void 0!==zn(t,["lastFrame"]))throw new Error("lastFrame parameter is not supported in Gemini API.");if(void 0!==zn(t,["referenceImages"]))throw new Error("referenceImages parameter is not supported in Gemini API.");if(void 0!==zn(t,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}(r,e)),e}(this.apiClient,t);return r=Kn("{model}:predictLongRunning",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s.then(t=>{const n=function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["name"],e);const o=zn(t,["metadata"]);null!=o&&$n(n,["metadata"],o);const i=zn(t,["done"]);null!=i&&$n(n,["done"],i);const s=zn(t,["error"]);null!=s&&$n(n,["error"],s);const r=zn(t,["response","generateVideoResponse"]);return null!=r&&$n(n,["response"],function(t){const n={},e=zn(t,["generatedSamples"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["_self"]);return null!=e&&$n(n,["video"],function(t){const n={},e=zn(t,["video","uri"]);null!=e&&$n(n,["uri"],e);const o=zn(t,["video","encodedVideo"]);null!=o&&$n(n,["videoBytes"],je(o));const i=zn(t,["encoding"]);return null!=i&&$n(n,["mimeType"],i),n}(e)),n}(t))),$n(n,["generatedVideos"],t)}const o=zn(t,["raiMediaFilteredCount"]);null!=o&&$n(n,["raiMediaFilteredCount"],o);const i=zn(t,["raiMediaFilteredReasons"]);return null!=i&&$n(n,["raiMediaFilteredReasons"],i),n}(r)),n}(t),e=new ve;return Object.assign(e,n),e})}}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
class mi extends Wn{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,e=t.config;if(void 0===n.name||""===n.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const t=n.name.split("/operations/")[0];let o;e&&"httpOptions"in e&&(o=e.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:t,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{const t=await this.getVideosOperationInternal({operationName:n.name,config:e});return n._fromAPIResponse({apiResponse:t,isVertexAI:!1})}}async get(t){const n=t.operation,e=t.config;if(void 0===n.name||""===n.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const t=n.name.split("/operations/")[0];let o;e&&"httpOptions"in e&&(o=e.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:t,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{const t=await this.getVideosOperationInternal({operationName:n.name,config:e});return n._fromAPIResponse({apiResponse:t,isVertexAI:!1})}}async getVideosOperationInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t){const n={},e=zn(t,["operationName"]);null!=e&&$n(n,["_url","operationName"],e);const o=zn(t,["config"]);return null!=o&&$n(n,["config"],o),n}(t);return r=Kn("{operationName}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),s}{const n=function(t){const n={},e=zn(t,["operationName"]);null!=e&&$n(n,["_url","operationName"],e);const o=zn(t,["config"]);return null!=o&&$n(n,["config"],o),n}(t);return r=Kn("{operationName}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json()),s}}async fetchPredictVideosOperationInternal(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(t){const n={},e=zn(t,["operationName"]);null!=e&&$n(n,["operationName"],e);const o=zn(t,["resourceName"]);null!=o&&$n(n,["_url","resourceName"],o);const i=zn(t,["config"]);return null!=i&&$n(n,["config"],i),n}(t);return i=Kn("{resourceName}:fetchPredictOperation",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),o}throw new Error("This method is only supported by the Vertex AI.")}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function gi(t){const n={},e=zn(t,["prebuiltVoiceConfig"]);return null!=e&&$n(n,["prebuiltVoiceConfig"],function(t){const n={},e=zn(t,["voiceName"]);return null!=e&&$n(n,["voiceName"],e),n}(e)),n}class _i extends Wn{constructor(t){super(),this.apiClient=t}async create(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const r=function(t,n){const e={},o=zn(n,["config"]);return null!=o&&$n(e,["config"],function(t,n,e){const o=zn(n,["expireTime"]);void 0!==e&&null!=o&&$n(e,["expireTime"],o);const i=zn(n,["newSessionExpireTime"]);void 0!==e&&null!=i&&$n(e,["newSessionExpireTime"],i);const s=zn(n,["uses"]);void 0!==e&&null!=s&&$n(e,["uses"],s);const r=zn(n,["liveConnectConstraints"]);void 0!==e&&null!=r&&$n(e,["bidiGenerateContentSetup"],function(t,n){const e={},o=zn(n,["model"]);null!=o&&$n(e,["setup","model"],Te(t,o));const i=zn(n,["config"]);return null!=i&&$n(e,["config"],function(t,n){const e=zn(t,["generationConfig"]);void 0!==n&&null!=e&&$n(n,["setup","generationConfig"],e);const o=zn(t,["responseModalities"]);void 0!==n&&null!=o&&$n(n,["setup","generationConfig","responseModalities"],o);const i=zn(t,["temperature"]);void 0!==n&&null!=i&&$n(n,["setup","generationConfig","temperature"],i);const s=zn(t,["topP"]);void 0!==n&&null!=s&&$n(n,["setup","generationConfig","topP"],s);const r=zn(t,["topK"]);void 0!==n&&null!=r&&$n(n,["setup","generationConfig","topK"],r);const l=zn(t,["maxOutputTokens"]);void 0!==n&&null!=l&&$n(n,["setup","generationConfig","maxOutputTokens"],l);const a=zn(t,["mediaResolution"]);void 0!==n&&null!=a&&$n(n,["setup","generationConfig","mediaResolution"],a);const u=zn(t,["seed"]);void 0!==n&&null!=u&&$n(n,["setup","generationConfig","seed"],u);const c=zn(t,["speechConfig"]);void 0!==n&&null!=c&&$n(n,["setup","generationConfig","speechConfig"],function(t){const n={},e=zn(t,["voiceConfig"]);null!=e&&$n(n,["voiceConfig"],gi(e));const o=zn(t,["multiSpeakerVoiceConfig"]);null!=o&&$n(n,["multiSpeakerVoiceConfig"],function(t){const n={},e=zn(t,["speakerVoiceConfigs"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["speaker"]);null!=e&&$n(n,["speaker"],e);const o=zn(t,["voiceConfig"]);return null!=o&&$n(n,["voiceConfig"],gi(o)),n}(t))),$n(n,["speakerVoiceConfigs"],t)}return n}(o));const i=zn(t,["languageCode"]);return null!=i&&$n(n,["languageCode"],i),n}(qe(c)));const d=zn(t,["enableAffectiveDialog"]);void 0!==n&&null!=d&&$n(n,["setup","generationConfig","enableAffectiveDialog"],d);const p=zn(t,["systemInstruction"]);void 0!==n&&null!=p&&$n(n,["setup","systemInstruction"],function(t){const n={},e=zn(t,["parts"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["videoMetadata"]);null!=e&&$n(n,["videoMetadata"],function(t){const n={},e=zn(t,["fps"]);null!=e&&$n(n,["fps"],e);const o=zn(t,["endOffset"]);null!=o&&$n(n,["endOffset"],o);const i=zn(t,["startOffset"]);return null!=i&&$n(n,["startOffset"],i),n}(e));const o=zn(t,["thought"]);null!=o&&$n(n,["thought"],o);const i=zn(t,["inlineData"]);null!=i&&$n(n,["inlineData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["data"]);null!=e&&$n(n,["data"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(i));const s=zn(t,["fileData"]);null!=s&&$n(n,["fileData"],function(t){const n={};if(void 0!==zn(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const e=zn(t,["fileUri"]);null!=e&&$n(n,["fileUri"],e);const o=zn(t,["mimeType"]);return null!=o&&$n(n,["mimeType"],o),n}(s));const r=zn(t,["thoughtSignature"]);null!=r&&$n(n,["thoughtSignature"],r);const l=zn(t,["codeExecutionResult"]);null!=l&&$n(n,["codeExecutionResult"],l);const a=zn(t,["executableCode"]);null!=a&&$n(n,["executableCode"],a);const u=zn(t,["functionCall"]);null!=u&&$n(n,["functionCall"],u);const c=zn(t,["functionResponse"]);null!=c&&$n(n,["functionResponse"],c);const d=zn(t,["text"]);return null!=d&&$n(n,["text"],d),n}(t))),$n(n,["parts"],t)}const o=zn(t,["role"]);return null!=o&&$n(n,["role"],o),n}(Me(p)));const f=zn(t,["tools"]);if(void 0!==n&&null!=f){let t=He(f);Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["functionDeclarations"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["behavior"]);null!=e&&$n(n,["behavior"],e);const o=zn(t,["description"]);null!=o&&$n(n,["description"],o);const i=zn(t,["name"]);null!=i&&$n(n,["name"],i);const s=zn(t,["parameters"]);null!=s&&$n(n,["parameters"],s);const r=zn(t,["parametersJsonSchema"]);null!=r&&$n(n,["parametersJsonSchema"],r);const l=zn(t,["response"]);null!=l&&$n(n,["response"],l);const a=zn(t,["responseJsonSchema"]);return null!=a&&$n(n,["responseJsonSchema"],a),n}(t))),$n(n,["functionDeclarations"],t)}if(void 0!==zn(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=zn(t,["googleSearch"]);null!=o&&$n(n,["googleSearch"],function(t){const n={},e=zn(t,["timeRangeFilter"]);if(null!=e&&$n(n,["timeRangeFilter"],function(t){const n={},e=zn(t,["startTime"]);null!=e&&$n(n,["startTime"],e);const o=zn(t,["endTime"]);return null!=o&&$n(n,["endTime"],o),n}(e)),void 0!==zn(t,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");return n}(o));const i=zn(t,["googleSearchRetrieval"]);if(null!=i&&$n(n,["googleSearchRetrieval"],function(t){const n={},e=zn(t,["dynamicRetrievalConfig"]);return null!=e&&$n(n,["dynamicRetrievalConfig"],function(t){const n={},e=zn(t,["mode"]);null!=e&&$n(n,["mode"],e);const o=zn(t,["dynamicThreshold"]);return null!=o&&$n(n,["dynamicThreshold"],o),n}(e)),n}(i)),void 0!==zn(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==zn(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=zn(t,["urlContext"])&&$n(n,["urlContext"],{});const s=zn(t,["computerUse"]);null!=s&&$n(n,["computerUse"],function(t){const n={},e=zn(t,["environment"]);return null!=e&&$n(n,["environment"],e),n}(s));const r=zn(t,["codeExecution"]);return null!=r&&$n(n,["codeExecution"],r),n}(Ge(t)))),$n(n,["setup","tools"],t)}const h=zn(t,["sessionResumption"]);void 0!==n&&null!=h&&$n(n,["setup","sessionResumption"],function(t){const n={},e=zn(t,["handle"]);if(null!=e&&$n(n,["handle"],e),void 0!==zn(t,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return n}(h));const m=zn(t,["inputAudioTranscription"]);void 0!==n&&null!=m&&$n(n,["setup","inputAudioTranscription"],{});const g=zn(t,["outputAudioTranscription"]);void 0!==n&&null!=g&&$n(n,["setup","outputAudioTranscription"],{});const _=zn(t,["realtimeInputConfig"]);void 0!==n&&null!=_&&$n(n,["setup","realtimeInputConfig"],function(t){const n={},e=zn(t,["automaticActivityDetection"]);null!=e&&$n(n,["automaticActivityDetection"],function(t){const n={},e=zn(t,["disabled"]);null!=e&&$n(n,["disabled"],e);const o=zn(t,["startOfSpeechSensitivity"]);null!=o&&$n(n,["startOfSpeechSensitivity"],o);const i=zn(t,["endOfSpeechSensitivity"]);null!=i&&$n(n,["endOfSpeechSensitivity"],i);const s=zn(t,["prefixPaddingMs"]);null!=s&&$n(n,["prefixPaddingMs"],s);const r=zn(t,["silenceDurationMs"]);return null!=r&&$n(n,["silenceDurationMs"],r),n}(e));const o=zn(t,["activityHandling"]);null!=o&&$n(n,["activityHandling"],o);const i=zn(t,["turnCoverage"]);return null!=i&&$n(n,["turnCoverage"],i),n}(_));const y=zn(t,["contextWindowCompression"]);void 0!==n&&null!=y&&$n(n,["setup","contextWindowCompression"],function(t){const n={},e=zn(t,["triggerTokens"]);null!=e&&$n(n,["triggerTokens"],e);const o=zn(t,["slidingWindow"]);return null!=o&&$n(n,["slidingWindow"],function(t){const n={},e=zn(t,["targetTokens"]);return null!=e&&$n(n,["targetTokens"],e),n}(o)),n}(y));const v=zn(t,["proactivity"]);return void 0!==n&&null!=v&&$n(n,["setup","proactivity"],function(t){const n={},e=zn(t,["proactiveAudio"]);return null!=e&&$n(n,["proactiveAudio"],e),n}(v)),{}}(i,e)),e}(t,r));const l=zn(n,["lockAdditionalFields"]);return void 0!==e&&null!=l&&$n(e,["fieldMask"],l),{}}(t,o,e)),e}(this.apiClient,t);i=Kn("auth_tokens",r._url),s=r._query,delete r.config,delete r._url,delete r._query;const l=function(t,n){let e=null;const o=t.bidiGenerateContentSetup;if("object"==typeof o&&null!==o&&"setup"in o){const n=o.setup;"object"==typeof n&&null!==n?(t.bidiGenerateContentSetup=n,e=n):delete t.bidiGenerateContentSetup}else void 0!==o&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(e){const o=
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
function(t){const n=[];for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const o=t[e];if("object"==typeof o&&null!=o&&Object.keys(o).length>0){const t=Object.keys(o).map(t=>`${e}.${t}`);n.push(...t)}else n.push(e)}return n.join(",")}(e);if(Array.isArray(null==n?void 0:n.lockAdditionalFields)&&0===(null==n?void 0:n.lockAdditionalFields.length))o?t.fieldMask=o:delete t.fieldMask;else if((null==n?void 0:n.lockAdditionalFields)&&n.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){const n=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let e=[];i.length>0&&(e=i.map(t=>n.includes(t)?`generationConfig.${t}`:t));const s=[];o&&s.push(o),e.length>0&&s.push(...e),s.length>0?t.fieldMask=s.join(","):delete t.fieldMask}else delete t.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}(r,t.config);return o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json()),o.then(t=>function(t){const n={},e=zn(t,["name"]);return null!=e&&$n(n,["name"],e),n}(t))}}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */function yi(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["state"]);null!=i&&$n(n,["state"],Ve(i));const s=zn(t,["createTime"]);null!=s&&$n(n,["createTime"],s);const r=zn(t,["tuningTask","startTime"]);null!=r&&$n(n,["startTime"],r);const l=zn(t,["tuningTask","completeTime"]);null!=l&&$n(n,["endTime"],l);const a=zn(t,["updateTime"]);null!=a&&$n(n,["updateTime"],a);const u=zn(t,["description"]);null!=u&&$n(n,["description"],u);const c=zn(t,["baseModel"]);null!=c&&$n(n,["baseModel"],c);const d=zn(t,["_self"]);null!=d&&$n(n,["tunedModel"],function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["model"],e);const o=zn(t,["name"]);return null!=o&&$n(n,["endpoint"],o),n}(d));const p=zn(t,["customBaseModel"]);null!=p&&$n(n,["customBaseModel"],p);const f=zn(t,["experiment"]);null!=f&&$n(n,["experiment"],f);const h=zn(t,["labels"]);null!=h&&$n(n,["labels"],h);const m=zn(t,["outputUri"]);null!=m&&$n(n,["outputUri"],m);const g=zn(t,["pipelineJob"]);null!=g&&$n(n,["pipelineJob"],g);const _=zn(t,["serviceAccount"]);null!=_&&$n(n,["serviceAccount"],_);const y=zn(t,["tunedModelDisplayName"]);return null!=y&&$n(n,["tunedModelDisplayName"],y),n}function vi(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["state"]);null!=i&&$n(n,["state"],Ve(i));const s=zn(t,["createTime"]);null!=s&&$n(n,["createTime"],s);const r=zn(t,["startTime"]);null!=r&&$n(n,["startTime"],r);const l=zn(t,["endTime"]);null!=l&&$n(n,["endTime"],l);const a=zn(t,["updateTime"]);null!=a&&$n(n,["updateTime"],a);const u=zn(t,["error"]);null!=u&&$n(n,["error"],u);const c=zn(t,["description"]);null!=c&&$n(n,["description"],c);const d=zn(t,["baseModel"]);null!=d&&$n(n,["baseModel"],d);const p=zn(t,["tunedModel"]);null!=p&&$n(n,["tunedModel"],function(t){const n={},e=zn(t,["model"]);null!=e&&$n(n,["model"],e);const o=zn(t,["endpoint"]);null!=o&&$n(n,["endpoint"],o);const i=zn(t,["checkpoints"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["checkpointId"]);null!=e&&$n(n,["checkpointId"],e);const o=zn(t,["epoch"]);null!=o&&$n(n,["epoch"],o);const i=zn(t,["step"]);null!=i&&$n(n,["step"],i);const s=zn(t,["endpoint"]);return null!=s&&$n(n,["endpoint"],s),n}(t))),$n(n,["checkpoints"],t)}return n}(p));const f=zn(t,["preTunedModel"]);null!=f&&$n(n,["preTunedModel"],f);const h=zn(t,["supervisedTuningSpec"]);null!=h&&$n(n,["supervisedTuningSpec"],h);const m=zn(t,["tuningDataStats"]);null!=m&&$n(n,["tuningDataStats"],m);const g=zn(t,["encryptionSpec"]);null!=g&&$n(n,["encryptionSpec"],g);const _=zn(t,["partnerModelTuningSpec"]);null!=_&&$n(n,["partnerModelTuningSpec"],_);const y=zn(t,["customBaseModel"]);null!=y&&$n(n,["customBaseModel"],y);const v=zn(t,["experiment"]);null!=v&&$n(n,["experiment"],v);const C=zn(t,["labels"]);null!=C&&$n(n,["labels"],C);const T=zn(t,["outputUri"]);null!=T&&$n(n,["outputUri"],T);const E=zn(t,["pipelineJob"]);null!=E&&$n(n,["pipelineJob"],E);const A=zn(t,["serviceAccount"]);null!=A&&$n(n,["serviceAccount"],A);const I=zn(t,["tunedModelDisplayName"]);return null!=I&&$n(n,["tunedModelDisplayName"],I),n}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
class Ci extends Wn{constructor(t){super(),this.apiClient=t,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new so(Gn.PAGED_ITEM_TUNING_JOBS,t=>this.listInternal(t),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI()){if(t.baseModel.startsWith("projects/")){const n={tunedModelName:t.baseModel},e=Object.assign(Object.assign({},t),{preTunedModel:n});return e.baseModel=void 0,await this.tuneInternal(e)}{const n=Object.assign({},t);return await this.tuneInternal(n)}}{const n=Object.assign({},t),e=await this.tuneMldevInternal(n);let o="";return void 0!==e.metadata&&void 0!==e.metadata.tunedModel?o=e.metadata.tunedModel:void 0!==e.name&&e.name.includes("/operations/")&&(o=e.name.split("/operations/")[0]),{name:o,state:kt.JOB_STATE_QUEUED}}}}async getInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["_url","name"],e);const o=zn(t,["config"]);return null!=o&&$n(n,["config"],o),n}(t);return r=Kn("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>vi(t))}{const n=function(t){const n={},e=zn(t,["name"]);null!=e&&$n(n,["_url","name"],e);const o=zn(t,["config"]);return null!=o&&$n(n,["config"],o),n}(t);return r=Kn("{name}",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>yi(t))}}async listInternal(t){var n,e,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(t){const n={},e=zn(t,["config"]);return null!=e&&$n(n,["config"],function(t,n){const e=zn(t,["pageSize"]);void 0!==n&&null!=e&&$n(n,["_query","pageSize"],e);const o=zn(t,["pageToken"]);void 0!==n&&null!=o&&$n(n,["_query","pageToken"],o);const i=zn(t,["filter"]);return void 0!==n&&null!=i&&$n(n,["_query","filter"],i),{}}(e,n)),n}(t);return r=Kn("tuningJobs",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["tuningJobs"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>vi(t))),$n(n,["tuningJobs"],t)}return n}(t),e=new de;return Object.assign(e,n),e})}{const n=function(t){const n={},e=zn(t,["config"]);return null!=e&&$n(n,["config"],function(t,n){const e=zn(t,["pageSize"]);void 0!==n&&null!=e&&$n(n,["_query","pageSize"],e);const o=zn(t,["pageToken"]);void 0!==n&&null!=o&&$n(n,["_query","pageToken"],o);const i=zn(t,["filter"]);return void 0!==n&&null!=i&&$n(n,["_query","filter"],i),{}}(e,n)),n}(t);return r=Kn("tunedModels",n._url),l=n._query,delete n.config,delete n._url,delete n._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(o=t.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=t.config)||void 0===i?void 0:i.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),s.then(t=>{const n=function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["nextPageToken"]);null!=o&&$n(n,["nextPageToken"],o);const i=zn(t,["tunedModels"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>yi(t))),$n(n,["tuningJobs"],t)}return n}(t),e=new de;return Object.assign(e,n),e})}}async tuneInternal(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(t){const n={},e=zn(t,["baseModel"]);null!=e&&$n(n,["baseModel"],e);const o=zn(t,["preTunedModel"]);null!=o&&$n(n,["preTunedModel"],o);const i=zn(t,["trainingDataset"]);null!=i&&$n(n,["supervisedTuningSpec","trainingDatasetUri"],function(t,n){const e=zn(t,["gcsUri"]);void 0!==n&&null!=e&&$n(n,["supervisedTuningSpec","trainingDatasetUri"],e);const o=zn(t,["vertexDatasetResource"]);if(void 0!==n&&null!=o&&$n(n,["supervisedTuningSpec","trainingDatasetUri"],o),void 0!==zn(t,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.");return{}}(i,n));const s=zn(t,["config"]);return null!=s&&$n(n,["config"],function(t,n){const e={},o=zn(t,["validationDataset"]);void 0!==n&&null!=o&&$n(n,["supervisedTuningSpec"],function(t,n){const e={},o=zn(t,["gcsUri"]);null!=o&&$n(e,["validationDatasetUri"],o);const i=zn(t,["vertexDatasetResource"]);return void 0!==n&&null!=i&&$n(n,["supervisedTuningSpec","trainingDatasetUri"],i),e}(o,e));const i=zn(t,["tunedModelDisplayName"]);void 0!==n&&null!=i&&$n(n,["tunedModelDisplayName"],i);const s=zn(t,["description"]);void 0!==n&&null!=s&&$n(n,["description"],s);const r=zn(t,["epochCount"]);void 0!==n&&null!=r&&$n(n,["supervisedTuningSpec","hyperParameters","epochCount"],r);const l=zn(t,["learningRateMultiplier"]);void 0!==n&&null!=l&&$n(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],l);const a=zn(t,["exportLastCheckpointOnly"]);void 0!==n&&null!=a&&$n(n,["supervisedTuningSpec","exportLastCheckpointOnly"],a);const u=zn(t,["preTunedModelCheckpointId"]);null!=u&&$n(e,["preTunedModel","checkpointId"],u);const c=zn(t,["adapterSize"]);if(void 0!==n&&null!=c&&$n(n,["supervisedTuningSpec","hyperParameters","adapterSize"],c),void 0!==zn(t,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==zn(t,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");return e}(s,n)),n}(t);return i=Kn("tuningJobs",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),o.then(t=>vi(t))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,e;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(t){const n={},e=zn(t,["baseModel"]);null!=e&&$n(n,["baseModel"],e);const o=zn(t,["preTunedModel"]);null!=o&&$n(n,["preTunedModel"],o);const i=zn(t,["trainingDataset"]);null!=i&&$n(n,["tuningTask","trainingData"],function(t){const n={};if(void 0!==zn(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==zn(t,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const e=zn(t,["examples"]);if(null!=e){let t=e;Array.isArray(t)&&(t=t.map(t=>function(t){const n={},e=zn(t,["textInput"]);null!=e&&$n(n,["textInput"],e);const o=zn(t,["output"]);return null!=o&&$n(n,["output"],o),n}(t))),$n(n,["examples","examples"],t)}return n}(i));const s=zn(t,["config"]);return null!=s&&$n(n,["config"],function(t,n){const e={};if(void 0!==zn(t,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const o=zn(t,["tunedModelDisplayName"]);if(void 0!==n&&null!=o&&$n(n,["displayName"],o),void 0!==zn(t,["description"]))throw new Error("description parameter is not supported in Gemini API.");const i=zn(t,["epochCount"]);void 0!==n&&null!=i&&$n(n,["tuningTask","hyperparameters","epochCount"],i);const s=zn(t,["learningRateMultiplier"]);if(null!=s&&$n(e,["tuningTask","hyperparameters","learningRateMultiplier"],s),void 0!==zn(t,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==zn(t,["preTunedModelCheckpointId"]))throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==zn(t,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const r=zn(t,["batchSize"]);void 0!==n&&null!=r&&$n(n,["tuningTask","hyperparameters","batchSize"],r);const l=zn(t,["learningRate"]);return void 0!==n&&null!=l&&$n(n,["tuningTask","hyperparameters","learningRate"],l),e}(s,n)),n}(t);return i=Kn("tunedModels",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(n=t.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(e=t.config)||void 0===e?void 0:e.abortSignal}).then(t=>t.json().then(n=>{const e=n;return e.sdkHttpResponse={headers:t.headers},e})),o.then(t=>function(t){const n={},e=zn(t,["sdkHttpResponse"]);null!=e&&$n(n,["sdkHttpResponse"],e);const o=zn(t,["name"]);null!=o&&$n(n,["name"],o);const i=zn(t,["metadata"]);null!=i&&$n(n,["metadata"],i);const s=zn(t,["done"]);null!=s&&$n(n,["done"],s);const r=zn(t,["error"]);return null!=r&&$n(n,["error"],r),n}(t))}}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */class Ti{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Ei="x-goog-upload-status";function Ai(t){return new Promise(n=>setTimeout(n,t))}class Ii{async upload(t,n,e){if("string"==typeof t)throw new Error("File path is not supported in browser uploader.");return await async function(t,n,e){var o,i,s;let r=0,l=0,a=new Zn(new Response),u="upload";for(r=t.size;l<r;){const s=Math.min(8388608,r-l),c=t.slice(l,l+s);l+s>=r&&(u+=", finalize");let d=0,p=1e3;for(;d<3&&(a=await e.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(s)}}}),!(null===(o=null==a?void 0:a.headers)||void 0===o?void 0:o[Ei]));)d++,await Ai(p),p*=2;if(l+=s,"active"!==(null===(i=null==a?void 0:a.headers)||void 0===i?void 0:i[Ei]))break;if(r<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const c=await(null==a?void 0:a.json());if("final"!==(null===(s=null==a?void 0:a.headers)||void 0===s?void 0:s[Ei]))throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}(t,n,e)}async stat(t){if("string"==typeof t)throw new Error("File path is not supported in browser uploader.");return await async function(t){return{size:t.size,type:t.type}}(t)}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */class Oi{create(t,n,e){return new Si(t,n,e)}}class Si{constructor(t,n,e){this.url=t,this.headers=n,this.callbacks=e}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */const bi="x-goog-api-key";class wi{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(null===t.get(bi)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(bi,this.apiKey)}}}
/**
   * @license
   * Copyright 2025 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */class Ri{constructor(t){var n;if(null==t.apiKey)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(n=t.vertexai)&&void 0!==n&&n,this.apiKey=t.apiKey;const e=function(t,n){var e,o;if(!(null==t?void 0:t.baseUrl)){const t={geminiUrl:void 0,vertexUrl:void 0};return n?null!==(e=t.vertexUrl)&&void 0!==e?e:void 0:null!==(o=t.geminiUrl)&&void 0!==o?o:void 0}return t.baseUrl}(t.httpOptions,t.vertexai);e&&(t.httpOptions?t.httpOptions.baseUrl=e:t.httpOptions={baseUrl:e}),this.apiVersion=t.apiVersion;const o=new wi(this.apiKey);this.apiClient=new Qo({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:"gl-node/web",uploader:new Ii,downloader:new Ti}),this.models=new hi(this.apiClient),this.live=new ai(this.apiClient,o,new Oi),this.batches=new ro(this.apiClient),this.chats=new vo(this.models,this.apiClient),this.caches=new po(this.apiClient),this.files=new Ao(this.apiClient),this.operations=new mi(this.apiClient),this.authTokens=new _i(this.apiClient),this.tunings=new Ci(this.apiClient)}}const Ni=document.createElement("div");Ni.id="chat-widget-container";const Pi=Ni.attachShadow({mode:"open"});!function(t){const n=document.createElement("style");n.textContent="\n  @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap');\n  @import url('https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Outfit:wght@100..900&display=swap');\n  @import url('https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Outfit:wght@100..900&family=Source+Sans+3:ital,wght@0,200..900;1,200..900&display=swap');\n  @import url('https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Outfit:wght@100..900&family=Questrial&family=Source+Sans+3:ital,wght@0,200..900;1,200..900&display=swap');\n  @import \"./src/components/widget.css\";\n",t.appendChild(n)}(Pi);const Mi=document.createElement("div");var Di,xi,Ui,ki,Li;Mi.id="chat-widget-root",Pi.appendChild(Mi),document.body.appendChild(Ni),Di=_(function(){const[t,n]=tt(!0),[e,o]=tt(!1),[i,s]=tt(!1),[r,l]=tt(!1),[a,u]=tt(!1);tt([{name:"John"}]);const[c,d]=tt([{id:1,type:"bot",text:"Hi! How can I help you?",time:Yn(Date.now())[1],isLoading:!1}]),[p,f]=tt("");tt("I'm here to assist you with that!");const h=new Ri({apiKey:"AIzaSyCY-L3Q04v9gwSBYvyl8CBYJ-BU1S4DSgQ"}),m=()=>o(t=>!t);var g,_,y;g=()=>{let t=document.getElementById("my-script")?.getAttribute("data-payload")||"hi";"left"===(document.getElementById("my-script")?.getAttribute("data-position")||"right")?document.documentElement.style.setProperty("--host-left","1%"):document.documentElement.style.setProperty("--host-right","1%"),console.log("payload id: "+t)},_=[],y=Q(H++,3),!Y.__s&&function(t,n){return!t||t.length!==n.length||n.some(function(n,e){return n!==t[e]})}(y.__H,_)&&(y.__=g,y.u=_,F.__H.__h.push(y));const v=()=>{if(!p.trim())return;const t={id:Date.now(),type:"user",text:p,time:Yn(Date.now())[1],isLoading:!1};d(n=>[...n,t]),f("");const n=Date.now()+1,e={id:n,type:"bot",text:"",time:Yn(Date.now())[1],isLoading:!0};d(t=>[...t,e]),async function(){return(await h.models.generateContent({model:"gemini-2.5-flash",contents:p})).text}().then(t=>{d(e=>e.map(e=>e.id===n?{...e,text:t,isLoading:!1}:e))})};return G("div",{id:"chat-root",children:[t&&G("div",{className:"chat-icon","aria-live":"polite","aria-label":"Chat",role:"button",onClick:m,onKeyDown:t=>"Enter"===t.key&&m(),children:G("svg",{width:"75",height:"68",viewBox:"0 0 75 68",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[G("g",{filter:"url(#filter0_d_8673_2670)",children:[G("ellipse",{cx:"37.5002",cy:"30",rx:"25.1296",ry:"21.6667",fill:"white"}),G("path",{d:"M37.5002 4C21.2078 4 8 15.6409 8 30.0002C8 37.3989 11.5062 44.0755 17.1343 48.81C17.0623 51.0675 16.2932 53.302 14.9482 55.0939C17.5558 54.9875 20.1101 53.9229 22.0741 52.1664C26.5625 54.598 31.8457 56.0004 37.5002 56.0004C53.7926 56.0004 67.0004 44.3595 67.0004 30.0002C67.0004 15.6409 53.7926 4 37.5002 4ZM55.8352 42.599C54.748 43.8262 53.1989 44.516 51.5813 44.516H23.4191C21.8015 44.516 20.2524 43.8262 19.1652 42.599C16.0867 39.1239 14.2522 34.7507 14.2522 29.9998C14.2522 25.249 16.0863 20.8761 19.1648 17.401C22.5117 13.622 27.3739 10.5 37.5 10.5C45.948 10.5 52.7599 13.9097 55.8733 17.4436C58.9292 20.9115 60.7482 25.2685 60.7482 29.9994C60.7482 34.7303 58.9137 39.1239 55.8352 42.599Z",fill:"url(#paint0_linear_8673_2670)"}),G("path",{d:"M31.2311 29.1936C30.3741 30.545 29.1376 29.1936 26.5542 29.1936C23.9707 29.1936 22.7346 30.545 21.8776 29.1936C21.0482 27.8852 23.3365 24.6578 26.5542 24.6578C29.7718 24.6578 32.0602 27.8856 31.2311 29.1936Z",fill:"#46359D"}),G("path",{d:"M53.1223 29.1936C52.2653 30.545 51.0287 29.1936 48.4453 29.1936C45.8618 29.1936 44.6257 30.545 43.7687 29.1936C42.9393 27.8852 45.2276 24.6578 48.4453 24.6578C51.6629 24.6578 53.9513 27.8856 53.1223 29.1936Z",fill:"#46359D"}),G("path",{d:"M37.4996 35.3421C35.6966 35.3421 34.5071 33.8776 34.4573 33.8155C34.1879 33.4777 34.2365 32.9798 34.5662 32.7038C34.8959 32.4278 35.382 32.4776 35.6515 32.8153C35.6565 32.8213 36.4381 33.7621 37.4996 33.7621C38.5612 33.7621 39.3427 32.8213 39.3505 32.8118C39.62 32.474 40.1045 32.4258 40.4342 32.7018C40.7639 32.9779 40.8114 33.4773 40.5415 33.8151C40.4918 33.8776 39.3023 35.3417 37.4992 35.3417L37.4996 35.3421Z",fill:"#46359D"})]}),G("defs",{children:[G("filter",{id:"filter0_d_8673_2670",x:"0",y:"0",width:"75.0005",height:"68.0004",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB",children:[G("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),G("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),G("feOffset",{dy:"4"}),G("feGaussianBlur",{stdDeviation:"4"}),G("feComposite",{in2:"hardAlpha",operator:"out"}),G("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),G("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_8673_2670"}),G("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_8673_2670",result:"shape"})]}),G("linearGradient",{id:"paint0_linear_8673_2670",x1:"67.0004",y1:"30.0002",x2:"8",y2:"30.0002",gradientUnits:"userSpaceOnUse",children:[G("stop",{"stop-color":"#99A1E3"}),G("stop",{offset:"0.129808","stop-color":"#858EDC"}),G("stop",{offset:"0.389423","stop-color":"#635EBA"}),G("stop",{offset:"1","stop-color":"#43319A"})]})]})]})}),e&&G("div",{className:"welcome-box fly-y",children:[G("div",{className:"welcome",children:[G("h1",{children:"Welcome to our website!"}),G("p",{children:"Nice to meet you! If you have any question about our services, feel free to contact us."})]}),G("div",{className:"welcome-2",children:[G("div",{className:"faq",onClick:()=>{o(!1),s(!0),l(!1),u(!1)},role:"button",children:"FAQ"}),G("div",{className:"talk",onClick:()=>{o(!1),s(!1),l(!0),u(!1),n(!1)},role:"button",children:"Let's Talk"})]})]}),i&&!e&&G("div",{className:"faq-box",children:G("div",{className:"faq-options",children:G("ul",{className:"faq-options-li",children:[["How do I apply?","What courses do you offer?","When do applications close?","Where is the campus located?","Ask something else"].map((t,n)=>G("li",{children:t},n)),G("div",{id:"talk-btn",onClick:()=>{o(!1),s(!1),l(!1),u(!0),n(!1)},role:"button",children:"Can I talk to someone?"})]})})}),r&&!e&&G("div",{className:"chat-dialog fly-x",children:[G("div",{className:"chat-header",children:[G("div",{children:[G("h1",{children:"ChatFlow"}),G("p",{children:"A live chat interface that allows for seamless, natural communication and connection."})]}),G("div",{className:"cross",role:"button",onClick:()=>{l(!1),n(!0)},children:G("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-circle-x-icon lucide-circle-x",children:[G("circle",{cx:"12",cy:"12",r:"10"}),G("path",{d:"m15 9-6 6"}),G("path",{d:"m9 9 6 6"})]})})]}),G("div",{className:"chat-body",children:[G("div",{className:"messages",children:c.map((t,n)=>G("div",{children:[G("p",{className:"bot"===t.type?!0===t.isLoading?"loader-wrapper":"bot-msg":"user-msg",children:t.isLoading?G("span",{className:"loader"}):t.text},n),G("div",{className:"bot"===t.type?"bot-time":"user-time",children:t.time})]}))}),G("div",{className:"input",children:[G("input",{type:"text",placeholder:"Type your message...",value:p,onInput:t=>f(t.currentTarget.value),onKeyDown:t=>"Enter"===t.key&&v()}),G("button",{type:"submit",className:"send",onClick:v,children:G("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:G("path",{d:"M0.176834 0.118496C0.329527 -0.0108545 0.544637 -0.0367025 0.723627 0.0527924L13.7236 6.55279C13.893 6.63748 14 6.81061 14 7C14 7.18939 13.893 7.36252 13.7236 7.44721L0.723627 13.9472C0.544637 14.0367 0.329527 14.0109 0.176834 13.8815C0.0241407 13.7522 -0.0367196 13.5442 0.0221319 13.353L1.97688 7L0.0221319 0.647048C-0.0367196 0.455781 0.0241407 0.247847 0.176834 0.118496ZM2.8693 7.5L1.32155 12.5302L12.382 7L1.32155 1.46979L2.8693 6.5H8.50001C8.77615 6.5 9.00001 6.72386 9.00001 7C9.00001 7.27614 8.77615 7.5 8.50001 7.5H2.8693Z",fill:"white"})})})]})]})]}),a&&!e&&G("div",{className:"chat-dialog fly-x",children:[G("div",{className:"chat-header",children:[G("div",{children:[G("h1",{children:"ChatFlow"}),G("p",{children:"A live chat interface that allows for seamless, natural communication and connection."})]}),G("div",{className:"cross",role:"button",onClick:()=>{u(!1),s(!1),n(!0)},children:G("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-circle-x-icon lucide-circle-x",children:[G("circle",{cx:"12",cy:"12",r:"10"}),G("path",{d:"m15 9-6 6"}),G("path",{d:"m9 9 6 6"})]})})]}),G("div",{className:"chat-body",children:[G("div",{className:"messages",children:[G("p",{className:"bot-msg",children:"Thanks for joining us! Let's start by getting your name."}),G("div",{className:"messages",children:c.map((t,n)=>G("p",{className:"bot"===t.type?!0===t.isLoading?"loader-wrapper":"bot-msg":"user-msg",children:t.isLoading?G("span",{className:"loader"}):t.text},n))})]}),G("div",{className:"input",children:[G("input",{type:"text",placeholder:"Type your message...",value:p,onInput:t=>f(t.currentTarget.value),onKeyDown:t=>"Enter"===t.key&&v()}),G("button",{type:"submit",className:"send",onClick:v,children:G("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:G("path",{d:"M0.176834 0.118496C0.329527 -0.0108545 0.544637 -0.0367025 0.723627 0.0527924L13.7236 6.55279C13.893 6.63748 14 6.81061 14 7C14 7.18939 13.893 7.36252 13.7236 7.44721L0.723627 13.9472C0.544637 14.0367 0.329527 14.0109 0.176834 13.8815C0.0241407 13.7522 -0.0367196 13.5442 0.0221319 13.353L1.97688 7L0.0221319 0.647048C-0.0367196 0.455781 0.0241407 0.247847 0.176834 0.118496ZM2.8693 7.5L1.32155 12.5302L12.382 7L1.32155 1.46979L2.8693 6.5H8.50001C8.77615 6.5 9.00001 6.72386 9.00001 7C9.00001 7.27614 8.77615 7.5 8.50001 7.5H2.8693Z",fill:"white"})})})]})]})]})]})},null),(xi=Mi)==document&&(xi=document.documentElement),n.__&&n.__(Di,xi),Ui=xi.__k,ki=[],Li=[],P(xi,Di=xi.__k=_(v,null,[Di]),Ui||d,d,xi.namespaceURI,Ui?null:xi.firstChild?t.call(xi.childNodes):null,ki,Ui?Ui.__e:xi.firstChild,!1,Li),D(ki,Di,Li)}();